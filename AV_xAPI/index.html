
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Video Device xAPI Lab">
      
      
        <meta name="author" content="Robert(Bobby) McGonigle Jr">
      
      
      
        <link rel="prev" href="../wx1_1451_part_2/">
      
      
        <link rel="next" href="../wx1_1451_part_3/">
      
      
      <link rel="icon" href="../template_assets/webex75.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Lab: Utilizing AV Specific APIs - Video Device xAPI Lab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Video Device xAPI Lab" class="md-header__button md-logo" aria-label="Video Device xAPI Lab" data-md-component="logo">
      
  <img src="../template_assets/webexLogo91.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Video Device xAPI Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab&colon; Utilizing AV Specific APIs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home&nbsp<i class="fa-solid fa-house" style="color:#B197FC;"></i>

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
    
  
  Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tools/" class="md-tabs__link">
        
  
    
  
  Tools&nbsp<i class="fa-solid fa-gear"></i>

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../cheatsheet/" class="md-tabs__link">
          
  
    
  
  Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../communities/" class="md-tabs__link">
          
  
    
  
  Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Video Device xAPI Lab" class="md-nav__button md-logo" aria-label="Video Device xAPI Lab" data-md-component="logo">
      
  <img src="../template_assets/webexLogo91.png" alt="logo">

    </a>
    Video Device xAPI Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home&nbsp<i class="fa-solid fa-house" style="color:#B197FC;"></i>
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wx1_1451_part_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Accessing Device xAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab&colon; Utilizing AV Specific APIs
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wx1_1451_part_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Build Room Documentation Macro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CodectoCodec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Implement Codec to Codec Communication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WorkSpaceIntegrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; WorkSpace Integrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wx1_1451_part_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Deploying your Customization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools&nbsp<i class="fa-solid fa-gear"></i>
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CheatSheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../challengeAnswers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Challenge Answers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../communities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devSites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Sites
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Lab&colon; Utilizing AV Specific APIs</h1>

<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>In this section we'll review a few of the AV concepts that are available on Cisco Video Hardware</p>
<p>Keep in mind, these are high level examples and we have hundreds of APIs, don't let these be the end of the road in your Journey, it's only the tip of the Iceburg. </p>
<p>Click each lesson below to expand them, and follow any tasks they introduce</p>
</div>
<div class="admonition important">
<p class="admonition-title">Download AV-MacroPak</p>
<p><figure markdown="span">
    <a href="https://github.com/ctg-tme/Video-Device-xAPI-Lab/raw/main/docs/assets/downloadable_resources/AV-MacroPak.zip"><img alt="AV-MacroPak" src="../assets/general/cisco-logo-transparent.png" width="200" /></a>
  <figcaption>AV-MacroPak</figcaption>
</figure></p>
</div>
<details class="lesson">
<summary>Lesson: Video Compositing</summary>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Most of the of the Cisco Device portfolio can execute at least 1 of the 3 types of video compositing xAPI branches available</p>
</div>
<div class="admonition example">
<p class="admonition-title">Click on the tabs below to learn more about each Video Compositing Branch</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">MainVideoSource</label><label for="__tabbed_1_2">Presentation</label><label for="__tabbed_1_3">Video Matrix</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The SetMainVideoSource xAPI allows us to alter our video output stream, the camera view the far end receives.</p>
<p>It allows you to compose your camera feed with up to 4 sources in a 2x2 grid, or 2 sources in a PIP or Prominent Style.</p>
<p>This xAPI is used in solutions such as Presenter and Audience Mode, Classroom Mode and the Campfire Blueprint Macro.</p>
<p>Just know, the more IO on a codec, the more possibilities. Keep an open mind as you run through examples on smaller devices <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></p>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Status.Video.Input.MainVideoSource/" target="_blank" >
      Learn more about xStatus Input MainVideoSource <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.Video.Input.SetMainVideoSource/" target="_blank" >
      Learn more about xCommand Video Input SetMainVideoSource <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Equal</label><label for="__tabbed_2_2">PIP</label><label for="__tabbed_2_3">Prominent</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
  <a class="glightbox" href="../assets/wx1_1451_part_2/2-2-3_SetMain-2xEqual.png" data-type="image" data-width="100%" data-height="auto" data-title="Equal Main" data-desc-position="top"><img alt="Equal Main" src="../assets/wx1_1451_part_2/2-2-3_SetMain-2xEqual.png" width="600" /></a>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
  <a class="glightbox" href="../assets/wx1_1451_part_2/2-2-3_SetMain-2xPIP.png" data-type="image" data-width="100%" data-height="auto" data-title="PIP Main" data-desc-position="top"><img alt="PIP Main" src="../assets/wx1_1451_part_2/2-2-3_SetMain-2xPIP.png" width="600" /></a>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
  <a class="glightbox" href="../assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleSameNameParameter-OSD.png" data-type="image" data-width="100%" data-height="auto" data-title="OSD Output" data-desc-position="top"><img alt="OSD Output" src="../assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleSameNameParameter-OSD.png" width="600" /></a>
</figure></p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>The Presentation Start command, though not glaringly obvious also allows you to composite sources into a single stream, but over the Content Channel of a call.</p>
<p>It has largely the same feature set as MainVideoSource with a few notable differences</p>
<p><a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.Presentation.Start/" target="_blank" >
  Learn more about xCommand Presentation Start <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
<div class="tabbed-block">
<p>Video Matrix, again allows you to composite, but it's local to the room.</p>
<p>You can mix any inputs on the Codec and send them to a specific video output</p>
<p>Popular uses of the Video Matrix APIs are for local video recording or enabling 2 Laptop shares while on a call, on separate screens (1 local, and another shared in call)</p>
<p><a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/search?search=Video+Matrix+*" target="_blank" >
  Learn more about the Video Matrix APIs <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
</div>
</div>
</div>
<ul>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Install the <mark>Video Compositing Demo</mark> Macro from the AV-MacroPak.zip file</li>
<li>Save and Activate this Macro<ul>
<li>It will spawn a UserInterface for your with all your available sources</li>
</ul>
</li>
<li>Go through each Page in this macro and build new compositions on the fly using the various controls</li>
</ul>
<details class="tip">
<summary>Inspect the Macro</summary>
<p>Feel free to inspect the Video Compositing Demo Macro. It's flexible enough to automatically expand how many input and output sources are selectable.</p>
<p>It queries the Video Input and Output xConfig branches to determine the # of inputs, then dynamically builds the UI.</p>
<p>But, the User Experience could use some work in a live build don't you think <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></p>
</details>
<ul>
<li>Once complete, if you have 10 active macros, be sure to deactivate at least 1 before moving on to the next lesson</li>
</ul>
</li>
</ul>
</details>
<details class="lesson">
<summary>Lesson: Audio Routing and Control Concepts</summary>
<p>We won't be able to perform a robust lab on this topic, as Audio Routing is only available on our larger endpoints, and some of our Smaller Endpoints lack the IO to make this section worthwhile</p>
<p>But, there are a whole suite of APIs associated to Audio Routing, Type and Control</p>
<div class="admonition example">
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Audio Routing</label><label for="__tabbed_3_2">Audio Types</label><label for="__tabbed_3_3">Audio Techniques in the Field</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Audio Routing is available on Sx80, Codec Pro and Codec EQ based platforms</p>
<div class="admonition important">
<p class="admonition-title">Know that Codec EQ systems will need a license key for use</p>
</div>
<p>In the WebUI is a feature called the <mark>Audio Console</mark></p>
<p>The Audio Console, at a high level, allows grouping of audio sources, routing inputs to outputs, adjusting gain structures and the ability to build and assign up to 8 different Equalizers with 6 parametric bands per equalizer </p>
<p>You can also alter these route dynamically using the API</p>
<p><a class="md-button md-button--primary" href="https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/ce913/sx-mx-dx-room-kit-boards-customization-guide-ce913.pdf" target="_blank" >
  Learn more about the Audio Console (Page 58) <i class="fa-solid fa-square-up-right"></i>
</a></p>
<p><a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Status.SystemUnit.Software.OptionKeys.AVIntegrator/" target="_blank" >
  Learn more about xStatus SystemUnit Software OptionKeys AVIntegrator <i class="fa-solid fa-square-up-right"></i>
</a></p>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/search?search=Audio+Input+LocalInput" target="_blank" >
      Learn more about Audio Input LocalInput xAPIs <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/search?search=Audio+Output+LocalOutput" target="_blank" >
      Learn more about Audio Output LocalOutput xAPIs <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
<div class="tabbed-block">
<p>Cisco Video Codecs offer many ways to connect Audio. It's good to know from a design perspective, but it's also good to know that for each Audio Type, there may be a corresponding xAPI to go along with it</p>
<div class="admonition warning">
<table>
<thead>
<tr>
<th><strong>Codec Platform</strong></th>
<th><strong>Analog Inputs</strong></th>
<th><strong>Analog Inputs</strong></th>
<th><strong>USB Inputs</strong></th>
<th><strong>USB Outputs</strong></th>
<th><strong>Ethernet Inputs (Cisco/AES67)</strong></th>
<th><strong>Ethernet Outputs (Cisco<code>**</code>/AES67)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><em>Room Bar</em></strong></td>
<td>❌</td>
<td>❌</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>❌</td>
</tr>
<tr>
<td><strong><em>Room Bar Pro</em></strong></td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3-8*</td>
<td>4*</td>
</tr>
<tr>
<td><strong><em>Board Pro Gen 2</em></strong></td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3-8*</td>
<td>4*</td>
</tr>
<tr>
<td><strong><em>Codec EQ</em></strong></td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3-8*</td>
<td>4*</td>
</tr>
<tr>
<td><strong><em>Codec Pro</em></strong></td>
<td>8</td>
<td>6</td>
<td>1</td>
<td>1</td>
<td>8</td>
<td>4</td>
</tr>
</tbody>
</table>
<p><code>*</code> = 8 Ethernet and AES67 Audio requires AES67
<code>**</code> = Cisco's DNAM IV Amplifier is an Ethernet Based Audio Output. Only available on Room Panorama and Codec EQ Systems</p>
</div>
<div class="admonition curious">
<table>
<thead>
<tr>
<th>Codec Platform</th>
<th><strong>HDMI Audio Inputs</strong></th>
<th><strong>HDMI Audio Outputs</strong></th>
<th><strong>USB-C Audio Inputs</strong></th>
<th><strong>USB-C Audio Outputs</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Room Bar</td>
<td>1</td>
<td>❌</td>
<td>1 (BYOD)</td>
<td>1 (BYOD)</td>
</tr>
<tr>
<td>Room Bar Pro</td>
<td>1</td>
<td>❌</td>
<td>1 (BYOD)</td>
<td>1 (BYOD)</td>
</tr>
<tr>
<td>Board Pro G2</td>
<td>1</td>
<td>❌</td>
<td>1 (BYOD)</td>
<td>1 (BYOD)</td>
</tr>
<tr>
<td>Codec EQ</td>
<td>3 (1 ARC Enabled)</td>
<td>3</td>
<td>1 (BYOD)</td>
<td>1 (BYOD)</td>
</tr>
<tr>
<td>Codec Pro</td>
<td>5 (3 ARC Enabled)</td>
<td>3</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Individual Microphone Muting</label><label for="__tabbed_4_2">Audio Ducking</label><label for="__tabbed_4_3">Audio Based Automation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>It's quite a common request to mute specific audio inputs. It's not possible out of the box for our endpoints, but by altering the Audio Input's <mark>Configuration Mode</mark> using an automation, you can cut audio input at the source</p>
<p>All Audio Input types allow you to disable them. That coupled with custom controls on the Touch Panel can enable experiences like this</p>
<p><a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/search?search=Audio+Input+*+*+Mode" target="_blank" >
  Learn more about Audio Input xConfigurations <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
<div class="tabbed-block">
<p>You can access Audio VuMeter information from all Audio Input types</p>
<p>Using this information, and a robust set of rules, you can duck certain microphones in a space when a HandHeld or Lavalier goes hot, giving your presenter the Audio Stage.</p>
<p><a class="md-button md-button--primary" href="https://github.com/gve-sw/gve_devnet_webex_codec_ceiling_mic_gain_ducker_macro" target="_blank" >
  Check out Cisco Devnet's Audio Ducker Macro <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
<div class="tabbed-block">
<p>Many asks on the field today are for custom camera automation, and may rely on audio based events</p>
<p>That's entirely possible, in fact, the Presenter and Audio Solution and Campfire blueprint leverage these techniques</p>
<p><a class="md-button md-button--primary" href="https://github.com/ctg-tme/audio-zone-manager-library-macro/tree/main" target="_blank" >
  Check out the Audio Zone Manager (AZM) Macro Library <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</details>
<details class="lesson">
<summary>Lesson: HID Sources</summary>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In this lesson, we'll leverage the USB HID capabilities of the Codec</p>
<p>HID Devices, such as keyboards, mice and presentation clickers can connect the the Codec and be used as a Custom Control interface. </p>
<p>When <mark>xConfiguration Peripherals InputDevice Mode</mark> is set to <ins class="critic">On</ins>, you can leverage <mark>xEvent UserInterface InputDevice Key Action</mark> to subscribe to those device clicks</p>
<p>Let's build an Example <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></p>
</div>
<ul>
<li>
<p><strong>xAPI(s)</strong>:</p>
<ul>
<li>xConfiguration Peripherals InputDevice Mode</li>
<li>xEvent UserInterface InputDevice Key Action</li>
<li>xCommand Video Input SetMainVideoSource</li>
<li>xCommand Video Matrix Assign</li>
<li>xCommand Audio Volume Increase</li>
<li>xCommand Audio Volume Decrease</li>
</ul>
</li>
<li>
<p><strong>Goal</strong>:</p>
<ul>
<li>Use the Macro Editor to subscribe to HID Device Inputs coming from a Provided Presentation Clicker</li>
<li>Use the events coming in from the device to do the following<ul>
<li>Left Arrow: Set your Main Source to your Internal Camera</li>
<li>Right Arrow: Compose your Camera with an incoming Camera Feed from a Partner Station</li>
<li>Up Arrow: Increase your system volume</li>
<li>Down Arrow: Decrease your system volume</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Setup</strong>:</p>
<ul>
<li>Partner up with another station in this lab</li>
<li>Connect the USB Dongle for your Presentation Clicker to any open USB A connector on your Codec</li>
<li>Connect Connect the <mark>Second HDMI Output</mark> from your Codec to the <ins class="critic">HDMI Input</ins> of your Partner Codec<ul>
<li>The partner Station should do the same for you</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>Create a new Macro called <mark>Presentation Clicker</mark></li>
<li>Save and Activate this Macro</li>
<li>
<ul>
<li>This function should set the following xAPIs and Values using Macro Syntax<ul>
<li>xConfiguration Peripherals InputDevice Mode: On</li>
<li>xCommand Video Matrix Assign SourceId: 1 Output: 2</li>
</ul>
</li>
</ul>
<p>Define and Declare an <code>init()</code> function</p>
<details class="example">
<summary>View <code>init()</code> function</summary>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">init</span><span class="p">(){</span>
<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Config</span><span class="p">.</span><span class="nx">Peripherals</span><span class="p">.</span><span class="nx">InputDevice</span><span class="p">.</span><span class="nx">Mode</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;On&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">Assign</span><span class="p">({</span>
<span class="w">    </span><span class="nx">SourceId</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Output</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
</details>
</li>
<li>
<p>Subscribe to <mark>xEvent UserInterface InputDevice Key Action</mark></p>
<ul>
<li>Within the subscription, establish a <code>switch...case</code> statement that switches based on an incoming Key</li>
</ul>
<details class="example">
<summary>View Presentation Keys</summary>
<table>
<thead>
<tr>
<th><strong>Button</strong></th>
<th><strong>Keys</strong></th>
<th><strong>Action to run</strong></th>
<th><strong>Note</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><em>Left Arrow</em></strong></td>
<td><code>KEY_PAGEUP</code></td>
<td>Set Camera to Internal Camera</td>
<td></td>
</tr>
<tr>
<td><strong><em>Right Arrow</em></strong></td>
<td><code>KEY_PAGEDOWN</code></td>
<td>Compose Internal and External Camera</td>
<td></td>
</tr>
<tr>
<td><strong><em>Up Arrow</em></strong></td>
<td><code>KEY_B</code></td>
<td>Increase Volume</td>
<td></td>
</tr>
<tr>
<td><strong><em>Down</em></strong></td>
<td><code>KEY_LEFTSHIFT</code> and <code>KEY_F5</code></td>
<td>Decrease Volume</td>
<td>This button alternates keys, handle both with the same command</td>
</tr>
</tbody>
</table>
</details>
<ul>
<li>
<p>Assign the following actions to each key, using the provide xAPI written in Macro Syntax</p>
<ul>
<li><strong>Left Arrow</strong>: xCommand Video Input SetMainVideoSource ConnectorId: 1</li>
<li><strong>Right Arrow</strong>: xCommand Video Input SetMainVideoSource ConnectorId: 1 ConnectorId: 2 Layout: Equal</li>
<li><strong>Up Arrow</strong>: xCommand Audio Volume Increase</li>
<li>Down Arrow: xCommand Audio Volume Decrease</li>
</ul>
</li>
<li>
<p>Add console.log() where appropriate</p>
</li>
</ul>
<details class="example">
<summary>View InputDevice Subscription</summary>
<div class="highlight"><pre><span></span><code><span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">InputDevice</span><span class="p">.</span><span class="nx">Key</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">Code</span><span class="p">,</span><span class="w"> </span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Key Pressed: [</span><span class="si">${</span><span class="nx">Key</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">Key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_PAGEUP&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">//Left Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Input</span><span class="p">.</span><span class="nx">SetMainVideoSource</span><span class="p">({</span><span class="w"> </span><span class="nx">ConnectorId</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_PAGEDOWN&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Right Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Input</span><span class="p">.</span><span class="nx">SetMainVideoSource</span><span class="p">({</span><span class="w"> </span><span class="nx">ConnectorId</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">],</span><span class="w"> </span><span class="nx">Layout</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Equal&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_B&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Up Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Volume</span><span class="p">.</span><span class="nx">Increase</span><span class="p">()</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_LEFTSHIFT&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_F5&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Down Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Volume</span><span class="p">.</span><span class="nx">Decrease</span><span class="p">()</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
</details>
<ul>
<li>Once complete, save your macro, make sure it's active and try out the Presentation Clicker</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Config</span><span class="p">.</span><span class="nx">Peripherals</span><span class="p">.</span><span class="nx">InputDevice</span><span class="p">.</span><span class="nx">Mode</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;On&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Matrix</span><span class="p">.</span><span class="nx">Assign</span><span class="p">({</span>
<span class="w">    </span><span class="nx">ConnectorId</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Output</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>

<span class="nx">init</span><span class="p">();</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">InputDevice</span><span class="p">.</span><span class="nx">Key</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">Code</span><span class="p">,</span><span class="w"> </span><span class="nx">Key</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Key Pressed: [</span><span class="si">${</span><span class="nx">Key</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">Key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_PAGEUP&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">//Left Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Input</span><span class="p">.</span><span class="nx">SetMainVideoSource</span><span class="p">({</span><span class="w"> </span><span class="nx">ConnectorId</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_PAGEDOWN&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Right Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Video</span><span class="p">.</span><span class="nx">Input</span><span class="p">.</span><span class="nx">SetMainVideoSource</span><span class="p">({</span><span class="w"> </span><span class="nx">ConnectorId</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">],</span><span class="w"> </span><span class="nx">Layout</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Equal&#39;</span><span class="w"> </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_B&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Up Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Volume</span><span class="p">.</span><span class="nx">Increase</span><span class="p">()</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_LEFTSHIFT&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;KEY_F5&#39;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Down Arrow</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Volume</span><span class="p">.</span><span class="nx">Decrease</span><span class="p">()</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
</details>
</details>
<details class="lesson">
<summary>Lesson: WebView OSD and Controller</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All current Cisco Devices have a feature called the <mark>WebEngine</mark></p>
<p>This WebEngine allows you to setup WebApps, WebViews, WebWidgets and Persistent WebApps across varying products</p>
<p>Simply put, they are Web Pages you can access via your device</p>
</div>
<p>We'll be covering how to open a WebView in the "Building Room Documentation Macro", so for the purposes of this lesson, we want you to check out a pretty impressive macro and web application the Cisco WXSD Sales team has put together that utilizes WebViews simultaneously on the OSD and Touch Controller</p>
<ul>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>Install the <mark>webview-websocket</mark> Macro from the AV-MacroPak</li>
<li>Save and Activate the macro</li>
<li>It will spawn a panel for you called WebSocket Demos</li>
<li>Open this interface and try each of the demos</li>
</ul>
</li>
</ul>
<p><a class="md-button md-button--primary" href="https://github.com/wxsd-sales/analytics-web-widget" target="_blank" >
    Learn more about WXSD's webview-websocket Macro<i class="fa-solid fa-square-up-right"></i>
</a></p>
</details>
<details class="lesson">
<summary>Lesson: Room Analytics</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let's take a brief break from Macros and install a Web Widget <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></p>
<p>Web Widgets are a great way to add signage to your Device running in RoomOS mode</p>
<p>It's Web Content that rests in a non-interactive Modal Window on the OSD of your Codec</p>
<p>Great for Digital Signage, Company Wide Communication, Stock Tickers, anything that really enhances your User's Experience</p>
</div>
<p>We'll be using WebContent curated by our WXSD Sales Team. They built a Web Widget that leverages the front end jsxapi module that sockets into your Video Endpoint and Pulls the Analytics Information available on the Codec.</p>
<details class="curious">
<summary>What's the jsxapi module?</summary>
<p>The jsxapi module is a tool that's hosted external to the codec that can facilitate either an SSH or a WebSocket connection to the endpoint. The syntax is largely similar to Macro syntax, except with a few more steps to establish the socket</p>
<p>The advantage of the jsxapi is you can embed it into Web Applications as well as leverage other services not accessible on the Codec</p>
<p><a class="md-button md-button--primary" href="https://roomos.cisco.com/doc/TechDocs/JSXAPIIntro" target="_blank" >
  Learn more about the jsxapi <i class="fa-solid fa-square-up-right"></i>
</a></p>
</details>
<ul>
<li>
<p><strong>xAPI(s)</strong>:</p>
<ul>
<li>xConfiguration WebEngine Mode: On</li>
<li>xConfiguration WebEngine Features AllowDeviceCertificate: True</li>
<li>xConfiguration NetworkServices CommonProxy: Enabled</li>
</ul>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Navigate to the Configuration section of the Codec's WebUI</li>
<li>
<p>Set the Above xAPI references to the provided values</p>
<ul>
<li>Note, CommonProxy is ONLY available via the WebUI</li>
</ul>
</li>
<li>
<p>Navigate to the UI Extensions Editor</p>
</li>
<li>
<p>Select <mark>New</mark></p>
</li>
<li>Select WebWidget</li>
<li>Assign the following URL to the WebWidget</li>
</ul>
<div class="highlight"><pre><span></span><code>https://wxsd-sales.github.io/analytics-web-widget/widget.html?username=ENTER_USERNAME_HERE&amp;password=ENTER_PASSWORD_HERE&amp;ipAddress=ENTER_IP_HERE
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The URL above has 3 URL parameters you MUST assign</p>
<ul>
<li>username=</li>
<li>password=</li>
<li>ipAddress=</li>
</ul>
<p>Be sure to provide the Username, Password and Ip Address of your codec in these fields. The jsxapi module within the Web App will use this information to form a socket against your endpoint</p>
</div>
<ul>
<li>Save your UI Extension, you should now see a Web Widget on the OSD of your Device</li>
</ul>
<p><a class="md-button md-button--primary" href="https://github.com/wxsd-sales/analytics-web-widget" target="_blank" >
  Learn more about WXSD's Analytics Web Widget<i class="fa-solid fa-square-up-right"></i>
</a></p>
</li>
</ul>
<details class="success">
<summary>Compare your OSD</summary>
<p><figure markdown="span">
  <a class="glightbox" href="../assets/general/analytcs_web_widget.png" data-type="image" data-width="100%" data-height="auto" data-title="Web Widget" data-desc-position="top"><img alt="Web Widget" src="../assets/general/analytcs_web_widget.png" width="600" /></a>
  <figcaption>Web Widget</figcaption>
</figure></p>
</details>
</details>
<details class="lesson">
<summary>Lesson: Triple Click Example</summary>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>At times, we may want to build in tools that should only be available to super users or device admins in a space</p>
<p>It's common to see hidden interfaces in the wild that allow users to make changes to their space that the everyday user need not interact with, such as modifying a gain structure for Microphones or Re-Routing Displays</p>
<p>But at face value, our UI Extensions don't offer an obvious solution to that need when you first dive into them</p>
<p>You may have noticed, while interacting with the Panel Properties, that you can set the Location to "Hidden"</p>
<p>This allows you to have a UserInterface that's not visible on the touch interface, but can still be opened programmatically via the API</p>
</div>
<ul>
<li>Install the <mark>Triple Click Demo</mark> Macro from the AV-MacroPak.zip file</li>
<li>Save and Activate this Macro<ul>
<li>It will spawn a UserInterface for your with a panel called User Facing Panel</li>
</ul>
</li>
<li>Click the Panel and it will open up an interface we want our average user to access</li>
<li>Close the panel and then quickly click the panel 3 times to reveal a hidden interface <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></li>
</ul>
<details class="tip">
<summary>Timing is Key</summary>
<p>If you inspect the Macro, we're leveraging the SetTimeout and ClearTimeout functions built into ES6 JS to facilitate this action</p>
<p>Each time the panel is clicked within certain number of milliseconds, we increase a counter and if we reach 3 clicks, we'll open up our hidden interface</p>
</details>
<div class="admonition challenge">
<p class="admonition-title">Let's Pin Protect this Hidden Interface!</p>
<p>Sometimes, a user may find a hidden interface like this, so in order to further prevent access to it, we can use a TextInput prompt that asks for a pin, before we allow access to this interface</p>
<ul>
<li>
<p><strong>xAPI(s)</strong>: </p>
<ul>
<li>xCommand UserInterface Message TextInput Display</li>
<li>xEvent UserInterface Message TextInput Response</li>
<li>xCommand UserInterface Extensions Panel Open</li>
</ul>
</li>
<li>
<p><strong>Goal</strong>: </p>
<ul>
<li>Modify the <mark>Triple Click Demo</mark> Macro so that the a TextInput prompt opens instead of the hidden interface</li>
<li>On a successful pin entry, then open the hidden Interface</li>
<li>On a failed pin, re-open the TextInput prompt</li>
</ul>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Establish a <code>pinCode</code> object in the configuration section with a value of <code>1234</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">pinCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1234</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>Modify the <code>openPanel()</code> function in the <mark>Triple Click Demo</mark> Macro</li>
<li>
<ul>
<li>Replace xCommand UserInterface Extensions Panel Open call with xCommand UserInterface Message TextInput Display and apply the following parameters<ul>
<li>Title: "Enter Pin for Access"</li>
<li>Text: "Enter a 4 digit pin below to access a hidden interface"</li>
<li>InputType: PIN</li>
<li>FeedbackId: protectedTripleClick</li>
<li>Duration: 30</li>
</ul>
</li>
<li>Note: you'll need that xCommand UserInterface Extensions Panel Open later in code, so best to copy it or comment it out</li>
</ul>
<p>Your modification should:</p>
<details class="example">
<summary>View Before and After for the <code>openPanel()</code> function</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Before Changes</label><label for="__tabbed_5_2">After Changes</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cm">/*This function governs the panel logic*/</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span><span class="w"> </span><span class="c1">//Clear the handler on each press</span>
<span class="w">  </span><span class="nx">hiddenAccessCount</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="c1">//Increase the count</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">maxClicks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">] revealed`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span><span class="w"> </span><span class="c1">//Clear the the count threshold is met</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">multiClickPanel</span>
<span class="w">    </span><span class="p">});</span><span class="w"> </span><span class="c1">//Open the hidden panel</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">hiddenAccessHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Standard Panel [</span><span class="si">${</span><span class="nx">singleClickPanel</span><span class="si">}</span><span class="sb">] opened`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">singleClickPanel</span>
<span class="w">    </span><span class="p">});</span><span class="w"> </span><span class="c1">//If the button is not pressed quickly enough, open the standard panel</span>
<span class="w">    </span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//Reset the count</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="nx">delayBetweenClicks_ms</span><span class="p">)</span>
<span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="cm">/*This function governs the panel logic*/</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span>
<span class="w">  </span><span class="nx">hiddenAccessCount</span><span class="o">++</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">maxClicks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">] Requested`</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="c1">// &lt;-- Update our Console Log to Match</span>
<span class="w">    </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span><span class="w"> </span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span><span class="w"> </span><span class="c1">// &lt;-- Adding our TextInput Prompt</span>
<span class="w">      </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter Pin for Access&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter a 4 digit pin below to access a hidden interface&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">InputType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Pin&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">FeedbackId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="c1">// return xapi.Command.UserInterface.Extensions.Panel.Open({</span>
<span class="w">    </span><span class="c1">//   PanelId: multiClickPanel</span>
<span class="w">    </span><span class="c1">// });</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">hiddenAccessHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Standard Panel [</span><span class="si">${</span><span class="nx">singleClickPanel</span><span class="si">}</span><span class="sb">] opened`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">singleClickPanel</span>
<span class="w">    </span><span class="p">});</span><span class="w"> </span><span class="c1">//If the button is not pressed quickly enough, open the standard panel</span>
<span class="w">    </span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//Reset the count</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="nx">delayBetweenClicks_ms</span><span class="p">)</span>
<span class="p">};</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<ul>
<li>
<p>We now need a Subscription to the TextInput Response in order to handle the user's pin submission</p>
</li>
<li>
<p>Subscribe to <mark>xEvent UserInterface Message TextInput Response</mark> using Macro Syntax</p>
</li>
<li>
<ul>
<li>Use an <code>if</code> statement to check if an incoming TextInput response matches the FeedbackId we set in the TextInput command &gt; <mark>'protectedTripleClick'</mark></li>
<li>Use the <code>&amp;&amp;</code> operator within the same <code>if</code> statement to check if the Text matches the <code>pinCode</code> object configured in our Macro<ul>
<li>If the FeedbackId and Text matches, open the hidden panel using xCommand UserInterface Extensions Panel Open</li>
<li>Else re-open the TextInput Prompt but change the title to "Incorrect Pin Entry, Try Again"</li>
</ul>
</li>
</ul>
<p>Within the subscription</p>
<details class="example">
<summary>View Subscription</summary>
<div class="highlight"><pre><span></span><code><span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Response</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="nx">FeedbackId</span><span class="p">,</span><span class="w"> </span><span class="nx">Text</span><span class="p">})=&gt;{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">FeedbackId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">pinCode</span><span class="p">){</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Pin Passed, Hidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">] revealed`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">multiClickPanel</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Re-prompting Pin Entry forHidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">]`</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Incorrect Pin Entry, Try Again&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter a 4 digit pin below to access a hidden interface&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">InputType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Pin&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">FeedbackId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
</details>
</li>
</ul>
</li>
<li>
<p>Once complete, Save and Activate this Macro</p>
<ul>
<li>It will spawn a UserInterface for your with a panel called User Facing Panel</li>
</ul>
</li>
<li>Click the Panel and it will open up an interface we want our average user to access</li>
<li>Close the panel and then quickly click the panel 3 times to reveal open the TextInput Prompt<ul>
<li>Try entering the Correct pinCode (1234)</li>
<li>Also try entering the wrong pin</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="cm">/********************************************************</span>
<span class="cm">Copyright (c) 2024 Cisco and/or its affiliates.</span>
<span class="cm">This software is licensed to you under the terms of the Cisco Sample</span>
<span class="cm">Code License, Version 1.1 (the &quot;License&quot;). You may obtain a copy of the</span>
<span class="cm">License at</span>
<span class="cm">              https://developer.cisco.com/docs/licenses</span>
<span class="cm">All use of the material herein must be in accordance with the terms of</span>
<span class="cm">the License. All rights not expressly granted by the License are</span>
<span class="cm">reserved. Unless required by applicable law or agreed to separately in</span>
<span class="cm">writing, software distributed under the License is distributed on an &quot;AS</span>
<span class="cm">IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express</span>
<span class="cm">or implied.</span>
<span class="cm">*********************************************************/</span>

<span class="cm">/**</span>
<span class="cm"> * Macro Author:              Robert(Bobby) McGonigle Jr</span>
<span class="cm"> *                            Technical Marketing Engineering, Leader</span>
<span class="cm"> *                            Cisco Systems</span>
<span class="cm"> * </span>
<span class="cm"> * ---------------------------------------------------------------------</span>
<span class="cm"> * Last Revised October 2024</span>
<span class="cm"> */</span>

<span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="cm">/*Configuration Section*/</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">pinCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1234</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">singleClickPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;singleClickPanel&#39;</span><span class="w"> </span><span class="c1">//Panel ID of the Standard Panel you want to open on a single press</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">multiClickPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;multiClickPanel&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">//Panel ID of the Hidden Panel you&#39;ll reveal in X presses in quick succession</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">userFacingPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;userFacingPanel&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">//Panel ID of the user facing panel</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">delayBetweenClicks_ms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">250</span><span class="w"> </span><span class="c1">//Delay Between Presses in Milliseconds to reveal the Hidden Panel</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">maxClicks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="c1">//Number of clicks needed to reveal the panel</span>

<span class="cm">/*Important objects, do not change*/</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">hiddenAccessHandler</span><span class="p">;</span><span class="w"> </span><span class="c1">//Handles the timeout needed for panel logic</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//let needed to track # of clicks presses</span>


<span class="cm">/*This function governs the panel logic*/</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openPanel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span>
<span class="w">  </span><span class="nx">hiddenAccessCount</span><span class="o">++</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">maxClicks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Hidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">] Requested`</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="c1">// &lt;-- Update our Console Log to Match</span>
<span class="w">    </span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">hiddenAccessHandler</span><span class="p">);</span><span class="w"> </span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span><span class="w"> </span><span class="c1">// &lt;-- Adding our TextInput Prompt</span>
<span class="w">      </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter Pin for Access&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter a 4 digit pin below to access a hidden interface&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">InputType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Pin&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">FeedbackId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="c1">// return xapi.Command.UserInterface.Extensions.Panel.Open({</span>
<span class="w">    </span><span class="c1">//   PanelId: multiClickPanel</span>
<span class="w">    </span><span class="c1">// });</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">hiddenAccessHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Standard Panel [</span><span class="si">${</span><span class="nx">singleClickPanel</span><span class="si">}</span><span class="sb">] opened`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">singleClickPanel</span>
<span class="w">    </span><span class="p">});</span><span class="w"> </span><span class="c1">//If the button is not pressed quickly enough, open the standard panel</span>
<span class="w">    </span><span class="nx">hiddenAccessCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//Reset the count</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="nx">delayBetweenClicks_ms</span><span class="p">)</span>
<span class="p">};</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Response</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="nx">FeedbackId</span><span class="p">,</span><span class="w"> </span><span class="nx">Text</span><span class="p">})=&gt;{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">FeedbackId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">Text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">pinCode</span><span class="p">){</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Pin Passed, Hidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">] revealed`</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">multiClickPanel</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">({</span><span class="w"> </span><span class="nx">Message</span><span class="o">:</span><span class="w"> </span><span class="sb">`Re-prompting Pin Entry forHidden Panel [</span><span class="si">${</span><span class="nx">multiClickPanel</span><span class="si">}</span><span class="sb">]`</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">TextInput</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Incorrect Pin Entry, Try Again&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Enter a 4 digit pin below to access a hidden interface&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">InputType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Pin&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">FeedbackId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;protectedTripleClick&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>


<span class="cm">/*Normal Event logic*/</span>
<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Clicked</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">PanelId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nx">userFacingPanel</span><span class="o">:</span><span class="w"> </span><span class="c1">//Run open panel logic when the User Facing panel is pressed// This can be any action button</span>
<span class="w">      </span><span class="nx">openPanel</span><span class="p">()</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">WidgetId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;visiblePanel_2&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">Prompt</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">        </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;You did it!&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;You pressed a button&lt;p&gt;Now, find the hidden button to press&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Option.1&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dismiss&#39;</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;hiddenPanel_2&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">Prompt</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">        </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;You did it!&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;You pressed the HIDDEN button&lt;p&gt;Well, that\&#39;s about it, happy coding 😊&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Option.1&quot;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dismiss&#39;</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">buildPanels</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">userFacingXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">  &lt;Panel&gt;</span>
<span class="sb">    &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">    &lt;Location&gt;HomeScreenAndCallControls&lt;/Location&gt;</span>
<span class="sb">    &lt;Icon&gt;Concierge&lt;/Icon&gt;</span>
<span class="sb">    &lt;Color&gt;#CF7900&lt;/Color&gt;</span>
<span class="sb">    &lt;Name&gt;User Facing Panel&lt;/Name&gt;</span>
<span class="sb">    &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">  &lt;/Panel&gt;</span>
<span class="sb">&lt;/Extensions&gt;</span>
<span class="sb">`</span><span class="p">;</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">singleClickXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">  &lt;Panel&gt;</span>
<span class="sb">    &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">    &lt;Location&gt;Hidden&lt;/Location&gt;</span>
<span class="sb">    &lt;Icon&gt;Input&lt;/Icon&gt;</span>
<span class="sb">    &lt;Name&gt;Visible Panel&lt;/Name&gt;</span>
<span class="sb">    &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">    &lt;Page&gt;</span>
<span class="sb">      &lt;Name&gt;Normal Visible Panel&lt;/Name&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;visiblePanel_1&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;Nothing to hide here 😊&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Text&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4;fontSize=normal;align=center&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;visiblePanel_2&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;Oh Look, A Button 🎉&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;visiblePanel_3&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;Exit this panel and tap it 3 times in quick succession to reveal a hidden panel&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Text&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4;fontSize=normal;align=center&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;visiblePanel_4&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;Feel free to use this example to build tools that don&#39;t always need to be visible&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Text&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4;fontSize=normal;align=center&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Options&gt;hideRowNames=1&lt;/Options&gt;</span>
<span class="sb">    &lt;/Page&gt;</span>
<span class="sb">  &lt;/Panel&gt;</span>
<span class="sb">&lt;/Extensions&gt;</span>
<span class="sb">`</span><span class="p">;</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">multiClickXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">  &lt;Panel&gt;</span>
<span class="sb">    &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">    &lt;Location&gt;Hidden&lt;/Location&gt;</span>
<span class="sb">    &lt;Icon&gt;Sliders&lt;/Icon&gt;</span>
<span class="sb">    &lt;Name&gt;Hidden Panel&lt;/Name&gt;</span>
<span class="sb">    &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">    &lt;Page&gt;</span>
<span class="sb">      &lt;Name&gt;Super Secret Panel&lt;/Name&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;hiddenPanel_1&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;Tuck away tools for quick changes to your system on the fly&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Text&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4;fontSize=normal;align=center&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Row&gt;</span>
<span class="sb">        &lt;Name&gt;Row&lt;/Name&gt;</span>
<span class="sb">        &lt;Widget&gt;</span>
<span class="sb">          &lt;WidgetId&gt;hiddenPanel_2&lt;/WidgetId&gt;</span>
<span class="sb">          &lt;Name&gt;WHAT?!?! Another Button!!!&lt;/Name&gt;</span>
<span class="sb">          &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">          &lt;Options&gt;size=4&lt;/Options&gt;</span>
<span class="sb">        &lt;/Widget&gt;</span>
<span class="sb">      &lt;/Row&gt;</span>
<span class="sb">      &lt;Options&gt;hideRowNames=1&lt;/Options&gt;</span>
<span class="sb">    &lt;/Page&gt;</span>
<span class="sb">  &lt;/Panel&gt;</span>
<span class="sb">&lt;/Extensions&gt;</span>
<span class="sb">`</span><span class="p">;</span>

<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span><span class="w"> </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">userFacingPanel</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">userFacingXML</span><span class="p">)</span>

<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span><span class="w"> </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">singleClickPanel</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">singleClickXML</span><span class="p">)</span>

<span class="w">  </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span><span class="w"> </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="nx">multiClickPanel</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">multiClickXML</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">buildPanels</span><span class="p">();</span>
</code></pre></div>
</details>
</div>
</details>
<details class="lesson">
<summary>Lesson: Pressed and Released Use Cases</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike panels, many widgets fire multiple events. These events may seem a bit odd, as they can seam to fire at the same time, but it could be that you're interacting with the Widget a bit too quickly.</p>
<p>We can leverage these unique events from each widget to craft a more refined User Experience in our customization</p>
<p>Below is a list of all the Widgets we have today and which events they can fire</p>
<div class="admonition experiment">
<p class="admonition-title">Click on each table below to review each Widget</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:9"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><input id="__tabbed_6_3" name="__tabbed_6" type="radio" /><input id="__tabbed_6_4" name="__tabbed_6" type="radio" /><input id="__tabbed_6_5" name="__tabbed_6" type="radio" /><input id="__tabbed_6_6" name="__tabbed_6" type="radio" /><input id="__tabbed_6_7" name="__tabbed_6" type="radio" /><input id="__tabbed_6_8" name="__tabbed_6" type="radio" /><input id="__tabbed_6_9" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Toggle</label><label for="__tabbed_6_2">Slider</label><label for="__tabbed_6_3">Button</label><label for="__tabbed_6_4">GroupButton</label><label for="__tabbed_6_5">Icon Button</label><label for="__tabbed_6_6">Spinner</label><label for="__tabbed_6_7">TextBox</label><label for="__tabbed_6_8">Directional Pad</label><label for="__tabbed_6_9">Spacer</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/toggle.gif" data-type="image" data-width="100%" data-height="auto" data-title="Toggle Action" data-desc-position="top"><img alt="Toggle Action" src="../assets/general/UI_Extension_Gifs/toggle.gif" /></a>
    <figcaption>Toggle Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>changed</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>on</code> or <code>off</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/slider.gif" data-type="image" data-width="100%" data-height="auto" data-title="Slider Action" data-desc-position="top"><img alt="Slider Action" src="../assets/general/UI_Extension_Gifs/slider.gif" /></a>
    <figcaption>Slider Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>changed</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>Integer between 0 and 255</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/button.gif" data-type="image" data-width="100%" data-height="auto" data-title="Button Action" data-desc-position="top"><img alt="Button Action" src="../assets/general/UI_Extension_Gifs/button.gif" /></a>
    <figcaption>Button Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;">N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/groupButton.gif" data-type="image" data-width="100%" data-height="auto" data-title="Group Button Action" data-desc-position="top"><img alt="Group Button Action" src="../assets/general/UI_Extension_Gifs/groupButton.gif" /></a>
    <figcaption>Group Button Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/iconButton.gif" data-type="image" data-width="100%" data-height="auto" data-title="Icon Button Icons" data-desc-position="top"><img alt="Icon Button Icons" src="../assets/general/UI_Extension_Gifs/iconButton.gif" /></a>
    <figcaption>Icon Button Icons</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;">N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/spinner.gif" data-type="image" data-width="100%" data-height="auto" data-title="Spinner Icons" data-desc-position="top"><img alt="Spinner Icons" src="../assets/general/UI_Extension_Gifs/spinner.gif" /></a>
    <figcaption>Spinner Icons</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>increment</code> or <code>decrement</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition failure">
<p class="admonition-title">Does not fire events</p>
</div>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/controlWheel.gif" data-type="image" data-width="100%" data-height="auto" data-title="Directional Pad Action" data-desc-position="top"><img alt="Directional Pad Action" src="../assets/general/UI_Extension_Gifs/controlWheel.gif" /></a>
    <figcaption>Directional Pad Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>up</code>, <code>down</code>, <code>left</code>, <code>right</code>, <code>center</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition failure">
<p class="admonition-title">Does not fire events</p>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>
<p><strong>xAPI(s)</strong>: </p>
<ul>
<li>xEvent UserInterface Extensions Widget Action</li>
<li>xCommand UserInterface Message Rating Display</li>
<li>xCommand UserInterface Extensions Panel Open</li>
<li>xCommand Audio Sound Play</li>
</ul>
</li>
<li>
<p><strong>Goal</strong>: </p>
<ul>
<li>
<p>Like we did with Panels, we can open a hidden interface based on certain events coming from a widget</p>
</li>
<li>
<p>Leverage the Pressed and Released types of a Widget Button's events in 2 different ways</p>
</li>
<li>Pressed: When held for 3 seconds, open up a hidden panel</li>
<li>Released: If released before the 3 second mark, open up a Message Rating prompt</li>
</ul>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Install the <mark>MessageRating.xml</mark> UI extension in the UI Extensions Editor</li>
<li>
<p>Install the <mark>HiddenMenu.xml</mark> UI extension in the UI Extensions Editor</p>
</li>
<li>
<p>Create a new Macro called <mark>Pressed and Released Demo</mark>, save and activate it</p>
</li>
<li>
<p>In this macro do the following</p>
<ul>
<li>define an object called <code>pressHandler</code> and assign the value of <code>''</code>;</li>
<li>define an object called <code>showHidden</code> and assign the value of <code>false</code>;<ul>
<li></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">pressHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>Subscribe to xEvent UserInterface Extensions Widget Action</li>
<li>
<ul>
<li>Use an <code>if</code> statement to see if the WidgetId matches "ratingSystem"</li>
<li>
<ul>
<li>Within this <code>if</code> statement, assign ES6 JS's <mark>setTimeout()</mark> function to the <code>pressHandler</code> object</li>
<li>In the first parameter of the <mark>setTimeout()</mark>, assign a short-hand function  and define the following in this short-hand function<ul>
<li>xCommand Audio Sound Play Sound: Binding</li>
<li>Update <code>showHidden = true;</code></li>
</ul>
</li>
</ul>
<p>Use an <code>if</code> statement to compare the incoming Widget Type to the value <code>pressed</code></p>
<ul>
<li>In the first parameter of the <mark>setTimeout()</mark>, assign the value of <code>3000</code> (milliseconds)</li>
</ul>
</li>
</ul>
<p>Within this Subscription:</p>
<ul>
<li>
<ul>
<li>Within this <code>if</code> statement, run the ES6 JS function <mark>clearTimeout()</mark> and pass <code>pressHandler</code> object as it's only parameter</li>
</ul>
<p>Use an <code>if</code> statement to compare the incoming Widget Type to the value <code>released</code></p>
<ul>
<li>Use an <code>if</code> statement to check the value of the <code>showHidden</code> object<ul>
<li>If true, do the following<ul>
<li>Run xCommand UserInterface Extensions Panel Open with the following parameter<ul>
<li>PanelId: hiddenMenu</li>
</ul>
</li>
<li>Update <code>showHidden = false;</code></li>
</ul>
</li>
<li>If false, do the following<ul>
<li>Run xCommand UserInterface Message Rating Display with the following Parameters<ul>
<li>Title: "Rate this Experience"</li>
<li>Text: "1 being the lowest, 5 being the highest"</li>
<li>Duration: 30</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="example">
<summary>View Subscription</summary>
<div class="highlight"><pre><span></span><code><span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;ratingSystem&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;pressed&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">pressHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">Play</span><span class="p">({</span><span class="w"> </span><span class="nx">Sound</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Binding&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">pressHandler</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">showHidden</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span><span class="w"> </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;hiddenMenu&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">Rating</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">          </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Rate this Experience&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1 being the lowest, 5 being the highest&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
</details>
<ul>
<li>Once complete, Save and Activate this Macro</li>
<li>Open the <mark>Pressed and Released</mark> Demo Panel<ul>
<li>Click the <ins class="critic">Start Survey</ins> Button<ul>
<li>You should see the Rating Display with a selection of 1 to 5 start</li>
</ul>
</li>
<li>Then tress and hold the Start Survey <ins class="critic">Start Survey</ins> for 3 seconds<ul>
<li>You should hear a faint <strong>beep beep</strong></li>
<li>That sound indicates you held the button long enough and can now release<ul>
<li>You should see a Secret Rating System contained in a Panel using a Group Button</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<details>
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">pressHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;ratingSystem&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;pressed&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">pressHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">Audio</span><span class="p">.</span><span class="nx">Sound</span><span class="p">.</span><span class="nx">Play</span><span class="p">({</span><span class="w"> </span><span class="nx">Sound</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Binding&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">pressHandler</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">showHidden</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">showHidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Open</span><span class="p">({</span><span class="w"> </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;hiddenMenu&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Message</span><span class="p">.</span><span class="nx">Rating</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">          </span><span class="nx">Title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Rate this Experience&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">Text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1 being the lowest, 5 being the highest&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">Duration</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
</details>
</li>
</ul>
</details>
<details class="lesson">
<summary>Expanding Native Share Sources [Under Construction]</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At times, it's necessary to expand the number of video inputs available on a Codec using HDMI switchers/matrices</p>
<p>Building a custom panel to allow a user to select these external sources is entirely possible, but it clutters up the UserInterface</p>
<p>We do have tools to allow you to expand sources in the Codec's Native share tray and produce events for your Automation to relay on in order to tell that HDMI switchers/matrix to switch</p>
<p>This will give a consistent look and feel across all rooms while enabling expansion of your video inputs</p>
</div>
<p>For this lesson, we ask that you re-connect to the endpoint via SSH</p>
<ul>
<li>
<p><strong>xAPI(s)</strong>:</p>
<ul>
<li>xCommand UserInterface Presentation ExternalSource Add</li>
<li>xCommand UserInterface Presentation ExternalSource List</li>
<li>xCommand UserInterface Presentation ExternalSource Remove</li>
<li>xCommand UserInterface Presentation ExternalSource RemoveAll</li>
<li>xCommand UserInterface Presentation ExternalSource State Set</li>
<li>xEvent UserInterface Presentation ExternalSource Selected</li>
</ul>
</li>
<li>
<p><strong>Goal</strong>:</p>
<ul>
<li>Use the xAPIs above to expand our HDMI input source from 1 to 4</li>
<li>Set their states and subscribe to when they are selected</li>
</ul>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>First, select the Share Tray to your Codec and review the available sources</li>
<li>Log into your device via SSH</li>
<li>Run the following commands
<div class="highlight"><pre><span></span><code>xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>RemoveAll
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>Add<span class="w"> </span>ConnectorId:<span class="w"> </span><span class="m">3</span><span class="w"> </span>Name:<span class="w"> </span><span class="s2">&quot;External 1&quot;</span><span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_1<span class="w"> </span>Type:<span class="w"> </span>PC
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>State<span class="w"> </span>Set<span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_1<span class="w"> </span>State:<span class="w"> </span>Ready
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>Add<span class="w"> </span>ConnectorId:<span class="w"> </span><span class="m">3</span><span class="w"> </span>Name:<span class="w"> </span><span class="s2">&quot;External 2&quot;</span><span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_2<span class="w"> </span>Type:<span class="w"> </span>PC
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>State<span class="w"> </span>Set<span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_2<span class="w"> </span>State:<span class="w"> </span>NotReady
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>Add<span class="w"> </span>ConnectorId:<span class="w"> </span><span class="m">3</span><span class="w"> </span>Name:<span class="w"> </span><span class="s2">&quot;External 3&quot;</span><span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_3<span class="w"> </span>Type:<span class="w"> </span>PC
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>State<span class="w"> </span>Set<span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_3<span class="w"> </span>State:<span class="w"> </span>Error<span class="w"> </span>ErrorReason:<span class="w"> </span><span class="s2">&quot;HDMI Switcher On Vacation&quot;</span>
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>Add<span class="w"> </span>ConnectorId:<span class="w"> </span><span class="m">3</span><span class="w"> </span>Name:<span class="w"> </span><span class="s2">&quot;External 4&quot;</span><span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_4<span class="w"> </span>Type:<span class="w"> </span>PC
xCommand<span class="w"> </span>UserInterface<span class="w"> </span>Presentation<span class="w"> </span>ExternalSource<span class="w"> </span>State<span class="w"> </span>Set<span class="w"> </span>SourceIdentifier:<span class="w"> </span>ext_4<span class="w"> </span>State:<span class="w"> </span>Ready
</code></pre></div></li>
</ul>
</li>
</ul>
</details>
<details class="tool">
<summary>Shell to XML Conversion Macro</summary>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">shellPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;xCommand Message Send&#39;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">convertToXML</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">filterData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">structureXapi</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">filterData</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xcommand&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xcom&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">formXmlPath</span><span class="p">(</span><span class="nx">filterData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;set&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xconfiguration&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xconfig&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">filterData</span><span class="p">.</span><span class="nx">SubType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">formXmlPath</span><span class="p">(</span><span class="nx">filterData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;set&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">formXmlPath</span><span class="p">(</span><span class="nx">filterData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;set&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xstat&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;xstatus&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">filterData</span><span class="p">.</span><span class="nx">SubType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">formXmlPath</span><span class="p">(</span><span class="nx">filterData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">formXmlPath</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;set&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;set&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">openXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">``</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">closeXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">``</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">paramXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">``</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">openXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">openXML</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="si">}</span><span class="sb">&gt;`</span>
<span class="w">      </span><span class="nx">closeXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">closeXML</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;/</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">[</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">)]</span><span class="si">}</span><span class="sb">&gt;`</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">Parameters</span><span class="p">).</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">objects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">Parameters</span><span class="p">)</span>
<span class="w">      </span><span class="nx">objects</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">element</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">paramXML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">paramXML</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;</span><span class="si">${</span><span class="nx">element</span><span class="si">}</span><span class="sb">&gt;</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">Parameters</span><span class="p">[</span><span class="nx">element</span><span class="p">]</span><span class="si">}</span><span class="sb">&lt;/</span><span class="si">${</span><span class="nx">element</span><span class="si">}</span><span class="sb">&gt;`</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">XmlPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">&gt;</span><span class="si">${</span><span class="nx">openXML</span><span class="si">}${</span><span class="nx">paramXML</span><span class="si">}${</span><span class="nx">closeXML</span><span class="si">}</span><span class="sb">&lt;/</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">&gt;`</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">XmlPath</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;get&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">/`</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">xApi</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="si">}</span><span class="sb">/`</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">path</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">determineType</span><span class="p">(</span><span class="nx">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//Basically if you have a : colon, you&#39;ve provided me data, else you&#39;re requesting it</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">dt</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">dt</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">count</span><span class="o">++</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;set&#39;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;get&#39;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">structureXapi</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">]</span><span class="w">                          </span><span class="c1">//First item in the string is the type</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="w">                             </span><span class="c1">//Then we gather all values for later processing. We split based on the [space]s in the string</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">subType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">determineType</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w">                     </span><span class="c1">//Checks to see if any values contains a : colon, which indicates a set vs a get</span>
<span class="w">  </span><span class="nx">data</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span><span class="w">                                          </span><span class="c1">//Remove the type from the data before we filter through it</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">dots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">paramStartFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">                            </span><span class="c1">// False until first parameter pours in</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">paramValueFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">                            </span><span class="c1">// False until next parameter shows</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">paramValueFlag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">                      </span><span class="c1">// &#39;:&#39; all parameters proceed with a colon, use this to determine which is a parameter and which is a value</span>
<span class="w">        </span><span class="nx">paramStartFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">                          </span><span class="c1">// Stays true until done</span>
<span class="w">        </span><span class="nx">paramValueFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">                          </span><span class="c1">// Switch to true to handle value capture logic</span>
<span class="w">        </span><span class="nx">params</span><span class="p">[</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span><span class="w">      </span><span class="c1">// the value is one position ahead of the parameter</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">paramStartFlag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">                  </span><span class="c1">//If we see the next parameter via a colon, we set the value flag back to false</span>
<span class="w">          </span><span class="nx">paramValueFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">                                        </span><span class="c1">// Else we concatenate the next value, adding back in the space we split out above</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">paramList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">lastParam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">paramList</span><span class="p">[</span><span class="nx">paramList</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">]</span>
<span class="w">          </span><span class="nx">params</span><span class="p">[</span><span class="nx">lastParam</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">params</span><span class="p">[</span><span class="nx">lastParam</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">dots</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w">                              </span><span class="c1">// Both flags are false, so we&#39;re still gathering the xApi path from the data array</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">paramValueFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Type</span><span class="o">:</span><span class="w"> </span><span class="nx">type</span><span class="p">,</span><span class="w"> </span><span class="nx">SubType</span><span class="o">:</span><span class="w"> </span><span class="nx">subType</span><span class="p">,</span><span class="w"> </span><span class="nx">xApi</span><span class="o">:</span><span class="w"> </span><span class="nx">dots</span><span class="p">,</span><span class="w"> </span><span class="nx">Parameters</span><span class="o">:</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;XML String:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">convertToXML</span><span class="p">(</span><span class="w"> </span><span class="nx">shellPath</span><span class="p">))</span>
</code></pre></div>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../wx1_1451_part_2/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab&amp;colon; Accessing Device xAPI">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab&colon; Accessing Device xAPI
              </div>
            </div>
          </a>
        
        
          
          <a href="../wx1_1451_part_3/" class="md-footer__link md-footer__link--next" aria-label="Next: Lab&amp;colon; Build Room Documentation Macro">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Lab&colon; Build Room Documentation Macro
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Cisco
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.instant", "navigation.top", "navigation.footer", "search.suggest", "content.code.copy", "toc.integrate", "content.tooltips", "content.footnote.tooltips"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "fade", "closeEffect": "fade", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>