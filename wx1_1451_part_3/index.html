
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Video Device xAPI Lab">
      
      
        <meta name="author" content="Robert(Bobby) McGonigle Jr">
      
      
      
        <link rel="prev" href="../AV_xAPI/">
      
      
        <link rel="next" href="../CodectoCodec/">
      
      
      <link rel="icon" href="../template_assets/webex75.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Lab: Build Room Documentation Macro - Video Device xAPI Lab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#build-room-documentation-macro" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Video Device xAPI Lab" class="md-header__button md-logo" aria-label="Video Device xAPI Lab" data-md-component="logo">
      
  <img src="../template_assets/webexLogo91.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Video Device xAPI Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab&colon; Build Room Documentation Macro
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home&nbsp<i class="fa-solid fa-house" style="color:#B197FC;"></i>

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
    
  
  Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tools/" class="md-tabs__link">
        
  
    
  
  Tools&nbsp<i class="fa-solid fa-gear"></i>

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../cheatsheet/" class="md-tabs__link">
          
  
    
  
  Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../communities/" class="md-tabs__link">
          
  
    
  
  Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Video Device xAPI Lab" class="md-nav__button md-logo" aria-label="Video Device xAPI Lab" data-md-component="logo">
      
  <img src="../template_assets/webexLogo91.png" alt="logo">

    </a>
    Video Device xAPI Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home&nbsp<i class="fa-solid fa-house" style="color:#B197FC;"></i>
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lab&nbsp<i class="fa-solid fa-flask" style="color:#fdd649;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wx1_1451_part_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Accessing Device xAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AV_xAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Utilizing AV Specific APIs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab&colon; Build Room Documentation Macro
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab&colon; Build Room Documentation Macro
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#section-31-outlining-our-customization" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.1: Outlining our Customization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-32-building-the-userinterface-ui" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.2: Building the UserInterface (UI)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Section 3.2: Building the UserInterface (UI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-navigating-the-ui-extensions-editor" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.1 - Navigating the UI Extensions Editor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-creating-our-customizations-interface" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.2 - Creating our Customization's Interface
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-33-adding-function-to-the-ui-with-macros" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.3: Adding Function to the UI with Macros
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Section 3.3: Adding Function to the UI with Macros">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-navigating-the-macro-editor-and-creating-our-new-macro" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.1 - Navigating the Macro Editor and Creating our new Macro
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-332-accessing-ui-events-and-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.3.2: Accessing UI Events and Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-333-adding-function-to-our-widgets" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.3.3: Adding function to our Widgets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-34-optimizing-our-solution" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.4: Optimizing our Solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Section 3.4: Optimizing our Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-341-imports-exports-and-a-config-object" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.4.1: Imports, Exports and a Config Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-342-automating-the-userinterface" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.4.2: Automating the UserInterface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-343-centralize-your-doc-urls" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3.4.3: Centralize your Doc URLs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CodectoCodec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Implement Codec to Codec Communication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WorkSpaceIntegrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; WorkSpace Integrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wx1_1451_part_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab&colon; Deploying your Customization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools&nbsp<i class="fa-solid fa-gear"></i>
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cheat Sheet&nbsp<i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CheatSheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../challengeAnswers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Challenge Answers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Resources&nbsp<i class="fa-solid fa-globe" style="color:#04C0FC;"></i>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../communities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devSites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Sites
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="build-room-documentation-macro"><u><strong>Build Room Documentation Macro</strong></u></h1>
<h2 id="section-31-outlining-our-customization"><u><strong>Section 3.1: Outlining our Customization</strong></u></h2>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>When Jumping into your customization, it's good to understand a few things prior to diving in. </p>
<p>You should should consider the following</p>
<p><h4>KEEP THINGS SIMPLE <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></h4></p>
<ul>
<li>There are some pretty robust solutions out there. It can be easy to over-engineer a solution, especially as your skill set starts to flourish.</li>
<li>Wherever possible, keep things simple<ul>
<li>But sometimes too simple can be a bottleneck, do what's best to provide a robust solution, while also not getting too far into the weeds.</li>
</ul>
</li>
</ul>
<p><h4>Understanding your Hardware</h4></p>
<ul>
<li>What are the hardware and software differences between codecs?<ul>
<li>Should I hard code Video Output 3 or should I dynamically discover those inputs</li>
</ul>
</li>
<li>How many peripherals are connected?<ul>
<li>This could change from room to room. Knowing how to adapt this in your solution dynamically will reduce complications when deploying at scale</li>
</ul>
</li>
<li>Are there differences in how the xAPI is executed between devices?<ul>
<li>There certainly is, but it's not impossible to handle and make you solution robust and rugged</li>
</ul>
</li>
<li>What external services are available to me to optimize or enhance this experience?<ul>
<li>APIs are wonderful, and everywhere. Explore them and find out what's possible when they start to work together</li>
</ul>
</li>
</ul>
<p><h4>Understanding your Stakeholders</h4></p>
<ul>
<li>Who will interact with my customization?<ul>
<li>IT Folks, C-Suite, Engineers, Admins, Etc</li>
</ul>
</li>
<li>Are you working with the person procuring or using the solution?<ul>
<li>Procurement and the end use may be one in the same, but at times they are disconnected. If possible, engage with those who ultimately use your customization to get a better understanding of their need.</li>
</ul>
</li>
<li>How do these individuals do work?<ul>
<li>Is this a seminar space, a conference room, an open collaboration space, a classroom, a lab?</li>
<li>Optimizing your solution to fit those needs are key to success</li>
</ul>
</li>
<li>What are their expectations of the solution?<ul>
<li>Is the vision of the end user in line with your vision of the solution. Keeping an open dialogue with your customer as to what's possible will help keep your goals in line</li>
</ul>
</li>
<li>What can you anticipate that wasn't considered in the original ask?<ul>
<li>Some asks are too simple. Putting in the extra 2 cents to really flesh out a professional solution, even for a small ask, can yield a better solution in the end.</li>
</ul>
</li>
</ul>
<p><h4>Tackle your solution from outside the box</h4></p>
<ul>
<li>Best to design for scale, wherever possible<ul>
<li>How can I make my solution on all hardware and software iterations?</li>
</ul>
</li>
<li>Make you solution flexible<ul>
<li>If your code can solve for multiple room flows, build in tools to let you quickly adapt your code</li>
</ul>
</li>
<li>Think of your colleagues and future self<ul>
<li>Some day you or a colleague may be called upon to troubleshoot a solution, make sure you leave breadcrumbs or documentation to help yourself years from now.</li>
</ul>
</li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">Today's solution outline</p>
<p>In this lab of this lab, we'll build a Macro that will allow folks to either View a Document or Scan a QR code to take the document with them on your device</p>
<p>We'll review how to:</p>
<ul>
<li>Build a UserInterface</li>
<li>Map those UserInterface elements to actions driven by an accompanying macro</li>
<li>Integrate a 3rd party QR code service, leveraging APIs external to the Codec</li>
<li>Organize our code and make it scalable</li>
<li>Automate the generation of out UserInterface</li>
</ul>
</div>
<hr />
<hr />
<h2 id="section-32-building-the-userinterface-ui"><u><strong>Section 3.2: Building the UserInterface (UI)</strong></u></h2>
<h3 id="321-navigating-the-ui-extensions-editor"><strong>3.2.1 - Navigating the UI Extensions Editor</strong></h3>
<div class="admonition example">
<p class="admonition-title">Access the UI Extensions Editor</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:7"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><input id="__tabbed_1_6" name="__tabbed_1" type="radio" /><input id="__tabbed_1_7" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Device Login</label><label for="__tabbed_1_2">Device Home</label><label for="__tabbed_1_3">UI Extensions Editor</label><label for="__tabbed_1_4">Adding a Panel</label><label for="__tabbed_1_5">Adding Widgets</label><label for="__tabbed_1_6">Edit Text Elements</label><label for="__tabbed_1_7">Add/Delete Rows and Pages</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>Open a Browser and enter your Codec's IP as a URL and hit enter</li>
<li>Login with your Username and Password</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_DeviceLogin.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Login" data-desc-position="top"><img alt="Device Login" src="../assets/wx1_1451_part_3/3-2_DeviceLogin.png" width="600" /></a>
    <figcaption>Device Login Page</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<ul>
<li>Select the UI Extensions Editor on the Left-Hand Navigation Bar</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_DeviceHome.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Home" data-desc-position="top"><img alt="Device Home" src="../assets/wx1_1451_part_3/3-2_DeviceHome.png" width="700" /></a>
    <figcaption>Device Home Page</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_UI_Editor.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Login" data-desc-position="top"><img alt="Device Login" src="../assets/wx1_1451_part_3/3-2_UI_Editor.png" width="800" /></a>
    <figcaption>UI Extensions Editor</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<div class="admonition important inline end">
<p class="admonition-title">Always Assign Unique PanelIds</p>
<p>You may not be the only developer. Assigning PanelIds unique to your solution helps limit conflicts with other solutions.</p>
</div>
<div class="admonition gif">
<p class="admonition-title">How to Add a Panel</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_Add_UI_Panel.gif" data-type="image" data-width="100%" data-height="auto" data-title="Adding a Panel" data-desc-position="top"><img alt="Adding a Panel" src="../assets/wx1_1451_part_3/3-2_Add_UI_Panel.gif" width="600" /></a>
    <figcaption>Adding a new Panel</figcaption>
</figure></p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<ul>
<li>Panels<ul>
<li>Creates a Panel with pages and rows within, containing widgets</li>
</ul>
</li>
<li>Action Buttons<ul>
<li>Creates a panel</li>
</ul>
</li>
<li>Web Widgets<ul>
<li>Creates a Web Widget on your OSD</li>
</ul>
</li>
<li>Web Apps<ul>
<li>Creates a Panel, that when <code>clicked</code>, opens a URL to a target Web Page</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<div class="admonition important inline end">
<p class="admonition-title">Always Assign Unique WidgetIds</p>
<p>You may not be the only developer. Assigning WidgetIds unique to your solution helps limit conflicts with other solutions.</p>
</div>
<div class="admonition gif">
<p class="admonition-title">How to Add Widgets</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_Add_UI_Widgets.gif" data-type="image" data-width="100%" data-height="auto" data-title="Adding Widgets" data-desc-position="top"><img alt="Adding Widgets" src="../assets/wx1_1451_part_3/3-2_Add_UI_Widgets.gif" width="600" /></a>
    <figcaption>Adding bew Widgets</figcaption>
</figure></p>
</div>
</div>
<div class="tabbed-block">
<div class="admonition tip inline end">
<p class="admonition-title">Tip</p>
<p>Some text elements have limited space, but you won't see an error</p>
<p>Make sure the Text Renders correctly on your device after you apply it</p>
</div>
<div class="admonition gif">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_Rename_Text_Elements.gif" data-type="image" data-width="100%" data-height="auto" data-title="Edit Text Elements" data-desc-position="top"><img alt="Edit Text Elements" src="../assets/wx1_1451_part_3/3-2_Rename_Text_Elements.gif" width="600" /></a>
    <figcaption>Editing Text Elements</figcaption>
</figure></p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<ul>
<li>Double clicking on any text element allows you to edit the filed</li>
<li>Change the Text as you need it, then press enter</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<div class="admonition tip inline end">
<p class="admonition-title">Tip</p>
<p>Keep in mind more is not always better. Try to keep things simple</p>
</div>
<div class="admonition gif">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_Add-Delete_Pages-Rows.gif" data-type="image" data-width="100%" data-height="auto" data-title="Adding a Panel" data-desc-position="top"><img alt="Adding a Panel" src="../assets/wx1_1451_part_3/3-2_Add-Delete_Pages-Rows.gif" width="600" /></a>
    <figcaption>Adding a new Panel</figcaption>
</figure></p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<ul>
<li>You can add as many rows and pages as your solution needs</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<h3 id="322-creating-our-customizations-interface"><strong>3.2.2 - Creating our Customization's Interface</strong></h3>
<details class="lesson" open="open">
<summary>Lesson: Create a New Panel Button</summary>
<div class="admonition tool inline end">
<p class="admonition-title">Save Extension Button</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_UI-SaveButton.png" data-type="image" data-width="100%" data-height="auto" data-title="UI Save Button" data-desc-position="top"><img alt="UI Save Button" src="../assets/wx1_1451_part_3/3-2_UI-SaveButton.png" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</div>
<ul>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Create a new Panel</li>
<li>Assign this panel's <mark>id</mark> as: <pre><code>wx1_QrDocs</code></pre></li>
<li>Assign this panel's <mark>name</mark> as: <pre><code>Room Docs</code></pre></li>
<li>Assign this panel's <mark>location</mark> as: <code>HomeScreenAndCallControls</code></li>
<li>Pick any icon you wish</li>
<li>Pick any Panel Color you wish</li>
<li>Save your Extension<ul>
<li>You should be able to see your Panel on the Codec's Touch Interface</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>View Successful UI Execution</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">OSD</label><label for="__tabbed_2_2">Opened Panel</label><label for="__tabbed_2_3">UI Properties</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2-2_UI-OSD.png" data-type="image" data-width="100%" data-height="auto" data-title="Room Docs OSD 3.2.2" data-desc-position="top"><img alt="Room Docs OSD 3.2.2" src="../assets/wx1_1451_part_3/3-2-2_UI-OSD.png" width="600" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2-2_UI-Open.png" data-type="image" data-width="100%" data-height="auto" data-title="Room Docs Open 3.2.2" data-desc-position="top"><img alt="Room Docs Open 3.2.2" src="../assets/wx1_1451_part_3/3-2-2_UI-Open.png" width="600" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2-2_UI-Properties.png" data-type="image" data-width="100%" data-height="auto" data-title="UI Properties 3.2.2" data-desc-position="top"><img alt="UI Properties 3.2.2" src="../assets/wx1_1451_part_3/3-2-2_UI-Properties.png" width="150" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</div>
</div>
</div>
</details>
<details class="challenge">
<summary>Challenge: Rename the Page to Room Docs</summary>
<ul>
<li>Rename the Page Name from <code>Page</code> to: <pre><code>Room Docs</code></pre></li>
<li>Assign the PageId as: <pre><code>wx1_QrDocs~RoomDocs</code></pre></li>
</ul>
</details>
</details>
<details class="lesson">
<summary>Lesson: Add Solution Widgets</summary>
<div class="admonition tool inline end">
<p class="admonition-title">Save Extension Button</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_UI-SaveButton.png" data-type="image" data-width="100%" data-height="auto" data-title="UI Save Button" data-desc-position="top"><img alt="UI Save Button" src="../assets/wx1_1451_part_3/3-2_UI-SaveButton.png" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</div>
<ul>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Rename Row 1 to: <pre><code>Lab 1451</code></pre><ul>
<li>Add 2 Buttons to this row<ul>
<li>Set the following properties for the left button<ul>
<li>Rename Button Text <code>Button</code> to: <pre><code>Open Site</code></pre></li>
<li>Assign WidgetId: <pre><code>wx1_QrDocs~OpenSite~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</code></pre></li>
<li>Set the Widget Width to 2</li>
</ul>
</li>
<li>Set the following properties for the Right button<ul>
<li>Rename Button Text <code>Button</code> to: <pre><code>Open QrCode 🔳</code></pre></li>
<li>Assign WidgetId: <pre><code>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</code></pre></li>
<li>Set the Widget Width to 2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Add a second row, with the name: <pre><code>Reimagine Workspaces</code></pre><ul>
<li>Add 2 Buttons to this row<ul>
<li>Set the following properties for the left button<ul>
<li>Rename Button Text <code>Button</code> to: <pre><code>Open Site</code></pre></li>
<li>Assign WidgetId: <pre><code>wx1_QrDocs~OpenSite~https://www.webex.com/us/en/workspaces.html</code></pre></li>
<li>Set the Widget Width to 2</li>
</ul>
</li>
<li>Set the following properties for the Right button<ul>
<li>Rename Button Text <code>Button</code> to: <pre><code>Open QrCode 🔳</code></pre></li>
<li>Assign WidgetId: <pre><code>wx1_QrDocs~OpenQrCode~https://www.webex.com/us/en/workspaces.html</code></pre></li>
<li>Set the Widget Width to 2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Save your Extension<ul>
<li>You should be able to see your Panel on the Codec's Touch Interface</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>View Successful UI Execution</summary>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2-2_UI-Open_AddWidgets.png" data-type="image" data-width="100%" data-height="auto" data-title="Room Docs Open 3.2.2" data-desc-position="top"><img alt="Room Docs Open 3.2.2" src="../assets/wx1_1451_part_3/3-2-2_UI-Open_AddWidgets.png" width="600" /></a>
    <!-- <figcaption>Adding a new Panel</figcaption> -->
</figure></p>
</details>
<details class="challenge">
<summary>Add your Organization's HomePage <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></summary>
<p>You may have noticed the WidgetIds have a URL as apart of the ID</p>
<p>We'll be using this in the Macro we write later, to open this page</p>
<p>Here is how we're structuring WidgetIds for this lab</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ul>
<li>
<p>WidgetId Structure: appName~Action~URL</p>
<ul>
<li>appName: <code>wx1_QrDocs</code> -&gt; Let's us associate this interface with our Macro Script and helps make the WidgetId more unique</li>
<li>action: <code>OpenSite</code> or <code>OpenQrCode</code> -&gt; This will tell use how we want to open our URL</li>
<li>URL: This is the URL we want to open, or build a QR Code for</li>
<li>String Separator: <code>~</code> -&gt; Using a unique character, such as this tilde, can help use split up and access this information later in the Macro</li>
</ul>
</li>
</ul>
<details class="curious">
<summary>Is this WidgetId format mandatory?</summary>
<p>Widget Ids are strings. This is just one of many examples of how you can structure your widgets. It's not required to structure them like this, <ins class="critic">with the exception of this lab</ins>. </p>
<p>So long as they are unique in your customization, you should be good to go</p>
</details>
</div>
<ul>
<li>Task: <ul>
<li>Create a 3rd Row</li>
<li>Add in an <mark>Open</mark> Site button and an <mark>Open QrCode 🔳</mark> with your Organizations Home Page as the Url</li>
<li>Be sure to assign <code>wx1_QrDocs</code> as the appName and the correct action to the button they represent</li>
</ul>
</li>
</ul>
<details class="tip">
<summary>Hint</summary>
<p>OpenSite: <pre><code>wx1_QrDocs~OpenSite~<mark>YOUR_ORG_HOMEPAGE</mark></code></pre>
OpenQrCode: <pre><code>wx1_QrDocs~OpenQrCode~<mark>YOUR_ORG_HOMEPAGE</mark></code></pre></p>
</details>
</details>
</details>
<hr />
<hr />
<h2 id="section-33-adding-function-to-the-ui-with-macros"><u><strong>Section 3.3: Adding Function to the UI with Macros</strong></u></h2>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>Now that we have our UserInterface in place, we can start to build our solution</p>
<p>We'll be using the Macro Editor for this solution, but know that you can do these very same tasks from any other avenue we explored in Part 2 of this lab</p>
<p>The benefit of Macros, is that they come with every Cisco Codec running Ce9.2 or newer (with the exception of the Sx10). So no need to procure hardware or spin up a service to start building a solution <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" /></p>
<div class="admonition important">
<p class="admonition-title">Note</p>
<p>It's recommended you have run through sections 2.2 and 2.6 as a Minimum before proceeding</p>
</div>
</div>
<h3 id="331-navigating-the-macro-editor-and-creating-our-new-macro"><strong>3.3.1 - Navigating the Macro Editor and Creating our new Macro</strong></h3>
<p>If you missed Section 2.6 in part 2 of this lab, please watch this Vidcast</p>
<details class="vidcast">
<summary>Vidcast: Macro Editor IDE Review</summary>
<p><div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
  <iframe src="https://app.vidcast.io/share/embed/d6dacbb3-9792-4d27-b1fa-434f2ff37f03" width="100%" height="100%" title="Macro Editor IDE Review" frameborder="0" loading="lazy" allowfullscreen style="position:absolute; top:0; left: 0;border: solid; border-radius:12px;"></iframe>
</div></p>
</details>
<div class="admonition important">
<p class="admonition-title">Create a new Macro</p>
<ul>
<li>Select <mark>Create new macro</mark> in the Macro Editor</li>
<li>Name this macro <mark>Room Docs</mark></li>
<li><ins class="critic">Save</ins> and <ins class="critic">Activate+</ins> the <mark>Room Docs</mark> Macro</li>
</ul>
<details class="success">
<summary>Compare your Setup</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="3:4"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><input id="__tabbed_3_4" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Device Login</label><label for="__tabbed_3_2">Device Home</label><label for="__tabbed_3_3">Macro Editor</label><label for="__tabbed_3_4">Create, Save and Activate a Macro</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition failure">
<p>if NOT already logged into the endpoint, follow these steps</p>
<ul>
<li>Open a Browser and enter your Codec's IP as a URL and hit enter</li>
<li>Login with your Username and Password</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_DeviceLogin.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Login" data-desc-position="top"><img alt="Device Login" src="../assets/wx1_1451_part_3/3-2_DeviceLogin.png" width="400" /></a>
    <figcaption>Device Login Page</figcaption>
</figure></p>
</div>
<div class="admonition warning">
<p>If in the UI Extensions Editor</p>
<ul>
<li>Click on the Device Name in the Top Left hand corner of the UI Extensions Editor to get back to the Device Home Page</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3_DeviceHome.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Home" data-desc-position="top"><img alt="Device Home" src="../assets/wx1_1451_part_3/3-3_DeviceHome.png" width="600" /></a>
    <figcaption>Device Home Page</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3_Macro_Editor.png" data-type="image" data-width="100%" data-height="auto" data-title="Macro Editor" data-desc-position="top"><img alt="Macro Editor" src="../assets/wx1_1451_part_3/3-3_Macro_Editor.png" width="700" /></a>
    <figcaption>The Macro Editor</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<div class="admonition gif">
<p class="admonition-title">Create, Save and Activate a Macro</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3_CreateMacro.gif" data-type="image" data-width="100%" data-height="auto" data-title="Create, Save and Activate a Macro" data-desc-position="top"><img alt="Create, Save and Activate a Macro" src="../assets/wx1_1451_part_3/3-3_CreateMacro.gif" width="600" /></a>
    <figcaption>Create, Save and Activate a Macro</figcaption>
</figure></p>
</div>
</div>
</div>
</div>
</details>
</div>
<h3 id="section-332-accessing-ui-events-and-logging"><u><strong>Section 3.3.2: Accessing UI Events and Logging</strong></u></h3>
<details class="lesson" open="open">
<summary>Lesson: Subscribing to Widget Actions</summary>
<ul>
<li>
<p><strong>xAPI</strong>: xEvent UserInterface Widget Action</p>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>
<p>Let's start by subscribing to the xAPI Path above using Macro Syntax</p>
</li>
<li>
<p>Take the Callback information generated by this event, and log it to the Macro Console using <code>console.log()</code></p>
</li>
<li>
<p>Once complete, <mark>Save</mark> and Activate the macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>Monitor the Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your Macro</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It's ok if your macro's structure doesn't match 1:1 with the examples below</p>
<p>As long as they information we access is the same, then format is up to the developers preference</p>
</div>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({</span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="p">})</span>
<span class="p">})</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>Macro</th>
<th>WidgetId</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><ins class="critic">pressed</ins></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><mark>released</mark></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><code>clicked</code></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><ins class="critic">pressed</ins></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><mark>released</mark></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
<td><code>clicked</code></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenSite~https://www.webex.com/us/en/workspaces.html</td>
<td><ins class="critic">pressed</ins></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenSite~https://www.webex.com/us/en/workspaces.html</td>
<td><mark>released</mark></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenSite~https://www.webex.com/us/en/workspaces.html</td>
<td><code>clicked</code></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://www.webex.com/us/en/workspaces.html</td>
<td><ins class="critic">pressed</ins></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://www.webex.com/us/en/workspaces.html</td>
<td><mark>released</mark></td>
<td><code></code></td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>wx1_QrDocs~OpenQrCode~https://www.webex.com/us/en/workspaces.html</td>
<td><code>clicked</code></td>
<td><code></code></td>
</tr>
</tbody>
</table>
</details>
</details>
<details class="curious">
<summary>Why does each Widget click have 3 events fire?</summary>
<p>Good Catch <img alt="😃" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f603.svg" title=":smiley:" />! Many widgets offer 1-3 events that will fire based on the conditions of the action</p>
<p>This is important to know, as you may only want an action to happen once, not upwards of 3 times, when building your automation</p>
<p>We can use techniques in ES6 JS to filter out what we're interested in for these scenarios</p>
<p>For reference, here's a list of Widgets and their event payloads</p>
<div class="admonition experiment">
<p class="admonition-title">Click on each table below to review each Widget</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:9"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><input id="__tabbed_4_5" name="__tabbed_4" type="radio" /><input id="__tabbed_4_6" name="__tabbed_4" type="radio" /><input id="__tabbed_4_7" name="__tabbed_4" type="radio" /><input id="__tabbed_4_8" name="__tabbed_4" type="radio" /><input id="__tabbed_4_9" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Toggle</label><label for="__tabbed_4_2">Slider</label><label for="__tabbed_4_3">Button</label><label for="__tabbed_4_4">GroupButton</label><label for="__tabbed_4_5">Icon Button</label><label for="__tabbed_4_6">Spinner</label><label for="__tabbed_4_7">TextBox</label><label for="__tabbed_4_8">Directional Pad</label><label for="__tabbed_4_9">Spacer</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/toggle.gif" data-type="image" data-width="100%" data-height="auto" data-title="Toggle Action" data-desc-position="top"><img alt="Toggle Action" src="../assets/general/UI_Extension_Gifs/toggle.gif" /></a>
    <figcaption>Toggle Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>changed</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>on</code> or <code>off</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/slider.gif" data-type="image" data-width="100%" data-height="auto" data-title="Slider Action" data-desc-position="top"><img alt="Slider Action" src="../assets/general/UI_Extension_Gifs/slider.gif" /></a>
    <figcaption>Slider Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>changed</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>Integer between 0 and 255</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/button.gif" data-type="image" data-width="100%" data-height="auto" data-title="Button Action" data-desc-position="top"><img alt="Button Action" src="../assets/general/UI_Extension_Gifs/button.gif" /></a>
    <figcaption>Button Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;">N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/groupButton.gif" data-type="image" data-width="100%" data-height="auto" data-title="Group Button Action" data-desc-position="top"><img alt="Group Button Action" src="../assets/general/UI_Extension_Gifs/groupButton.gif" /></a>
    <figcaption>Group Button Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/iconButton.gif" data-type="image" data-width="100%" data-height="auto" data-title="Icon Button Icons" data-desc-position="top"><img alt="Icon Button Icons" src="../assets/general/UI_Extension_Gifs/iconButton.gif" /></a>
    <figcaption>Icon Button Icons</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;">N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/spinner.gif" data-type="image" data-width="100%" data-height="auto" data-title="Spinner Icons" data-desc-position="top"><img alt="Spinner Icons" src="../assets/general/UI_Extension_Gifs/spinner.gif" /></a>
    <figcaption>Spinner Icons</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>increment</code> or <code>decrement</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition failure">
<p class="admonition-title">Does not fire events</p>
</div>
</div>
<div class="tabbed-block">
<div class="admonition gif inline end">
<p class="admonition-title">Gif</p>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/general/UI_Extension_Gifs/controlWheel.gif" data-type="image" data-width="100%" data-height="auto" data-title="Directional Pad Action" data-desc-position="top"><img alt="Directional Pad Action" src="../assets/general/UI_Extension_Gifs/controlWheel.gif" /></a>
    <figcaption>Directional Pad Action</figcaption>
</figure></p>
</div>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">WidgetId</td>
<td style="text-align: left;"><code>Assigned by the Developer on Widget Instantiation</code></td>
</tr>
<tr>
<td style="text-align: left;">Type</td>
<td style="text-align: left;"><code>pressed</code>, <code>released</code>, or <code>clicked</code></td>
</tr>
<tr>
<td style="text-align: left;">Value</td>
<td style="text-align: left;"><code>up</code>, <code>down</code>, <code>left</code>, <code>right</code>, <code>center</code></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="admonition failure">
<p class="admonition-title">Does not fire events</p>
</div>
</div>
</div>
</div>
</div>
</details>
<details class="lesson">
<summary>Lesson: Refine and Filter our Widget information</summary>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>As you saw in the previous example Widgets can produce 1-3 events to fire whenever you interact with them</p>
<p>It's best to filter this down to the specific even in question</p>
<p>In macros, we can use the tools offered to us by ES6 JS to complete this task</p>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: xEvent UserInterface Widget Action</p>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Replace your original <mark>console.log</mark> with <ins class="critic">console.debug</ins><ul>
<li>This will hide this log in the debug group, we can use this later to check our work</li>
</ul>
</li>
<li>Use an <code>if</code> ES6 JS statement to filter our WidgetId Event and confirm the widget belongs to our customization<ul>
<li>This can be done using ES6 JS's <code>.includes('wx1_QrDocs')</code> prototype</li>
</ul>
</li>
<li>Use an <code>if</code> ES6 JS statement to filter our Type event and check to see if it matches <mark>released</mark><ul>
<li>This can be done using ES6 JS's <strong>Equality</strong> <code>==</code> or <strong>Strict Equality</strong> <code>===</code> operators</li>
<li>We won't be using <del class="critic">pressed</del> or <del class="critic">clicked</del></li>
</ul>
</li>
<li>Use the <code>.split('~')</code> ES6 JS prototype to split out our app, action and url and assign them to objects using our tilde as the string separator</li>
<li>Use a <code>switch</code> ES6 JS statement to handle <code>OpenSite</code> and <code>OpenQrCode</code> actions respectively<ul>
<li>Place <mark>console.log(action, url)</mark> below the <code>OpenSite</code> case and <mark>console.warn(action, url)</mark> below the <code>OpenQrCode</code> case</li>
</ul>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Click the Tabs Below to see how each Task above is implemented</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:4"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><input id="__tabbed_5_4" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Verify WidgetID with <code>if</code> and <code>includes</code>&gt;</label><label for="__tabbed_5_2">Compare Type using <code>if</code> and <code>==</code>&gt;</label><label for="__tabbed_5_3">Assign app, action and URL using <code>split</code> &gt;</label><label for="__tabbed_5_4">Use <code>switch</code> to handle actions</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// &lt;-- Changed to Debug</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// &lt;-- Asks if WidgetIn includes wx1_QrDocs</span>

<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
<details class="question">
<summary>Why Use <code>includes()</code>?</summary>
<p>We structured all of our WidgetIds with the same prefix <mark>wx1_QrDocs</mark></p>
<p>This helps make our Widget References Unique, but also helps us ignore any widgets that don't include <mark>wx1_QrDocs</mark></p>
<p>If a solution were to have the same widgetId, then that 1 widget could have solutions fire from 2 different integration sources. In some cases, that's fine or even necessary, but it's best practice to make your widgets as unique to your solution as possible and for your solution to ignore any other chatter on the Codec</p>
</details>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes" target="_blank" >
      Learn more about the <code>.includes()</code> prototype <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/if...else" target="_blank" >
      Learn more about <code>if</code> statements <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Asked if the Type is equal to released</span>

<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/if...else" target="_blank" >
      Learn more about <code>if</code> statements <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators" target="_blank" >
      Learn more about <code>Operators</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;-- Extract our App, Action and Url and assigned them to the object they represent</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
<details class="question">
<summary>Why <code>.split()</code> our widget?</summary>
<p>This gives use new objects to work with. The benefit of how we implemented our WidgetId structure[<mark>app~action~url</mark>] allows us to make our code a bit more flexible</p>
<p>Now, if you wanted to add more sites, all you would need to do is add more buttons to the UI Extension following the WidgetId structure we set, and your Macro Code doesn't need to be modified to allow it to work</p>
</details>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split" target="_blank" >
      Learn more about the <code>.split()</code> prototype <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" >
      Learn more about the <code>Destructuring</code> assignments <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >
      Learn more about <code>Arrays</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">// &lt;-- Switch what code we run when:</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span><span class="w">  </span><span class="c1">// &lt;-- The OpenSite action comes in</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span><span class="c1">// &lt;-- The OpenQrCode action comes in</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w">          </span><span class="c1">// &lt;-- The When an Unknown action comes in</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
<details class="question">
<summary>Why not use <code>if</code> statement instead of <code>switch</code></summary>
<p>If statements could work, but as you use more and more if statements, the code becomes a bit harder to read</p>
<p>Using switches, if we wanted to define another action, it would be as simple as adding another case and adding codec below it to define how that case runs</p>
<p>Both do the same job, some implementations are easier on the eyes than others</p>
</details>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch" target="_blank" >
      Learn more about <code>switch...case</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
</div>
</div>
</div>
<ul>
<li>
<p>Once complete, <mark>Save</mark> and Activate the macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>Monitor the Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>Macro</th>
<th>Logs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td><mark>OpenQrCode</mark> https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td><ins class="critic">OpenSite</ins> https://www.webex.com/us/en/workspaces.html</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td><ins class="critic">OpenSite</ins> https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td><mark>OpenQrCode</mark> https://www.webex.com/us/en/workspaces.html</td>
</tr>
</tbody>
</table>
</details>
</details>
<hr />
<hr />
<h3 id="section-333-adding-function-to-our-widgets"><u><strong>Section 3.3.3: Adding function to our Widgets</strong></u></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Now that we can access the data from our widgets as we expect, we can start to implement the function of opening a Web Page on out touch interface</p>
</div>
<details class="lesson" open="open">
<summary>Lesson: Defining our <code>OpenSite</code> function</summary>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We'll be using the WebView Display API</p>
<p>If you're working on a Desk or Board Series Endpoint use the parameter <mark>Target:&#160;</mark><ins class="critic">OSD</ins> in the following lessons</p>
<p>If you're working on a Room Series Endpoint with a Room Navigator attached use the parameter <mark>Target:&#160;</mark><ins class="critic">Controller</ins> in the following lessons</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Room Series with 3rd Party Touch can use <mark>OSD</mark> as a Target value</li>
<li>Room Series with Touch 10 CAN NOT use the <mark>Controller</mark> Target Value<ul>
<li>If you have no touch display or room Navigator, you will need to build a WebView Close Panel</li>
<li>This is not covered in this lab</li>
</ul>
</li>
</ul>
</div>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: xCommand UserInterface WebView Display</p>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Declare a new async function called <mark>openSite</mark> with the following function parameters<ul>
<li>url</li>
<li>target = 'OSD'<ul>
<li>Note: change <mark>OSD</mark> to <mark>Controller</mark> if a Room Navigator touch panel is available</li>
</ul>
</li>
</ul>
</li>
<li>Within this function:<ul>
<li>Structure the xAPI reference above using Macro Syntax with the following parameters and values<ul>
<li>Url: <code>url</code></li>
<li>Target: <code>target</code></li>
</ul>
</li>
<li>Log a Successful response from your xAPI call</li>
<li>Catch and log an error from your xAPI call</li>
</ul>
</li>
<li>Replace <code>console.log(action, url);</code> under the <mark>OpenSite</mark> case within your WidgetActions event with this new <ins class="critic">openSite()</ins> function call and pass in the <code>url</code> object into your function</li>
</ul>
<details class="example">
<summary>View <code>openSite(url, target)</code> function</summary>
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" >
      Learn more about <code>Async Functions</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch" target="_blank" >
      Learn more about <code>try..catch</code> statements <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</details>
<ul>
<li>
<p>Once complete, <mark>Save</mark> and Activate the macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>Monitor the Device OSD and Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>View OSD Output</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Lab 1451</label><label for="__tabbed_6_2">Reimagine Workspaces</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3-3_lab1451_open.png" data-type="image" data-width="100%" data-height="auto" data-title="Lab 1451 WebView" data-desc-position="top"><img alt="Lab 1451 WebView" src="../assets/wx1_1451_part_3/3-3-3_lab1451_open.png" width="600" /></a>
    <figcaption>Lab 1451 WebView</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3-3_reimagineWorkspaces_open.png" data-type="image" data-width="100%" data-height="auto" data-title="Reimagine Workspaces WebView" data-desc-position="top"><img alt="Reimagine Workspaces WebView" src="../assets/wx1_1451_part_3/3-3-3_reimagineWorkspaces_open.png" width="600" /></a>
    <figcaption>Reimagine Workspaces WebView</figcaption>
</figure></p>
</div>
</div>
</div>
</details>
<details class="success">
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//&lt;-- Declare and define your openSite function</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span><span class="w">  </span><span class="c1">//&lt;-- Log a Successful Response</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Catch and log an Error</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>
<span class="w">                        </span><span class="c1">// ↑ url object</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Run the openSite() function and pass in the url object</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span><span class="w"> </span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>Macro</th>
<th>Logs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>OpenQrCode  https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://www.webex.com/us/en/workspaces.html]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>OpenQrCode  https://www.webex.com/us/en/workspaces.html</td>
</tr>
</tbody>
</table>
</details>
</details>
<details class="lesson">
<summary>Lesson: Defining our <code>OpenQrCode</code> function</summary>
<div class="admonition tip">
<p class="admonition-title">Making QR Codes is NOT a normal function of the Codec</p>
<p>In this lesson, in order to generate a QR code for our customization, then we'll need to leverage a 3rd party QR API Service</p>
<p>This is how you can introduce more functionality to your device by leveraging the World of APIs</p>
<div class="admonition important">
<p class="admonition-title">Always Keep Security Top of Mind!</p>
<p>It's easy to fall outside your organization's security policy especially when building new solutions.</p>
<p>Make sure you work with your, or your Customer's, Information Security teams before implementing a new solution that requires Integration Authentication of any kind or reaches out on the internet.</p>
<p>The security implications of a solution can force you building your solution using a different integration method, or even stop a project all together.</p>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://www.cisco.com/c/en/us/td/docs/voice_ip_comm/uc_system/design/guides/wx_security.html" target="_blank" >
      Checkout Webex's <i class="fa-solid fa-shield" style="color: #ff3a65;"></i> Security Technical References <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</div>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: xCommand UserInterface WebView Display</p>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Declare a new async function called <mark>openQrCode</mark> with the following function parameters<ul>
<li>url</li>
<li>target = 'OSD'<ul>
<li>Note: change <mark>OSD</mark> to <mark>Controller</mark> if a Room Navigator touch panel is available</li>
</ul>
</li>
</ul>
</li>
<li>Within this function:<ul>
<li>Use ES6 JS's <code>encodeURI()</code> function to modify the URL in and assign it to a new object called <code>encodedUrl</code><ul>
<li>This is because we'll be wrapping our target URL within a URL from our QR Code Service</li>
</ul>
</li>
<li>Add your <code>encodedUrl</code> object to the data Url Parameter in the URL and assign it to a new object called <code>qrURL</code><ul>
<li><pre><code>https://api.qrserver.com/v1/create-qr-code/?data=<ins class="critic">encodedUrl</ins></code></pre></li>
</ul>
</li>
<li>Structure the xAPI reference above using Macro Syntax with the following parameters and values<ul>
<li>Url: <code>formattedURL</code></li>
<li>Target: <code>target</code></li>
</ul>
</li>
<li>Log a Successful response from your xAPI call</li>
<li>Catch and log an error from your xAPI call</li>
</ul>
</li>
<li>Replace <code>console.warn(action, url);</code> under the <mark>OpenQrCode</mark> case within your WidgetActions event with this new <ins class="critic">openQrCode()</ins> function call and pass in the <code>url</code> object into your function</li>
</ul>
<details class="example">
<summary>View <code>openQrCode(url, target)</code> function</summary>
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//&lt;-- Declare and define your openQrCode function</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span><span class="w">             </span><span class="c1">//&lt;-- Encode the URL that was provided</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">qrURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.qrserver.com/v1/create-qr-code/?data=`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`QR Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">,</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Log a Successful Response</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open QR WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Catch and log an Error</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" >
      Learn more about <code>Async Functions</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch" target="_blank" >
      Learn more about <code>try..catch</code> statements <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</details>
<ul>
<li>
<p>Once complete, <mark>Save</mark> and Activate the macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>Monitor the Device OSD and Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>View OSD Output</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Lab 1451</label><label for="__tabbed_7_2">Reimagine Workspaces</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3-3_lab1451_qr.png" data-type="image" data-width="100%" data-height="auto" data-title="Lab 1451 WebView" data-desc-position="top"><img alt="Lab 1451 WebView" src="../assets/wx1_1451_part_3/3-3-3_lab1451_qr.png" width="600" /></a>
    <figcaption>Lab 1451 WebView</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-3-3_reimagineWorkspaces_qr.png" data-type="image" data-width="100%" data-height="auto" data-title="Reimagine Workspaces WebView" data-desc-position="top"><img alt="Reimagine Workspaces WebView" src="../assets/wx1_1451_part_3/3-3-3_reimagineWorkspaces_qr.png" width="600" /></a>
    <figcaption>Reimagine Workspaces WebView</figcaption>
</figure></p>
</div>
</div>
</div>
</details>
<details class="success">
<summary>Compare your Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">//&lt;-- Declare and define your openQrCode function</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span><span class="w">             </span><span class="c1">//&lt;-- Encode the URL that was provided</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">qrURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.qrserver.com/v1/create-qr-code/?data=`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`QR Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">,</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Log a Successful Response</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open QR WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Catch and log an Error</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>
<span class="w">                        </span><span class="c1">// ↑ url object</span>
<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span><span class="w"> </span><span class="c1">//&lt;-- Run the openQrCode() function and pass in the url object</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>Macro</th>
<th>Logs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">QR Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://www.webex.com/us/en/workspaces.html]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">QR Webview Opened for: [https://www.webex.com/us/en/workspaces.html]</td>
</tr>
</tbody>
</table>
</details>
</details>
<hr />
<hr />
<h2 id="section-34-optimizing-our-solution"><u><strong>Section 3.4: Optimizing our Solution</strong></u></h2>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p><h2>🥳 You made a UI and a Macro 🎉</h2></p>
<p>But we can do a few more things to make this a really rugged solution that enabled simpler deployment and allows us to scale a bit better</p>
<p>And we can do this in several ways</p>
</div>
<h3 id="section-341-imports-exports-and-a-config-object"><u><strong>Section 3.4.1: Imports, Exports and a Config Object</strong></u></h3>
<div class="admonition important">
<p class="admonition-title">Create a new Macro</p>
<ul>
<li>Select <mark>Create new macro</mark> in the Macro Editor</li>
<li>Name this macro <mark>Room Docs Configuration</mark></li>
<li><ins class="critic">Save</ins> and keep the <mark>Room Docs Configuration</mark> Macro <ins class="critic">Inactive</ins></li>
</ul>
<details class="gif">
<summary>Review how to Create and Save a Macro</summary>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4_CreateMacro.gif" data-type="image" data-width="100%" data-height="auto" data-title="Create, Save and Activate a Macro" data-desc-position="top"><img alt="Create, Save and Activate a Macro" src="../assets/wx1_1451_part_3/3-4_CreateMacro.gif" width="600" /></a>
    <figcaption>Create, Save and Activate a Macro</figcaption>
</figure></p>
</details>
</div>
<details class="lesson" open="open">
<summary>Lesson: Establish a Config Object and Export</summary>
<ul>
<li>
<p><strong>xAPI</strong>: N/A</p>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>
<p>Select the <mark>Room Docs Configuration</mark> Macro and perform the next few tasks in this Macro</p>
</li>
<li>
<p>Remove <code>import xapi from 'xapi';</code> from the <mark>Room Docs Configuration</mark> Macro</p>
</li>
<li>
<p>Copy the <code>config</code> object outlined below and paste this into the <mark>Room Docs Configuration</mark> Macro</p>
</li>
</ul>
<div class="highlight"><span class="filename">Copy this `config` Object</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// localOnly, remoteOnly, merge</span>
<span class="w">  </span><span class="nx">remoteSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">localSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Lab 1451&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reimagine Workspaces&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.webex.com/us/en/workspaces.html&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">};</span>
</code></pre></div>
<ul>
<li>Below the <code>config</code> object in the <mark>Room Docs Configuration</mark> Macro add the following</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<ul>
<li>Once complete, <mark>Save</mark>, keep this macro Inactive</li>
</ul>
<details class="success">
<summary>Compare your <code>Room Docs Configuration</code> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// localOnly, remoteOnly, merge</span>
<span class="w">  </span><span class="nx">remoteSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">localSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Lab 1451&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reimagine Workspaces&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
</details>
</li>
</ul>
</details>
<details class="lesson">
<summary>Lesson: Import your Config Object</summary>
<ul>
<li>
<p><strong>xAPI</strong>: N/A</p>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>
<p>Select the <mark>Room Docs</mark> Macro and perform the next few tasks in this Macro</p>
</li>
<li>
<p>Below <code>import xapi from 'xapi';</code> add the following</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Room Docs Configuration&#39;</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>add a new line and add</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Config:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>
<p>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</p>
</li>
<li>
<p>Monitor your log output, you should see our config object print to the console from the <mark>Room Docs Configuration</mark> Macro</p>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your <code>Room Docs</code> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Room Docs Configuration&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// &lt;-- Imports should always be on the top level</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Config:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;-- Log the config object here</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">qrURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.qrserver.com/v1/create-qr-code/?data=`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`QR Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">,</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open QR WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>App</th>
<th>Logs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>Config: {"manifestVisibility":"localOnly","remoteSiteManifest":"","localSiteManifest":[{"Name":"Lab 1451","Url":"","QrEnabled":false},{"Name":"Reimagine Workspaces","Url":"","QrEnabled":true}]}</td>
</tr>
</tbody>
</table>
</details>
</details>
<hr />
<hr />
<h3 id="section-342-automating-the-userinterface"><u><strong>Section 3.4.2: Automating the UserInterface</strong></u></h3>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>Now that we have a config object established, we can iterate over this object and build the UserInterface dynamically. We can use a combination of the Device xAPI and some string manipulation techniques to form a new XML payload which we can load in as soon as the script starts</p>
</div>
<details class="lesson" open="open">
<summary>Lesson: Download our current UserInterface XML</summary>
<div class="admonition example">
<p class="admonition-title">Click on the Tabs Below to learn how to download the UI XML</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:4"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><input id="__tabbed_8_4" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Device Home</label><label for="__tabbed_8_2">UI Extensions Editor</label><label for="__tabbed_8_3">Download Options</label><label for="__tabbed_8_4">Download Operation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>Select the UI Extensions Editor on the Left-Hand Navigation Bar</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_DeviceHome.png" data-type="image" data-width="100%" data-height="auto" data-title="Device Home" data-desc-position="top"><img alt="Device Home" src="../assets/wx1_1451_part_3/3-2_DeviceHome.png" width="600" /></a>
    <figcaption>Device Home Page</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<ul>
<li>The Options to download the UI Extension Panel is in the Extensions ToolBar</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-2_UI_Editor.png" data-type="image" data-width="100%" data-height="auto" data-title="UI Extensions Editor" data-desc-position="top"><img alt="UI Extensions Editor" src="../assets/wx1_1451_part_3/3-2_UI_Editor.png" width="600" /></a>
    <figcaption>UI Extensions Editor</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<ul>
<li>Select the Room Docs Panel</li>
<li>Select the Editor Menu ("Pancake" icon) in the Extensions Toolbar</li>
<li>Select <mark>Export current panel to file</mark></li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4_UI_Download.png" data-type="image" data-width="100%" data-height="auto" data-title="UI Extensions ToolBar Expanded" data-desc-position="top"><img alt="UI Extensions ToolBar Expanded" src="../assets/wx1_1451_part_3/3-4_UI_Download.png" width="600" /></a>
    <figcaption>UI Extensions ToolBar Expanded</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<ul>
<li>UI Extensions Downloads come with the name <mark>roomcontrolconfig&#160;-&#160;0000-00-00T00:00:00.000.xml</mark></li>
<li>The Most Recent Timestamp is the one you just downloaded</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4_UI_Download_Operation.gif" data-type="image" data-width="100%" data-height="auto" data-title="UI Extensions Download Operation" data-desc-position="top"><img alt="UI Extensions Download Operation" src="../assets/wx1_1451_part_3/3-4_UI_Download_Operation.gif" width="600" /></a>
    <figcaption>UI Extensions Download Operation</figcaption>
</figure></p>
</div>
</div>
</div>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: N/A</p>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>
<p>Open the <mark>roomcontrolconfig&#160;-&#160;0000-00-00T00:00:00.000.xml</mark> file</p>
<ul>
<li>Use Notepad for Windows</li>
<li>Use TextEdit for MAC</li>
</ul>
</li>
<li>
<p>Review the contents of your UI Extension's XML</p>
</li>
<li>We'll be taking parts of this XML in the next lesson, and re-structuring it based on our <code>config</code> object</li>
</ul>
</li>
</ul>
</details>
<details class="lesson">
<summary>Lesson: Add a <code>buildUI()</code> function to the <mark>Room Docs</mark> Macro</summary>
<ul>
<li>
<p><strong>xAPI</strong>: xCommand UserInterface Extensions Panel Save</p>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>
<p>Declare a new async function called <mark>buildUI</mark> with no parameters</p>
</li>
<li>
<p>Within this function:</p>
<ul>
<li>Declare a <code>rows</code> object with a value of <code>''</code> (Yes, no value assigned)</li>
<li>Use ES6 JS's <mark>forEach</mark> prototype to loop through the <code>config.localSiteManifest</code> Array
    <div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">site</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Appending [</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">] Site to UI`</span><span class="p">);</span>
<span class="w">  </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;Row&gt;</span>
<span class="sb">                  &lt;Name&gt;</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">&lt;/Name&gt;</span>
<span class="sb">                  &lt;Widget&gt;</span>
<span class="sb">                    &lt;WidgetId&gt;wx1_QrDocs~OpenSite~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                    &lt;Name&gt;Open Site&lt;/Name&gt;</span>
<span class="sb">                    &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                    &lt;Options&gt;size=</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">4</span><span class="si">}</span><span class="sb">&lt;/Options&gt;</span>
<span class="sb">                  &lt;/Widget&gt;</span>
<span class="sb">                  </span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`&lt;Widget&gt;</span>
<span class="sb">                    &lt;WidgetId&gt;wx1_QrDocs~OpenQrCode~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                    &lt;Name&gt;Open QrCode 🔳&lt;/Name&gt;</span>
<span class="sb">                    &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                    &lt;Options&gt;size=2&lt;/Options&gt;</span>
<span class="sb">                  &lt;/Widget&gt;`</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span>
<span class="sb">                &lt;/Row&gt;`</span>
<span class="p">})</span>
</code></pre></div></li>
</ul>
<details class="curious">
<summary>Ok, what's going above???</summary>
<p>It's alot to unpack, I know, but it's just too cool to NOT show you <img alt="🤓" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f913.svg" title=":nerd_face:" /></p>
<p>In the <mark>roomcontrolconfig&#160;-&#160;0000-00-00T00:00:00.000.xml</mark> file we found one of our rows of sites</p>
<p>We took a Row, which is surrounded by <code>&lt;Row&gt;[More Row Content]&lt;/Row&gt;</code> tags that matched out Site information</p>
<p>We then declared a new <code>rows</code> object and looped through it using the <code>forEach()</code> ES6 JS prototype</p>
<p>In this loop, we accessed the properties of each site, that was configured in the <code>config</code> object under the <code>localSiteManifest</code> Array and places the Name and URL into the correct locations within the XML structure. We do this by referencing the <code>config</code> and making use of ES6 JS's Template Literal feature to place the data as well as leveraging ES6 JS's Conditional Operator to check if the QrEnabled value is set to true</p>
<p>Each time the <code>forEach()</code> prototype loops, it takes the <code>rows</code> object and concatenates another row of information and will do so for each site defined in the <code>localSiteManifest</code> Array</p>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" target="_blank" >
      Learn more about the <code>.forEach()</code> prototype <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >
      Learn more about <code>Arrays</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" target="_blank" >
      Learn more about <code>Template Literals</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_operator" target="_blank" >
      Learn more about <code>Conditional Operators</code> <i class="fa-solid fa-square-up-right"></i>
    </a>
    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Addition" target="_blank" >
      Learn more about <code>Concatenation</code> using the <code>+</code> operator <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</details>
<ul>
<li>In your <mark>roomcontrolconfig&#160;-&#160;0000-00-00T00:00:00.000.xml</mark> do the following</li>
</ul>
<div class="admonition example">
<div class="tabbed-set tabbed-alternate" data-tabs="9:4"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><input id="__tabbed_9_4" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Remove Version Tag and Content</label><label for="__tabbed_9_2">Remove PanelId</label><label for="__tabbed_9_3">Replace All Site Rows</label><label for="__tabbed_9_4">View Fully Edited XML</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>This allows the Codec to assign an XML version and avoid conflicts</li>
</ul>
<div class="highlight"><span class="filename">Remove ME</span><pre><span></span><code><span class="nt">&lt;Version&gt;</span>1.11<span class="nt">&lt;/Version&gt;</span><span class="w"> </span>
</code></pre></div>
</div>
<div class="tabbed-block">
<ul>
<li>The PanelId is provided as apart of the Panel Save command, so having a mismatch could be problematic</li>
<li>Removing this tag prevents the chance of a mismatch and allows the Codec to assign the PanelId based on the command execution</li>
</ul>
<div class="highlight"><span class="filename">Remove ME</span><pre><span></span><code><span class="nt">&lt;PanelId&gt;</span>wx1_QrDocs<span class="nt">&lt;/PanelId&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<ul>
<li>replace All site rows with <code>${rows}</code>, which is out object where we instantiated our new row information based on our <code>config</code> object</li>
</ul>
<div class="highlight"><span class="filename">Replace ME with ${rows}</span><pre><span></span><code><span class="nt">&lt;Row&gt;</span>
<span class="w">  </span><span class="nt">&lt;Name&gt;</span>Lab<span class="w"> </span>1451<span class="nt">&lt;/Name&gt;</span>
<span class="w">  </span><span class="nt">&lt;Widget&gt;</span>
<span class="w">    </span><span class="nt">&lt;WidgetId&gt;</span>wx1_QrDocs~OpenSite~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/<span class="nt">&lt;/WidgetId&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Open<span class="w"> </span>Site<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>Button<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Options&gt;</span>size=2<span class="nt">&lt;/Options&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Widget&gt;</span>
<span class="w">  </span><span class="nt">&lt;Widget&gt;</span>
<span class="w">    </span><span class="nt">&lt;WidgetId&gt;</span>wx1_QrDocs~OpenQrCode~https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/<span class="nt">&lt;/WidgetId&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Open<span class="w"> </span>QrCode<span class="w"> </span>🔳<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>Button<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Options&gt;</span>size=2<span class="nt">&lt;/Options&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Widget&gt;</span>
<span class="nt">&lt;/Row&gt;</span>
<span class="nt">&lt;Row&gt;</span>
<span class="w">  </span><span class="nt">&lt;Name&gt;</span>Reimagine<span class="w"> </span>Workspaces<span class="nt">&lt;/Name&gt;</span>
<span class="w">  </span><span class="nt">&lt;Widget&gt;</span>
<span class="w">    </span><span class="nt">&lt;WidgetId&gt;</span>wx1_QrDocs~OpenSite~https://www.webex.com/us/en/workspaces.html<span class="nt">&lt;/WidgetId&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Open<span class="w"> </span>Site<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>Button<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Options&gt;</span>size=2<span class="nt">&lt;/Options&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Widget&gt;</span>
<span class="w">  </span><span class="nt">&lt;Widget&gt;</span>
<span class="w">    </span><span class="nt">&lt;WidgetId&gt;</span>wx1_QrDocs~OpenQrCode~https://www.webex.com/us/en/workspaces.html<span class="nt">&lt;/WidgetId&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Open<span class="w"> </span>QrCode<span class="w"> </span>🔳<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;Type&gt;</span>Button<span class="nt">&lt;/Type&gt;</span>
<span class="w">    </span><span class="nt">&lt;Options&gt;</span>size=2<span class="nt">&lt;/Options&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Widget&gt;</span>
<span class="nt">&lt;/Row&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">Should look something like...</span><pre><span></span><code><span class="nt">&lt;Extensions&gt;</span>
<span class="w">  </span><span class="nt">&lt;Panel&gt;</span>
<span class="w">    </span><span class="nt">&lt;Order&gt;</span>1<span class="nt">&lt;/Order&gt;</span>
<span class="w">    </span><span class="nt">&lt;Origin&gt;</span>local<span class="nt">&lt;/Origin&gt;</span>
<span class="w">    </span><span class="nt">&lt;Location&gt;</span>HomeScreenAndCallControls<span class="nt">&lt;/Location&gt;</span>
<span class="w">    </span><span class="nt">&lt;Icon&gt;</span>Language<span class="nt">&lt;/Icon&gt;</span>
<span class="w">    </span><span class="nt">&lt;Color&gt;</span>#875AE0<span class="nt">&lt;/Color&gt;</span>
<span class="w">    </span><span class="nt">&lt;Name&gt;</span>Room<span class="w"> </span>Docs<span class="nt">&lt;/Name&gt;</span>
<span class="w">    </span><span class="nt">&lt;ActivityType&gt;</span>Custom<span class="nt">&lt;/ActivityType&gt;</span>
<span class="w">    </span><span class="nt">&lt;Page&gt;</span>
<span class="w">      </span><span class="nt">&lt;Name&gt;</span>Room<span class="w"> </span>Docs<span class="nt">&lt;/Name&gt;</span>
<span class="w">      </span>${rows}
<span class="w">      </span><span class="nt">&lt;PageId&gt;</span>wx1_QrDocs~RoomDocs<span class="nt">&lt;/PageId&gt;</span>
<span class="w">      </span><span class="nt">&lt;Options/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Page&gt;</span>
<span class="w">  </span><span class="nt">&lt;/Panel&gt;</span>
<span class="nt">&lt;/Extensions&gt;</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<ul>
<li>
<p>Declare a new object called <code>xml</code> and assign it the value of your edited xml</p>
</li>
<li>
<p>Structure the xAPI reference above using Macro Syntax with the following parameters and values</p>
<ul>
<li>PanelId: wx1_QrDocs</li>
<li>body: <code>xml</code></li>
</ul>
</li>
<li>
<p>Place this xAPI call in a <code>try...catch</code> block and handle it's response and error appropriately</p>
</li>
<li>
<p>Then run this function after it has been defined</p>
</li>
<li>
<p>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<details class="success">
<summary>View <code>buildUI()</code> function</summary>
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">buildUI</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">site</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Appending [</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">] Site to UI`</span><span class="p">);</span>
<span class="w">    </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;Row&gt;</span>
<span class="sb">                    &lt;Name&gt;</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">&lt;/Name&gt;</span>
<span class="sb">                    &lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenSite~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open Site&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">4</span><span class="si">}</span><span class="sb">&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`&lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenQrCode~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open QrCode 🔳&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=2&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;`</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span>
<span class="sb">                  &lt;/Row&gt;`</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">                &lt;Panel&gt;</span>
<span class="sb">                  &lt;Order&gt;1&lt;/Order&gt;</span>
<span class="sb">                  &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">                  &lt;Location&gt;HomeScreenAndCallControls&lt;/Location&gt;</span>
<span class="sb">                  &lt;Icon&gt;Language&lt;/Icon&gt;</span>
<span class="sb">                  &lt;Color&gt;#875AE0&lt;/Color&gt;</span>
<span class="sb">                  &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                  &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">                  &lt;Page&gt;</span>
<span class="sb">                    &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">rows</span><span class="si">}</span>
<span class="sb">                    &lt;PageId&gt;wx1_QrDocs~RoomDocs&lt;/PageId&gt;</span>
<span class="sb">                    &lt;Options/&gt;</span>
<span class="sb">                  &lt;/Page&gt;</span>
<span class="sb">                &lt;/Panel&gt;</span>
<span class="sb">              &lt;/Extensions&gt;`</span><span class="p">;</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;wx1_QrDocs&#39;</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="nx">xml</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;UserInterface Built!&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">build</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to Build UserInterface`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your <code>Room Docs</code> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Room Docs Configuration&#39;</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Config:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">);</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">qrURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.qrserver.com/v1/create-qr-code/?data=`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`QR Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">,</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open QR WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">buildUI</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Declare and Define your buildUI() function</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">// &lt;-- declare your rows object</span>

<span class="w">  </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">site</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- use forEach() to loop through the localSiteManifest Array</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Appending [</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">] Site to UI`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Re-assign the value of rows with the current value of rows, plus the XML for a new row</span>
<span class="w">    </span><span class="c1">//  passing in the data for each item listed in the localSiteManifest Array</span>
<span class="w">    </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;Row&gt; </span>
<span class="sb">                    &lt;Name&gt;</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">&lt;/Name&gt;</span>
<span class="sb">                    &lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenSite~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open Site&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">4</span><span class="si">}</span><span class="sb">&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`&lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenQrCode~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open QrCode 🔳&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=2&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;`</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span>
<span class="sb">                  &lt;/Row&gt;`</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// Declare and assign the rest of the XML for your panel, and pass in the rows data</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">                &lt;Panel&gt;</span>
<span class="sb">                  &lt;Order&gt;1&lt;/Order&gt;</span>
<span class="sb">                  &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">                  &lt;Location&gt;HomeScreenAndCallControls&lt;/Location&gt;</span>
<span class="sb">                  &lt;Icon&gt;Language&lt;/Icon&gt;</span>
<span class="sb">                  &lt;Color&gt;#875AE0&lt;/Color&gt;</span>
<span class="sb">                  &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                  &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">                  &lt;Page&gt;</span>
<span class="sb">                    &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">rows</span><span class="w"> </span><span class="cm">/* Contains all the rows from the forEach() loop*/</span><span class="si">}</span>
<span class="sb">                    &lt;PageId&gt;wx1_QrDocs~RoomDocs&lt;/PageId&gt;</span>
<span class="sb">                    &lt;Options/&gt;</span>
<span class="sb">                  &lt;/Page&gt;</span>
<span class="sb">                &lt;/Panel&gt;</span>
<span class="sb">              &lt;/Extensions&gt;`</span><span class="p">;</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span><span class="w"> </span><span class="c1">// structure xCommand UserInterface Extensions Panel Save</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;wx1_QrDocs&#39;</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="nx">xml</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;UserInterface Built!&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">build</span><span class="p">);</span><span class="w"> </span><span class="c1">// Log it&#39;s repsonse</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to Build UserInterface`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"> </span><span class="c1">// Catch and log it&#39;s error</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="nx">buildUI</span><span class="p">();</span><span class="w">  </span><span class="c1">//&lt;-- Run the buildUI() function</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>App</th>
<th>Logs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>Config: {"manifestVisibility":"localOnly","remoteSiteManifest":"","localSiteManifest":[{"Name":"Lab 1451","Url":"https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/","QrEnabled":true},{"Name":"Reimagine Workspaces","Url":"https://www.webex.com/us/en/workspaces.html","QrEnabled":true},{"Name":"Cisco","Url":"https://www.cisco.com","QrEnabled":true}]}</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>Appending [Lab 1451] Site to UI</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>Appending [Reimagine Workspaces] Site to UI</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>Appending [Cisco] Site to UI</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">UserInterface Built!</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QR Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/] {"status":"OK"} https://api.qrserver.com/v1/create-qr-code/?data=https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://www.webex.com/us/en/workspaces.html]</td>
</tr>
<tr>
<td>HH:MM:SS</td>
<td>Room Docs</td>
<td>QR Webview Opened for: [https://www.webex.com/us/en/workspaces.html] {"status":"OK"} https://api.qrserver.com/v1/create-qr-code/?data=https://www.webex.com/us/en/workspaces.html</td>
</tr>
</tbody>
</table>
</details>
</details>
<details class="lesson">
<summary>Lesson: Add a new Site to the Config</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To check our work, let's expand our <code>localSiteManifest</code> to include 2 new sites</p>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: N/A</p>
</li>
<li>
<p><strong>Task</strong>: </p>
<ul>
<li>Select the <mark>Room Docs Configuration</mark> Macro and perform the next few tasks in this Macro</li>
<li>
<p>Under the <code>localSiteManifest</code> Array add the following 2 sites and additional Properties following the same JSON format as the other sites</p>
<ul>
<li>Site 1<ul>
<li>Name: Cisco</li>
<li>Url: https://www.cisco.com</li>
<li>QrEnabled: false</li>
</ul>
</li>
<li>Set 2 [Add Your Organizations Home Page]<ul>
<li>Name: Your Org Name</li>
<li>Url: Your Org Site</li>
<li>QrEnabled: true</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>Monitor the Device OSD and Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your <code>Room Docs</code> Panel UI</summary>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4-3_Local_PanelUI.png" data-type="image" data-width="100%" data-height="auto" data-title="Local Panel UI" data-desc-position="top"><img alt="Local Panel UI" src="../assets/wx1_1451_part_3/3-4-3_Local_PanelUI.png" width="600" /></a>
    <figcaption>Local Panel UI</figcaption>
</figure></p>
</details>
<details class="success">
<summary>Compare your <mark>Room Docs Configuration</mark> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// localOnly, remoteOnly, merge</span>
<span class="w">  </span><span class="nx">remoteSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://raw.githubusercontent.com/WebexCC-SA/LAB-1451/refs/heads/main/docs/assets/downloadable_resources/3-4-3_remoteManifest.json&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">localSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Lab 1451&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reimagine Workspaces&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.webex.com/us/en/workspaces.html&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Cisco&#39;</span><span class="p">,</span><span class="w">                </span><span class="c1">// &lt;-- Cisco Homepage Added</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.cisco.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="c1">// Your Org Details Below Here</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
</details>
</details>
<h3 id="section-343-centralize-your-doc-urls"><u><strong>Section 3.4.3: Centralize your Doc URLs</strong></u></h3>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p>Now that we have an interface that can build itself with small changes to a config file, let's make this a bit easier for ourselves to manage</p>
<p>We can leverage the Codec's HTTPClient xAPIs to reach out to a single endpoint that's hosting all of our document references and pull it down into the Codec before running the buildUI() function</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This lab is hosting a file called <code>3-4-3_remoteManifest.json</code> on GitHub which contains 6 additional sites pre-configured in the same format as the local sites configured on the endpoint</p>
<p><a class="md-button md-button--primary" href="https://github.com/WebexCC-SA/LAB-1451/blob/main/docs/assets/downloadable_resources/3-4-3_remoteManifest.json" target="_blank" >
  Review the Remote Manifest File <i class="fa-solid fa-square-up-right"></i>
</a></p>
</div>
</div>
<details class="lesson" open="open">
<summary>Lesson: Add a Remote Site URL to your <code>config</code> object</summary>
<ul>
<li>
<p>xAPI: N/A</p>
</li>
<li>
<p>Task:</p>
<ul>
<li>Select the <mark>Room Docs Configuration</mark> macro</li>
<li>Edit the <code>remoteSiteManifest</code> object and assign the following url as a string<ul>
<li>https://raw.githubusercontent.com/WebexCC-SA/LAB-1451/refs/heads/main/docs/assets/downloadable_resources/3-4-3_remoteManifest.json</li>
</ul>
</li>
<li>Once complete, <mark>Save</mark>, keep this macro Inactive</li>
</ul>
</li>
</ul>
<details>
<summary>Compare your <mark>Room Docs Configuration</mark> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// localOnly, remoteOnly, merge</span>
<span class="w">  </span><span class="nx">remoteSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://raw.githubusercontent.com/WebexCC-SA/LAB-1451/refs/heads/main/docs/assets/downloadable_resources/3-4-3_remoteManifest.json&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">localSiteManifest</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Lab 1451&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Reimagine Workspaces&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.webex.com/us/en/workspaces.html&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Cisco&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;https://www.cisco.com&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrEnabled</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="lesson">
<summary>Lesson: Declare a <code>getRemoteSiteManifest()</code> function</summary>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, we're we'll be making an HTTP Get call using the HTTPClient xAPI stack to reach our pull information from a site external to the codec</p>
<details class="important">
<summary>Always Keep Security Top of Mind!</summary>
<p>It's easy to fall outside your organization's security policy especially when building new solutions.</p>
<p>Make sure you work with your, or your Customer's, Information Security teams before implementing a new solution that requires Integration Authentication of any kind or reaches out on the internet.</p>
<p>The security implications of a solution can force you building your solution using a different integration method, or even stop a project all together.</p>
<p><div style="display: flex; gap: 10px;">
    <a class="md-button md-button--primary" href="https://www.cisco.com/c/en/us/td/docs/voice_ip_comm/uc_system/design/guides/wx_security.html" target="_blank" >
      Checkout Webex's <i class="fa-solid fa-shield" style="color: #ff3a65;"></i> Security Technical References <i class="fa-solid fa-square-up-right"></i>
    </a>
</div></p>
</details>
</div>
<ul>
<li>
<p><strong>xAPI</strong>: xCommand HTTPClient Get</p>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>
<p>Select the <mark>Room Docs</mark> macro</p>
</li>
<li>
<p>Declare a new async function called <mark>getRemoteSiteManifest</mark> with no parameters</p>
</li>
<li>
<p>Within this function:</p>
<ul>
<li>Declare a <code>request</code> object with a value of <code>''</code> (Yes, no value assigned)</li>
<li>Declare a <code>remoteData</code> object with a value of <code>[]</code> (Yes, no value assigned)            </li>
<li>Within a <code>try...catch</code> block, structure the xAPI path above in Macro Syntax with the following parameters and assign this to the <code>request</code> object</li>
<li>Use the <mark>JSON.parse()</mark> method on the <code>request.Body</code> (the response captured in the <code>request</code> object) and assign this to the <code>remoteData</code> object<ul>
<li><mark>JSON.parse()</mark> allows us to later handler the data from the external site as if it were a JSON object, not a string</li>
</ul>
</li>
<li>Use console.debug to log the <code>remoteData</code> object</li>
<li>Return the <code>remoteData</code> object</li>
<li>Catch and log any errors</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Click the Tabs below to see each step outlined above</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:4"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><input id="__tabbed_10_4" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Declare Function and Objects</label><label for="__tabbed_10_2">Assign Request with xAPI</label><label for="__tabbed_10_3">Parse Response and Return</label><label for="__tabbed_10_4">Catch and Log Errors (Full Func)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// &lt;-- Declare request object</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span><span class="c1">// &lt;-- Declare remoteData object</span>

<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Setup try...catch block</span>
<span class="w">    </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">HttpClient</span><span class="p">.</span><span class="nx">Get</span><span class="p">({</span><span class="w"> </span><span class="c1">// &lt;-- Assign xCommand HTTPClient Get</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="c1">// &lt;-- Assign remoteManifest URL from the config</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">HttpClient</span><span class="p">.</span><span class="nx">Get</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">Body</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;-- Use JSON.parse to process the request.Body</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="sb">`Remote Site Manifest Found`</span><span class="p">,</span><span class="w"> </span><span class="nx">remoteData</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;-- log the response to the debug console</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="c1">// &lt;-- return the remote site data</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">HttpClient</span><span class="p">.</span><span class="nx">Get</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">Body</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="sb">`Remote Site Manifest Found`</span><span class="p">,</span><span class="w"> </span><span class="nx">remoteData</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">remoteData</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Handle the possible Error</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to Get remote site manifest&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// &lt;-- Leave yourself clues to troubleshoot</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;-- Log the error</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<ul>
<li>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</li>
</ul>
</li>
</ul>
</li>
</ul>
</details>
<details class="lesson">
<summary>Lesson: Integrate the <code>getRemoteSiteManifest()</code> function into the <code>buildUI()</code> function</summary>
<ul>
<li>
<p><strong>xAPI(s)</strong>:</p>
<ul>
<li>xCommand HTTPClient Get</li>
<li>xCommand UserInterface Extensions Panel Save</li>
</ul>
</li>
<li>
<p><strong>Task</strong>:</p>
<ul>
<li>Select the <mark>Room Docs</mark> macro</li>
<li>
<ul>
<li>Below the <code>let rows</code> declaration and above the <code>config.localSiteManifest.forEach(...)</code> loop, start a <code>switch</code> statement</li>
<li>We'll switch based on the <code>config</code> object's <mark>manifestVisibility</mark> value. This can be 1 of 3 values and should apply the following behaviors<ul>
<li>localOnly: The UI will only build sites that are found locally in the Codec's <mark>Room Docs Configuration</mark> macro</li>
<li>remoteOnly: The UI will only build sites that are configured in our <mark>remoteSiteManifest</mark> Url</li>
<li>merge: The UI will combine local and remote sites into the UI</li>
<li>if the <mark>remoteSiteManifest</mark> Url is missing, you should ignore these values</li>
</ul>
</li>
</ul>
<p>Edit the <code>buildUI()</code> function</p>
<div class="admonition blank">
<p class="admonition-title">Copy the Switch Statement below into your buildUI() function</p>
<div class="highlight"><pre><span></span><code><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">manifestVisibility</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;remoteOnly&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Check to see if the ==remoteSiteManifest== Url is configured</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">();</span><span class="w"> </span><span class="c1">// &lt;-- overwrite configured localSiteManifest with the remoteSiteManifest</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// &lt;-- Check to see if the ==remoteSiteManifest== Url is configured</span>
<span class="w">      </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="k">await</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()]</span><span class="w"> </span><span class="c1">// &lt;-- overwrite configured localSiteManifest with a new Array, using both the current localSiteManifest and the remoteSiteManifest</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;localOnly&#39;</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// No Action Required</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">default</span><span class="o">:</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`Unknown manifestVisibility assignment: [</span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">manifestVisibility</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span><span class="w"> </span><span class="c1">// &lt;-- Log unknown manifestVisibility values to the console</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</li>
<li>
<p>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</p>
</li>
<li>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</li>
<li>Monitor the Macro Console Output</li>
</ul>
</li>
</ul>
<details class="success">
<summary>Compare your <code>Room Docs</code> Panel UI</summary>
<ul>
<li>Remote Sites are marked with a <code>🔗</code> emoji for clarity</li>
</ul>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4-3_Local_Remote_PanelUI.png" data-type="image" data-width="100%" data-height="auto" data-title="Remote and Local Panel UI" data-desc-position="top"><img alt="Remote and Local Panel UI" src="../assets/wx1_1451_part_3/3-4-3_Local_Remote_PanelUI.png" width="600" /></a>
    <figcaption>Remote and Local Panel UI</figcaption>
</figure></p>
</details>
<details class="success">
<summary>Compare your <code>Room Docs</code> Macro</summary>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nx">xapi</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;xapi&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./Room Docs Configuration&#39;</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Config:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">);</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Site Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open Site WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;OSD&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">qrURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.qrserver.com/v1/create-qr-code/?data=`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">encodedUrl</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">openPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">WebView</span><span class="p">.</span><span class="nx">Display</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="nx">Target</span><span class="o">:</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`QR Webview Opened for: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span><span class="w"> </span><span class="nx">openPage</span><span class="p">,</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to open QR WebView to: [</span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">]`</span><span class="p">,</span>
<span class="w">      </span><span class="nx">QrUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">qrURL</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">HttpClient</span><span class="p">.</span><span class="nx">Get</span><span class="p">({</span>
<span class="w">      </span><span class="nx">Url</span><span class="o">:</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">remoteData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">Body</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="sb">`Remote Site Manifest Found`</span><span class="p">,</span><span class="w"> </span><span class="nx">remoteData</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">remoteData</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to Get remote site manifest&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">buildUI</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">manifestVisibility</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;remoteOnly&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">remoteSiteManifest</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="k">await</span><span class="w"> </span><span class="nx">getRemoteSiteManifest</span><span class="p">()]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;localOnly&#39;</span><span class="o">:</span>
<span class="w">      </span><span class="c1">// No Action Required</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`Unknown manifestVisibility assignment: [</span><span class="si">${</span><span class="nx">config</span><span class="p">.</span><span class="nx">manifestVisibility</span><span class="si">}</span><span class="sb">]`</span><span class="p">)</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">config</span><span class="p">.</span><span class="nx">localSiteManifest</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">site</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Appending [</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">] Site to UI`</span><span class="p">);</span>

<span class="w">    </span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rows</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sb">`&lt;Row&gt; </span>
<span class="sb">                    &lt;Name&gt;</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Name</span><span class="si">}</span><span class="sb">&lt;/Name&gt;</span>
<span class="sb">                    &lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenSite~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open Site&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">4</span><span class="si">}</span><span class="sb">&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">QrEnabled</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`&lt;Widget&gt;</span>
<span class="sb">                      &lt;WidgetId&gt;wx1_QrDocs~OpenQrCode~</span><span class="si">${</span><span class="nx">site</span><span class="p">.</span><span class="nx">Url</span><span class="si">}</span><span class="sb">&lt;/WidgetId&gt;</span>
<span class="sb">                      &lt;Name&gt;Open QrCode 🔳&lt;/Name&gt;</span>
<span class="sb">                      &lt;Type&gt;Button&lt;/Type&gt;</span>
<span class="sb">                      &lt;Options&gt;size=2&lt;/Options&gt;</span>
<span class="sb">                    &lt;/Widget&gt;`</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span>
<span class="sb">                  &lt;/Row&gt;`</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">xml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`&lt;Extensions&gt;</span>
<span class="sb">                &lt;Panel&gt;</span>
<span class="sb">                  &lt;Order&gt;1&lt;/Order&gt;</span>
<span class="sb">                  &lt;Origin&gt;local&lt;/Origin&gt;</span>
<span class="sb">                  &lt;Location&gt;HomeScreenAndCallControls&lt;/Location&gt;</span>
<span class="sb">                  &lt;Icon&gt;Language&lt;/Icon&gt;</span>
<span class="sb">                  &lt;Color&gt;#875AE0&lt;/Color&gt;</span>
<span class="sb">                  &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                  &lt;ActivityType&gt;Custom&lt;/ActivityType&gt;</span>
<span class="sb">                  &lt;Page&gt;</span>
<span class="sb">                    &lt;Name&gt;Room Docs&lt;/Name&gt;</span>
<span class="sb">                    </span><span class="si">${</span><span class="nx">rows</span><span class="si">}</span>
<span class="sb">                    &lt;PageId&gt;wx1_QrDocs~RoomDocs&lt;/PageId&gt;</span>
<span class="sb">                    &lt;Options/&gt;</span>
<span class="sb">                  &lt;/Page&gt;</span>
<span class="sb">                &lt;/Panel&gt;</span>
<span class="sb">              &lt;/Extensions&gt;`</span><span class="p">;</span>

<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">xapi</span><span class="p">.</span><span class="nx">Command</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Panel</span><span class="p">.</span><span class="nx">Save</span><span class="p">({</span>
<span class="w">      </span><span class="nx">PanelId</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;wx1_QrDocs&#39;</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="nx">xml</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;UserInterface Built!&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">build</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">Context</span><span class="o">:</span><span class="w"> </span><span class="sb">`Failed to Build UserInterface`</span><span class="p">,</span>
<span class="w">      </span><span class="p">...</span><span class="nx">e</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>

<span class="nx">buildUI</span><span class="p">();</span>

<span class="nx">xapi</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">UserInterface</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">Action</span><span class="p">.</span><span class="nx">on</span><span class="p">(({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">({</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">,</span><span class="w"> </span><span class="nx">Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Value</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="sb">`wx1_QrDocs`</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;released&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WidgetId</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sb">`~`</span><span class="p">);</span>

<span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenSite&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openSite</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OpenQrCode&#39;</span><span class="o">:</span>
<span class="w">          </span><span class="nx">openQrCode</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`Unknown Action Fired: [</span><span class="si">${</span><span class="nx">action</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">});</span>
</code></pre></div>
</details>
<details class="success">
<summary>Compare your Macro Console</summary>
<table>
<thead>
<tr>
<th>Time</th>
<th>Macro</th>
<th>Log</th>
</tr>
</thead>
<tbody>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>QJS Ready</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Config: {"manifestVisibility":"merge","remoteSiteManifest":"https://raw.githubusercontent.com/WebexCC-SA/LAB-1451/refs/heads/main/docs/assets/downloadable_resources/3-4-3_remoteManifest.json","localSiteManifest":[{"Name":"Lab 1451","Url":"https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/","QrEnabled":true},{"Name":"Reimagine Workspaces","Url":"https://www.webex.com/us/en/workspaces.html","QrEnabled":true},{"Name":"Cisco","Url":"https://www.cisco.com","QrEnabled":true}]}</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Lab 1451] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Reimagine Workspaces] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Cisco] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Room Kit EQX 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [WebexOne 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [RoomOS xAPI References 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Crossview Room Pre Guidelines 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Using Extra LoudSpeakers 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td>Appending [Webex AI Codec 🔗] Site to UI</td>
</tr>
<tr>
<td>23:50:16</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">UserInterface Built!</td>
</tr>
<tr>
<td>23:50:31</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_3/]</td>
</tr>
<tr>
<td>23:50:50</td>
<td>Room Docs</td>
<td>QR Webview Opened for: [https://www.cisco.com] {"status":"OK"} https://api.qrserver.com/v1/create-qr-code/?data=https://www.cisco.com</td>
</tr>
<tr>
<td>23:50:54</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://roomos.cisco.com/xapi]</td>
</tr>
<tr>
<td>23:51:02</td>
<td>Room Docs</td>
<td>QR Webview Opened for: [https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/ce97/extra-loudspeakers-local-reinforcement-guide-ce97.pdf] {"status":"OK"} https://api.qrserver.com/v1/create-qr-code/?data=https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/ce97/extra-loudspeakers-local-reinforcement-guide-ce97.pdf</td>
</tr>
<tr>
<td>23:51:04</td>
<td>Room Docs</td>
<td _status_:_OK_="&quot;status&quot;:&quot;OK&quot;">Site Webview Opened for: [https://blog.webex.com/collaboration/hybrid-work/next-level-audio-with-webex-ai-codec/]</td>
</tr>
</tbody>
</table>
</details>
</details>
<details class="lesson">
<summary>Lesson: Adjust the <code>manifestVisibility</code> value in the <code>config</code> object</summary>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Last, but certainly not least, is a demonstration that shows what the <code>manifestVisibility</code> value can affect when changed</p>
</div>
<ul>
<li>
<p>xAPI: N/A</p>
</li>
<li>
<p>Task:</p>
<ul>
<li>Select the <mark>Room Docs Configuration</mark> macro</li>
<li>
<p>Change the value of <code>manifestVisibility</code> to 1 of the 3 values below</p>
<ul>
<li>localOnly</li>
<li>remoteOnly</li>
<li>merge</li>
</ul>
</li>
<li>
<p>Once complete, <mark>Save</mark> and Activate the <mark>Room Docs</mark> Macro (if inactive)</p>
</li>
<li>
<p>Start pressing the <mark>Open Site</mark> and <mark>Open QrCode 🔳</mark> buttons contained within your <code>Room Docs</code> panel</p>
</li>
<li>
<p>Repeat for each <code>manifestVisibility</code> Value</p>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Click the tabs below to see the differences of each <code>manifestVisibility</code> Value</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">localOnly</label><label for="__tabbed_11_2">remoteOnly</label><label for="__tabbed_11_3">merge</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><span class="filename">Syntax</span><pre><span></span><code><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;localOnly&#39;</span><span class="p">,</span>
</code></pre></div>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4-3_Local_PanelUI.png" data-type="image" data-width="100%" data-height="auto" data-title="Local Panel UI" data-desc-position="top"><img alt="Local Panel UI" src="../assets/wx1_1451_part_3/3-4-3_Local_PanelUI.png" width="600" /></a>
    <figcaption>Local Panel UI</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">Syntax</span><pre><span></span><code><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;remoteOnly&#39;</span><span class="p">,</span>
</code></pre></div>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4-3_Remote_PanelUI.png" data-type="image" data-width="100%" data-height="auto" data-title="Remote Panel UI" data-desc-position="top"><img alt="Remote Panel UI" src="../assets/wx1_1451_part_3/3-4-3_Remote_PanelUI.png" width="600" /></a>
    <figcaption>Remote Panel UI</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<div class="highlight"><span class="filename">Syntax</span><pre><span></span><code><span class="nx">manifestVisibility</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;merge&#39;</span><span class="p">,</span>
</code></pre></div>
<p><figure markdown="span">
    <a class="glightbox" href="../assets/wx1_1451_part_3/3-4-3_Local_Remote_PanelUI.png" data-type="image" data-width="100%" data-height="auto" data-title="Remote and Local Panel UI" data-desc-position="top"><img alt="Remote and Local Panel UI" src="../assets/wx1_1451_part_3/3-4-3_Local_Remote_PanelUI.png" width="600" /></a>
    <figcaption>Remote and Local Panel UI</figcaption>
</figure></p>
</div>
</div>
</div>
</div>
</li>
</ul>
</details>
<hr />
<div class="admonition tip">
<p class="admonition-title">Congratulations!</p>
<p>You just made a UI Extension and a Macro add in some new function.</p>
<p>This is only the beginning, there is a world of solutions waiting to be solved. Even this solution has so much potential for more</p>
<p>Now, Dive into Deployment in Part 4!</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../AV_xAPI/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab&amp;colon; Utilizing AV Specific APIs">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab&colon; Utilizing AV Specific APIs
              </div>
            </div>
          </a>
        
        
          
          <a href="../CodectoCodec/" class="md-footer__link md-footer__link--next" aria-label="Next: Lab&amp;colon; Implement Codec to Codec Communication">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Lab&colon; Implement Codec to Codec Communication
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Cisco
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.instant", "navigation.top", "navigation.footer", "search.suggest", "content.code.copy", "toc.integrate", "content.tooltips", "content.footnote.tooltips"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "fade", "closeEffect": "fade", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>