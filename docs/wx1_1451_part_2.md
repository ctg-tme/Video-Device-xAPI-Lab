!!! important "Abstract"

    Accessing Device xAPI will run through many examples on how you can interface with your Codec's xAPI through the following integration methods

    - - -

    | **Integration Method** | **Port** | **Common Field Uses**                                                                                                                      |
    |------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------|
    | SSH                    | 22       | AV Room Controllers [Room Automation]                                                                                                      |
    | HTTP                   | 80/443   | AV Room Controllers [Room Automation], Telepresence Management Suite (TMS[EoL]), 3rd Party Management Systems and/or Analytics             |
    | WebHooks               | 80/443   | Telepresence Management Suite (TMS[EoL]), 3rd Party Management Systems and/or Analytics                                                    |
    | WebSockets             | 80/443   | AV Room Controllers [Room Automation], Web Applications, Webex Control Hub, 3rd Party Management Systems and/or AnalyticsWeb Applications, |
    | Cloud xAPI             | 80/443   | Web Applications,  Webex Control Hub, 3rd Party Management Systems and/or Analytics                                                        |
    | Macros                 | Local    | Room Automation                                                                                                                            |

    Some topics that aren't covered in this lab are the following Integration Methods

    | **Integration Method**     | **Common Field Uses**                                                                                                  | Closest Integration Method and Differences                                                                                                                                                                                                                                   |
    |----------------------------|------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | Serial Rs232               | AV Room Controllers [Room Automation], Non-Networked AV solutions                                                      | SSH - Serial Rs232 interacts with the terminal in the same way as SSH, but requires additional configurations on the Codec and String Terminators to complete the instruction set                                                                                |
    | jsxapi [Javascript Module] | AV Room Controllers [Room Automation], Web Applications, 3rd Party Management Systems and/or AnalyticsWeb Applications | Macros - Macros are a derivative of the jsxapi. Syntax is largely the same, except the added steps to establish an SSH or WebScoket Connection. Following the SSH, WebSocket and Macro Lessons will teach you format and communication that the jsxapi relies on |
    | Workspace Integrations     | Web Applications,  Webex Control Hub, 3rd Party Management Systems and/or Analytics                                    | Cloud xAPI - WorkSpace integrations functions as the Subscription mechanism for Cloud xAPI. There isn't a close example in this lab, but it a worthwhile topic on it's own to explore for solutions that scale in a cloud environment                            |

    - - -

    !!! Note

        Each Section has a `Cleanup` Process. These are important when moving from each integration method

        It requires you to have an active SSH session against the endpoint, so once you're done with section 2.2, keep that terminal session alive

    Every integration method serves a purpose, whether your a customer optimizing their workflow, an integrator wanting a deeper understanding on how all these pieces connect or a partner wanting to building new opportunity for your business with Cisco Video Devices

## <u>**Section 2.1: Docs and Setup Subscription Assistant Macro**</u>


### **Section 2.1.1: xAPI Documentation**

Below contain links to various xAPI Guides. Click to expand each section.

??? Webex "Official xAPI Guides"

    xAPI Documentation can be found in several locations.

    The Official API Reference Guide can be found <a target="blank" href="https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/roomos-1114/api-reference-guide-roomos-1114.pdf"> here</a>

    - The Official API Doc release with every new On Premise release of RoomOS
    - This guide contains the most accurate information our API as well as a detailed information of our integration protocols

    <figure markdown>
      ![Official API Doc](./assets/wx1_1451_part_2/2-1_OfficialAPI_Home.png){ width="400" }
    </figure>

???+ webex "RoomOS Site xAPI Guides (Preferred)"

    The <a target="blank" href="https://roomos.cisco.com/xapi"> RoomOS Site</a> contains the same information as the official PDF Doc, but contains the most recent Cloud API Releases

    - This site comes outfitted with a search engine and examples on how to execute the API
    - It will include all cloud versions of the API and will update automatically on a new cloud release
    - Though not the Official Guide, it's the preferred starting point for Development for it's additional content, code examples, tools and simplicity
    - The RoomOS site is the resource we'll use for the remainder of this lab

    <figure markdown>
      ![RoomOS Site xAPI Reference](./assets/wx1_1451_part_2/2-1_RoomOS_xAPI-References.png){ width="400" }
    </figure>

??? Webex "Webex for Developer Site"

    The <a target="blank" href="https://developer.webex.com/docs/api/v1/xapi"> Webex for Developers</a> portal provides context on how to execute xAPI calls via the cloud

    - This site does not contain a list of xAPI references, but does contain information on how to execute cloud xAPIs against your Cloud or Webex Edge registered endpoints as well as information about the scopes required for use
    - This developer site will allow you to test cloud API directly from the site to help enable development with Devices and the rest of the Webex Portfolio


    <figure markdown>
      ![Webex Developer Home](./assets/wx1_1451_part_2/2-1_Webex-Developer_Home.png){ width="400" }
    </figure>

<a class="md-button md-button--primary" href="../devSites/" target="_blank" >
    Find additional Resources <i class="fa-solid fa-globe" style="color:#04C0FC;"></i> Here! <i class="fa-solid fa-square-up-right"></i>
</a>

### **Section 2.1.1: Setup Subscription Assistant Macro**

This macro was built to assist you for lessons where you'll Subscribe/Register Feedback to various xAPI Paths. Do not modify this macro, but feel free to learn from this macro and how it operates. 

We won't be reviewing this macro in this lab, so if we'd encourage you take a copy home with you, and review outside this course

???+ Webex "Subscription Assistant Macro"

    === "How to Use"

        === "Home Screen"

            ![SubAssist Home](./assets/general/SubscriptionAssitantMacro-Home.png){ width="600" , align=right }

            After installing and enabling the Subscription Assistant Macro, the macro will generate a UI extension on your Codec's Touch Control Surface

            Clicking on this button, will open various tools for you to use when running through this lab

            ??? gif "View UI Operation"

                <figure markdown>
                  ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
                </figure>

        === "xConfigurations"

            ![SubAssist xConfig](./assets/general/SubscriptionAssitantMacro-xConfig.png){ width="600" , align=right }

            In the xConfigurations Page, you'll have tools for modifying xConfigurations on your device. 
            
            Use these tools when Subscribing/Registering feedback to xConfigurations throughout the various lessons in this lab

        === "xStatuses"

            ![SubAssist xStatus](./assets/general/SubscriptionAssitantMacro-xStatus.png){ width="600" , align=right }

            In the xStatuses Page, you'll have tools that will issue certain xCommands that will cause certain xStatus events to fire on your device. 
            
            Use these tools when Subscribing/Registering feedback to xStatus throughout the various lessons in this lab

        === "xEvents"

            ![SubAssist xEvent](./assets/general/SubscriptionAssitantMacro-xEvent.png){ width="600" , align=right }

            In the xEvents Page, you'll have tools that will cause certain xEvent events to fire on your device. 
            
            Use these tools when Subscribing/Registering feedback to xEvents throughout the various lessons in this lab

        === "Section Cleanup"

            ![SubAssist Home](./assets/general/SubscriptionAssitantMacro-Cleanup.png){ width="600" , align=right }

            Throughout this lab, we will Subscribe to the same xAPI paths from each Integration Method. This is to familiarize you more with the Syntax of each integration method and how to structure that xApi Path.

            That Said, we need to clean up the Codec at the end of each Section. When prompted to by the Lab Guide, run the Section Cleanup button. This will prepare the device for the next set of lessons in this lab

    === "Download and Install"

        === "Download"

            <figure markdown="span">
                [![SubAssist Macro](./assets/general/cisco-logo-transparent.png){ width="300" }](https://github.com/WebexCC-SA/LAB-1451/raw/refs/heads/main/docs/assets/downloadable_resources/Lab-1451_Subscription-Assistant_Part-2.zip)
                <figcaption>Lab-1451_Subscription-Assistant_Part-2 Macro</figcaption>
            </figure>

        === "Install"

            !!! gif

                - Locate the `Lab-1451_Subscription-Assistant_Part-2.zip` file you downloaded
                - Unzip it's Contents
                - Drag the `Lab-1451_Subscription-Assistant_Part-2.js` file into the WebUI of your Device
                - Save the Macro
                - Activate the Macro

                <figure markdown>
                  ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Install.gif){ width="600" }
                </figure>

<a class="md-button md-button--primary" href="../cheatsheet/" target="_blank" >
    Access this table in the CheatSheet <i class="fa-solid fa-screwdriver-wrench" style="color:#1eeb40;"></i> Page! <i class="fa-solid fa-square-up-right"></i>
</a>

- - -
- - -

## <u>**Section 2.2 Accessing the xAPI via SSH**</u>
!!! abstract "Section 2.2 Abstract"

    In this section, we'll dive into the various pieces of the xAPI stack and how to make use of them in various ways over an SSH Session to the codec.

    Topics covered for SSH are nearly a 1:1 match for use cases driven via a Serial Connection, whereas Serial requires additional hardware, it will not be covered in depth in this Lab.

    Understanding how to navigate a terminal session with the codec will be instrumental in your customization journey, but it's also a key integration pillar to many products, such as a room control processors, to interface with a Cisco Codec.

### **2.2.1 - Establish SSH Connection to Device**


- Open the Terminal application on your device
- Connect to the Device via SSH using the built in OpenSSH platform in your terminal window

!!! note inline end

    Replace ``` [USERNAME]``` with your Codec's Username and ``` [IP_ADDRESS]``` with your Codec's IPv4 address that you set in section[X.X.X]

``` shell title="Type into terminal and press Enter"
ssh [USERNAME]@[IP_ADDRESS]
``` 

??? warning "If you encountered an warning running the command above, click here"
    
    If you encounter the following warning

    ``` {.shell, .no-copy}
    ssh [USERNAME]@[IP_ADDRESS]   
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
    Someone could be eavesdropping on you right now (man-in-the-middle attack)!
    It is also possible that a host key has just been changed.
    The fingerprint for the RSA key sent by the remote host is
    SHA256:############################################
    Please contact your system administrator.
    Add correct host key in [PATH]/.ssh/known_hosts to get rid of this message.
    Offending RSA key in [PATH]/.ssh/known_hosts:##
    Host key for [IP_ADDRESS] has changed and you have requested strict checking.
    Host key verification failed.
    ``` 

    Double Check your device information and try again, if the information you entered is correct, try the following

    Then run the following command to clear an old SSH Sha Key
    Be sure to replace ``` [IP_ADDRESS]``` with your Codec's IPv4

    ``` shell title="Type into terminal and press Enter"
    ssh-keygen -R [IP_Address]
    ``` 

    - - -

    If you have a different warning or error and you're unable to resolve it, please ask one of the proctors for assistance

<br>

- The OpenSSH platform will ask for you to confirm the device before connecting
    - Type `yes` when prompted into the terminal, then hit enter
    - Type the ``` [USERNAME]``` account password into the terminal when prompted, then hit enter

!!! success "Successfully connecting to the Codec should prompt the following information and is now awaiting your input"

    ``` {.shell, .no-copy}
    Welcome to  
    Cisco Codec Release RoomOS [Codec_Software_Version]
    SW Release Date: [Codec_Software_ReleaseDate]
    *r Login successful
    OK
    ``` 

### **2.2.2 - Navigating the Terminal**

!!! abstract

    In a terminal session with a Cisco Codec, you can execute commands, get, set or subscribe to configs, get or subscribe to status information as well as subscribe to events.

    These are especially useful when developing a customization or troubleshooting a system.

    Click to expand each xCommand each below, execute them in your terminal session and observe the responses in the terminal window.
    

???+ lesson "Lesson: Lists All User Command Nodes"

    ``` shell title="Type into terminal and press Enter"
    ?
    ``` 

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
              - User Commands -

        help            xcommand        xconfiguration  xdocument       xevent          
        xfeedback       xgetxml         xpreferences    xstatus         xtransaction    
        bye             echo            log             systemtools     
        OK
        ``` 

        We won't cover every command above, we'll only focus on xConfiguration, xCommand, xStatus and xEvent as those contain all the xAPI reference we need to focus on. But we'll also take a brief stop at xPref as it's important for SSH and Serial based integrations.

        For more information on the rest of those paths, check out the [Offical xAPI Guide](https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/roomos-1114/api-reference-guide-roomos-1114.pdf).Page 33 defines all nodes


??? lesson "Lesson: Lists Terminal Preference Options"

    - Lists Terminal Preference Options
      - The xPreferences command is used to set preferences for the RS-232 and SSH sessions. 

    ``` shell title="Type into terminal and press Enter"
    xpref ?
    ``` 

    
    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        xpreferences usage:
          xpreferences outputmode <terminal/xml/json>
        OK
        ```

        Setting ``` xpreferences outputmode``` to JSON will change the terminal response output into a JSON format and likewise with XML

        Why might you consider JSON or XML? 
        
        - Your customization environment may be able to handle responses from the xAPI more efficiently if it's in an output format that easier for your environment to ingest
        - For testing, we'd recommend the terminal format, but when interfacing via a Room Control Processor or another service, you may have tools available to you to parse either JSON or XML to optimize you solution

        ??? example "Compare Output Mode Responses"

            === "Terminal"

                ``` {.shell, .no-copy}
                xpref outputmode terminal

                OK
                xStatus Audio Volume            
                *s Audio Volume: 50
                ** end

                OK
                ``` 

            === "XML"

                ``` {.shell, .no-copy}
                xpref outputmode xml 
                xStatus Audio Volume
                <XmlDoc resultId="">
                <Status>
                  <Audio>
                    <Volume>50</Volume>
                  </Audio>
                </Status>
                </XmlDoc>
                ``` 

            === "JSON"

                ``` {.shell, .no-copy}
                xpref outputmode json    
                xStatus Audio Volume
                {
                  "Status": {
                    "Audio": {
                      "Volume": {
                        "Value": "50"
                      }
                    }
                  }
                }
                ```

??? lesson "Lesson: List Device Command Node References"

    ``` shell title="Type into terminal and press Enter"
    xCommand ?
    ``` 

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        - User Commands -

        AirPlay          HttpClient       Provisioning     UserInterface    
        Audio            HttpFeedback     Proximity        UserManagement   
        Bookings         Logging          RemoteAccess     UserPresence     
        Call             Macros           RoomCleanup      Video            
        CallHistory      Message          RoomPreset       WebEngine        
        Camera           MicrosoftTeams   Security         Webex            
        Cameras          Network          SerialPort       WebRTC           
        Conference       Peripherals      Standby          Whiteboard       
        Diagnostics      Phonebook        SystemUnit       Zoom             
        Dial             Presentation     Time             

        OK
        ``` 


??? lesson "Lesson: List Device Status Node References"
    ``` shell title="Type into terminal and press Enter"
    xStatus ?
    ``` 

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        - Status -

        Audio             ICE               Proximity         Time              
        Bookings          Logging           RemoteAccess      UserInterface     
        Call              MediaChannels     RoomAnalytics     Video             
        Cameras           MicrosoftTeams    RoomPreset        WebEngine         
        Capabilities      Network           SIP               Webex             
        Conference        NetworkServices   Standby           WebRTC            
        Diagnostics       Peripherals       SystemUnit        
        HttpFeedback      Provisioning      ThousandEyes      

        OK
        ```

??? lesson "Lesson: List Device Config Node References"
    ``` shell title="Type into terminal and press Enter"
    xConfiguration ?
    ``` 

    ??? info Click to Compare your Terminal Output
        ``` {.shell, .no-copy}
        - User Configurations -

        Apps              Logging           RoomAnalytics     ThousandEyes      
        Audio             Macros            RoomCleanup       Time              
        Bookings          MicrosoftTeams    RoomScheduler     UserInterface     
        CallHistory       Network           RTP               UserManagement    
        Cameras           NetworkServices   Security          Video             
        Conference        Peripherals       Sensors           VoiceControl      
        FacilityService   Phonebook         SerialPort        WebEngine         
        Files             Provisioning      SIP               Webex             
        HttpClient        Proximity         Standby           WebRTC            
        HttpFeedback      RemoteAccess      SystemUnit        Zoom              

        OK
        ``` 


??? lesson "Lesson: List Device Event Node References"
    ``` shell title="Type into terminal and press Enter"
    xEvent ?
    ``` 

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        xEvent ?
        ** end

        OK
        ``` 

    ??? curious ":thinking: The output of `xEvent ?` was not what you expected?"

          Try Removing the `?` from `xEvent` and re-run the command

          ``` shell title="Type into terminal and press Enter"
          xEvent
          ``` 

          ??? info "Click to Compare your Terminal Output"
              ``` {.shell, .no-copy}
              xEvent  
              *es Event Audio Input Connectors Ethernet SubId LoudspeakerActivity
              *es Event Audio Input Connectors Ethernet SubId NoiseLevel
              *es Event Audio Input Connectors Ethernet SubId PPMeter
              *es Event Audio Input Connectors Ethernet SubId VuMeter
              *es Event Audio Input Connectors HDMI Left PPMeter
              *es Event Audio Input Connectors HDMI Left VuMeter
              *es Event Audio Input Connectors HDMI Right PPMeter
              *es Event Audio Input Connectors HDMI Right VuMeter
              *es Event Audio Input Connectors Line PPMeter
              *es Event Audio Input Connectors Line VuMeter
              [... And the list goes on]
              OK
              ``` 

??? lesson "Lesson: Search for an xAPI using a Wildcard `//`"
    ``` shell title="Type into terminal and press Enter"
    xConfig // Name ?
    ``` 

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        xConfig // Name ?
        *? xConfiguration FacilityService Service[1] Name: <S: 0, 1024>
        *? xConfiguration FacilityService Service[2] Name: <S: 0, 1024>
        *? xConfiguration FacilityService Service[3] Name: <S: 0, 1024>
        *? xConfiguration FacilityService Service[4] Name: <S: 0, 1024>
        *? xConfiguration FacilityService Service[5] Name: <S: 0, 1024>
        *? xConfiguration Network[1] DNS Domain Name: <S: 0, 64>
        *? xConfiguration SystemUnit Name: <S: 0, 50>
        *? xConfiguration UserInterface NameAndSiteLabels Mode: <Auto, Hidden>
        *? xConfiguration UserInterface Theme Name: <Auto, Light, Night>
        *? xConfiguration Video Input Connector[1] Name: <S: 0, 50>
        *? xConfiguration Video Input Connector[2] Name: <S: 0, 50>
        *? xConfiguration Video Input Connector[3] Name: <S: 0, 50>
        *? xConfiguration Video Input Connector[4] Name: <S: 0, 50>

        OK
        ``` 

### **2.2.3 - Executing Commands**

!!! abstract "xCommands"

    Commands instruct the device to execute actions, such as to dial a number or to search the phone book. All commands start with the prefix xCommand followed by a command path

    Click to expand each xCommand example below, execute them in your terminal session and observe the responses in the terminal window as well as observe what happens to the Codec after each execution


???+ lesson "Lesson: Execute an xCommand"

    - **xAPI**: xCommand Video Selfview Set

    - **Task**:

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Selfview Set Mode: On FullscreenMode: On OnMonitorRole: First
        ```

        - Observe the change to your Codec's Display, you should see your camera feed in Full Screen
            
            - If Not, make sure your device's camera cover is not closed

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Selfview Set Mode: On FullscreenMode: Off
        ```

        - Observe the change to your Codec's Display, you should see your camera feed in a PIP Window

    ??? tip "Additional Info"

        Notice when we set the Mode parameter ==**On**== we included the FullScreenMode and OnMonitorRole parameters, but when we decided to turn ==**Off**== selfview, we left out those parameters. know that not all parameters in any given command are required, but some are needed.

    As you explore the API, feel free to click on the {++RoomOS.Cisco.Com++} link in each example to Learn more about the xAPI you're working with.

    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.Video.Selfview.Set/" target="_blank" >
      Learn more about <strong>xCommand Video Selfview Set</strong> <i class="fa-solid fa-square-up-right"></i>
    </a>



??? lesson "Lesson: Execute an xCommand with multiple arguments with the same name"

    - **xAPI(s)**:

        - xCommand Video Selfview Set
        - xCommand Video Input SetMainVideoSource
    
    - **Task**:

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Selfview Set Mode: On FullscreenMode: On
        ```

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Input SetMainVideoSource ConnectorId: 1 ConnectorId: 1
        ```

        - Observe the change to your Codec's Display, you should see 2 instances of your camera feed spread equally in FullScreen

        ??? tip "Additional Info"

            xCommand Video Input SetMainVideoSource, an other xAPIs like it offer some parameters that allow you to enter multiple times. Notice how we used ==ConnectorId: 1== twice. This will create a 2x1 composition of your first video input connector and set this as your ==Main Source==. This will effect selfview and what you output on the far end of the call.

            Though it's **==NOT==** practical to send a duplicated camera source as we are now, this xAPI and how it's executed serves as an example of what's possible to do with larger Cisco Codecs that host multiple cameras connected to it.

        ??? success "View Successful OSD Output"

            <figure markdown>
              ![Official API Doc](./assets/wx1_1451_part_2/2-2-3_SetMain-2xEqual.png){ width="400" }
            </figure>

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Input SetMainVideoSource ConnectorId: 1 ConnectorId: 1 Layout: PIP
        ```

        - Observe the change to your Codec's Display, you should see 2 instances of your camera feed, 1 FullScreen and another in a PiP window

        ??? success "View Successful OSD Output"

            Successful execution of this command, with {++PIP++} set at the ==Layout==, will look similar to image below

            <figure markdown>
              ![Official API Doc](./assets/wx1_1451_part_2/2-2-3_SetMain-2xPIP.png){ width="400" }
            </figure>

        ??? tip "Additional Info"

            xCommand Video Input SetMainVideoSource has more than one parameter we can use to alter the composition in our main source. By default, the ==Layout== parameter is set to a value of ==Equal==, but we could opt for {++PIP++} or {++Prominent++} as ==Layout== values as well.

        - Lets wrap up by setting your MainSource back to a single connector and disable Selfview

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Input SetMainVideoSource ConnectorId: 1
        ```

        ``` shell title="Type into terminal and press Enter"
        xCommand Video Selfview Set Mode: Off
        ```

        - Observe the change to your Codec's Display, your selfview should be gone now

    <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.Video.Input.SetMainVideoSource/" target="_blank" >
          Learn more about <strong>xCommand Video Input SetMainVideoSource</strong> <i class="fa-solid fa-square-up-right"></i>
    </a>

??? lesson "Lesson: Execute an xCommand with a multiline argument"

    !!! info
        Some commands require a larger body of data. This data is a large string; some written in an XML format, some in JSON, and others as base64 encoded content.

        When working in a terminal window, these multiline commands are structure as such
        ``` {.shell, .no-copy}
        [Command Path]
        [Multi Line Content]
        .
        ```

        Note, all must end with a ==.== on the third line.

    - **xAPI**: xCommand UserInterface Extensions Panel Save

    - **Task**:

        ```shell title="Type into terminal and press Enter"
        xCommand UserInterface Extensions Panel Save PanelId: wx1_lab_multilineCommand
        <Extensions><Panel><Order>1</Order><PanelId>wx1_lab_multilineCommand</PanelId><Location>HomeScreen</Location><Icon>Info</Icon><Color>#1170CF</Color><Name>MultiLine Command [Section 2.2.3]</Name><ActivityType>Custom</ActivityType></Panel></Extensions>
        .
        ```
    
    - Observe the change to your Codec's Display, you should see a new Panel Button labeled `MultiLine Command [Section 2.2.3]` on your Touch Control interface

    ??? success "View Successful OSD output"
        <figure markdown>
          ![Official API Doc](./assets/wx1_1451_part_2/2-2-3_UI-Panel-Save.png){ width="600" }
        </figure>

??? lesson "Lesson: Execute an xCommand which generates data and responds"
    !!! info
        Some commands will generate data and output a response of that data. All commands will respond with an "OK" or "Error" but other can provide data.

        Whereas we just made a UI extension with the API, we can now pull a list of our custom extensions using the API

    - **xAPI**: xCommand Extensions List

    - **Task**:

        ``` shell title="Type into terminal and press Enter"
        xCommand UserInterface Extensions List ActivityType: Custom
        ```
      
      - Observe your Terminal Window's output, you should see details of both the `MultiLine Command [Section 2.2.3]` panel you loaded in previously as well as the `Subscription Assistant` panel details

    ??? success "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        OK
        *r ExtensionsListResult (status=OK): 
        *r ExtensionsListResult Extensions Version: "1.11"
        *r ExtensionsListResult Extensions Panel 1 Icon: Custom
        *r ExtensionsListResult Extensions Panel 1 Location: HomeScreenAndCallControls
        *r ExtensionsListResult Extensions Panel 1 ActivityType: Custom
        *r ExtensionsListResult Extensions Panel 1 Name: "Subscription Assistant [Lab 1451]"
        *r ExtensionsListResult Extensions Panel 1 PanelId: "wx1_1451_pt2_labBuddy"
        *r ExtensionsListResult Extensions Panel 1 Origin: local
        *r ExtensionsListResult Extensions Panel 1 Order: 99
        [...]
        *r ExtensionsListResult Extensions Panel 2 Icon: Info
        *r ExtensionsListResult Extensions Panel 2 Location: HomeScreen
        *r ExtensionsListResult Extensions Panel 2 ActivityType: Custom
        *r ExtensionsListResult Extensions Panel 2 Name: "MultiLine Command [Section 2.2.3]"
        *r ExtensionsListResult Extensions Panel 2 PanelId: "wx1_lab_multilineCommand"
        *r ExtensionsListResult Extensions Panel 2 Origin: local
        *r ExtensionsListResult Extensions Panel 2 Order: 1
        *r ExtensionsListResult Extensions Panel 2 Color: "#1170CF"
        *r ExtensionsListResult Extensions Panel 2 Visibility: Auto
        ```

### **2.2.4 - Getting, Setting and Subscribing to xConfigurations**

!!! abstract "xConfigurations"
    Configurations are device settings that are persistent across boots. Like commands, also configurations are structured in a hierarchy

    Click to expand each xConfiguration example below, execute them in your terminal session and observe the responses in the terminal window

???+ lesson "Lesson: Getting an xConfiguration Value"

    - **xAPI**: xConfiguration Audio DefaultVolume

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xConfig Audio DefaultVolume
        ```
        
        - Observe your Terminal Window's output, you should see the value for your Audio DefaultVolume

        ??? info "Click to Compare your Terminal Output"
            ``` {.shell, .no-copy}
            *c xConfiguration Audio DefaultVolume: 50
            ** end

            OK
            ```

??? lesson "Lesson: Set a new xConfiguration Value"

    - **xAPI**: xConfiguration Audio DefaultVolume

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xConfig Audio DefaultVolume: 75
        ```

        - Observe your terminal output and review the response

        ??? info "Click to Compare your Terminal Output"
            ``` {.shell, .no-copy}
            ** end

            OK
            ```

        - Now that we've set the default volume to 75, let's double check our work by getting that value one more time

        ```shell title="Type into terminal and press Enter"
        xConfig Audio DefaultVolume
        ```
        
        ??? info "Click to Compare your Terminal Output"
            ``` {.shell, .no-copy}
            *c xConfiguration Audio DefaultVolume: 75
            ** end

            OK
            ```
    
    !!! note

        The ==getting== and ==setting== of an xConfiguration only differs slightly when accessing via a terminal.

        Click on the tabs below to see the differences side by side

        !!! blank ""

            === "Get xConfiguration"

                xConfiguration Audio DefaultVolume

            === "Set xConfiguration"

                xConfiguration Audio DefaultVolume{++: 75++}

??? lesson "Lesson: Get multiple xConfiguration Values under a Common Node"

    !!! info

        In many cases, you may want to pull information in bulk. We can do this easily by moving running an xConfig get request on ==Higher Common Node== in the xAPI path

        !!! curious "What do we mean by `Higher Common Node`"

            Click on the tabs below, to see how we'll change our requests by accessing a `Higher Common Node` on each level of an xAPI Path

            === "Full xAPI Path"

                {++xConfig Bluetooth Allowed++}

            === "Next Higher Common Node"

                {++xConfig Bluetooth++} {--Allowed--}

            === "Highest Common Node"

                {++xConfig++} {--Bluetooth Allowed--}

            === "View Visual Diagram"

                !!! Note

                    This Diagram only show a very small subset of our xAPI. We have hundreds of xAPI to explore :smiley:


                ``` mermaid
                flowchart TD
                  xAPI --> |Highest Common Node| A
                  A[xConfiguration] -->|Next Node| B(Audio)
                  B --> bb(Default Volume)
                  B --> bc(Input)
                  B --> ba(...)
                  bc --> bd(...)
                  A --> |Next Node| C(Network)
                  C --> CC(IPv4)
                  CC --> CCC(Address)
                  CC --> CCD(Gateway)
                  CC --> CCE(...)
                  A --> |Next Node| D(UserInterface)
                  D --> DD(Message)
                  D --> DF(Extensions)
                  D --> DG(...)
                  DD --> DDE(...)
                  DF --> DDF(...)
                  C --> CD(...) 
                  A --> |Next Node| E(Video)
                  E --> EE(Input)
                  EE --> EEE(...)
                  E --> EF(Output)
                  EF --> EEF(...)
                  E --> EG(...)
                  A --> |Nodes Continued| F(...)
                ```
    
    - **xAPI**: xConfig Audio

    - **Task**: 
    
        ```shell title="Type into terminal and press Enter"
        xConfig Audio
        ```

        - Observe your terminal output and review the response

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        *c xConfiguration Audio Input Value: 75
        *c xConfiguration Audio Input HDMI 1 Level: -5
        *c xConfiguration Audio Input HDMI 1 Mode: On
        *c xConfiguration Audio Input HDMI 1 VideoAssociation MuteOnInactiveVideo: On
        *c xConfiguration Audio Input Microphone 1 Mode: On
        *c xConfiguration Audio Input MicrophoneMode: Focused
        *c xConfiguration Audio Input USBC 1 Level: -5
        *c xConfiguration Audio Input USBC 1 Mode: On
        *c xConfiguration Audio Input USBC 1 VideoAssociation MuteOnInactiveVideo: On
        *c xConfiguration Audio Input USBMicrophone 1 EchoControl Mode: On
        *c xConfiguration Audio Input USBMicrophone 1 Level: 5
        *c xConfiguration Audio Input USBMicrophone 1 Zone: 1
        *c xConfiguration Audio Microphones Mute Enabled: True
        *c xConfiguration Audio Microphones NoiseRemoval Mode: Enabled
        *c xConfiguration Audio Microphones UsbPassthrough MuteButton: Inactive
        *c xConfiguration Audio Microphones VoiceActivityDetector Mode: Off
        *c xConfiguration Audio Output InternalSpeaker Mode: On
        *c xConfiguration Audio Panning HeadsetAnalog BinauralProcessing: True
        *c xConfiguration Audio Panning HeadsetAnalog Mode: Auto
        *c xConfiguration Audio Panning HeadsetUSB BinauralProcessing: False
        *c xConfiguration Audio Panning HeadsetUSB Mode: Auto
        *c xConfiguration Audio Panning Mode: Auto
        *c xConfiguration Audio SoundsAndAlerts RingTone: "Sunrise"
        *c xConfiguration Audio SoundsAndAlerts RingVolume: 0
        *c xConfiguration Audio USB Mode: SpeakerAndMicrophone
        *c xConfiguration Audio USB VolumeControl Capture Mode: Bypass
        *c xConfiguration Audio USB VolumeControl Capture Value: 0
        *c xConfiguration Audio USB VolumeControl Playback Mode: Bypass
        *c xConfiguration Audio USB VolumeControl Playback Value: 0
        *c xConfiguration Audio Ultrasound MaxVolume: 70
        ** end
        ```

        By simply removing ==DefaultVolume== from ==xConfiguration Audio== {--DefaultVolume--}, we get all of the Configurations listed under the Audio Node of the Codec

??? lesson "Lesson: Subscribing to an xConfiguration"
    
    ???+ curious ":thinking: What do we mean by Subscribe?"

        A subscription, or feedback registration, is a means to monitor changes to any xConfiguration, xStatus or xEvent

        This allows you see those changes as they occur and, more importantly, react off of those changes and automate a process without needing to constantly poll for that value

    - **xAPI:** xConfiguration Audio DefaultVolume

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
            xFeedback Register Configuration/Audio/DefaultVolume
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xConfigurations Page, move the Slider labeled ==Audio DefaultVolume== to a new position and release
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Move the slider a few more times to see more changes come in


        ??? gif "Click to Compare your Terminal Output"

            <figure markdown>
              ![Official API Doc](./assets/wx1_1451_part_2/2-2-4_xConfig-Subscribe-DefaultVolume.gif){ width="600" }
            </figure>

        ??? gif "View Subscription Assistant Operation"
            
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

??? lesson "Lesson: Unsubscribing from an xConfiguration"

    Just as we can subscribe to information on the endpoint, we can unsubscribe from that same information

    ??? curious ":thinking: Why bother with Unsubscribing?"

        You can only run up to 50 subscriptions (feedback registrations) on a device

        Documented on page 40 of the <a href="https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/roomos-1114/api-reference-guide-roomos-1114.pdf" target="_blank">Official xAPI Guide</a>

        So as your solutions grow, managing your subscriptions are important. 

        Subscribing to a Higher Common Node, doesn't count towards multiple subscriptions and can allow you to get more data, with less active subscriptions

    - **xAPI**: xConfiguration Audio DefaultVolume

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Deregister Configuration/Audio/DefaultVolume
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xConfigurations Page, move the Slider labeled ==Audio DefaultVolume== to a new position and release
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}
                - ==Optional==: Move the slider a few more times to verify

??? lesson "Lesson: Subscribe to Multiple xConfigurations under a Common Node"

    !!! info

        Similarly to Getting multiple xConfiguration Values, we can subscribe to multiple values under a Higher Common Node

        This can reduce the number of active subscriptions you consume on a device and simplify your solution should you need to react to changes of information across multiple configurations under a Common Node

        !!! example ""

            Click on the tabs below, to see how we'll change our requests by accessing a `Higher Common Node` on each level of an xAPI Path

            === "Full xAPI Path"

                xFeedback Register {++Configuration/Bluetooth/Allowed++}

            === "Next Higher Common Node"

                xFeedback Register {++Configuration/Bluetooth++}{--/Allowed--}

            === "Highest Common Node"

                xFeedback Register {++Configuration++}{--/Bluetooth/Allowed--}

    - **xAPI**: xConfiguration Audio Input Airplay

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Register Configuration/Video/Input/AirPlay
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xConfigurations Page, press the toggles and buttons in the ==Airplay== row
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Press those buttons and switches a few times to see more changes come in

        ??? gif "Click to Compare your Terminal Output"

            <figure markdown>
              ![Official API Doc](./assets/wx1_1451_part_2/2-2-4_xConfig-Subscribe-Airplay.gif){ width="600" }
            </figure>

        ??? gif "View Subscription Assistant Operation"
            
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>


??? lesson "Lesson: Unsubscribe to Multiple xConfigurations under a Higher Common Node"

    - **xAPI**: xConfiguration Audio Input Airplay

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Deregister Configuration/Video/Input/AirPlay
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xConfigurations Page, press the toggles and buttons in the ==Airplay== row
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}
                - ==Optional==: Press those buttons and switches a few times to see more changes come in

    !!! Tip

        In cases where you have multiple subscriptions, you can unsubscribe from all by running

        ```shell title="Type into terminal and press Enter"
        xFeedback DeregisterAll
        ```

### **2.2.5 - Setting and Subscribing to Status**

!!! abstract "xStatuses"
    Statuses contain information about the current state of the device, such as connected calls, the status of the gatekeeper registration, connected inputs and output sources.

    Many of the same techniques we reviewed under section 2.2.4 will apply to section 2.2.5

    Be sure to complete section 2.2.4, as many pieces of additional context were covered there, and won't be repeated moving forward

    Click to expand each xStatus example below, execute them in your terminal session and observe the responses in the terminal window

???+ lesson "Lesson: Getting an xStatus Value"

    - **xAPI**: xStatus Audio Volume

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xStatus Audio Volume
        ```

        - Observe your terminal output and review the response

        ??? info "Click to Compare your Terminal Output"
            ``` {.shell, .no-copy}
            *s Audio Volume: 65
            ** end
            ```

??? lesson "Lesson: Get multiple xStatus Values under a Common Node"

    - **xAPI**: xStatus Audio Input

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xStatus Audio Input
        ```

        - Observe your terminal output and review the response

    ??? info "Click to Compare your Terminal Output"
        ``` {.shell, .no-copy}
        [PLACEHOLDER - LUIS OUTPUT]
        ```

??? lesson "Lesson: Subscribing to an xStatus"

    - **xAPI**: xStatus Audio Volume

    - **Task**:

        ```shell title="Type into terminal and press Enter"
        xFeedback Register Status/Audio/Volume
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xStatuses Page, move the Slider labeled ==Adjust Volume,== to a new position and release
                - Alternatively, you can adjust the volume with the Codec's native volume control buttons
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Move the slider a few more times to see more changes come in

        ??? gif "Click to Compare your Terminal Output"

            <figure markdown>
              ![xStatus Audio Volume Subscription Output Gif](./assets/wx1_1451_part_2/2-2-4_xStatus-Subscribe-Volume.gif){ width="600" }
            </figure>
      
        ??? gif "View Subscription Assistant Operation"
            
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

??? lesson "Lesson: Unsubscribing to an xStatus"

    - **xAPI**: xStatus Audio Input

    - **Task**:

        ```shell title="Type into terminal and press Enter"
        xFeedback Deregister Status/Audio/Volume
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xStatuses Page, move the Slider labeled ==Adjust Volume,== to a new position and release
                - Alternatively, you can adjust the volume with the Codec's native volume control buttons
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}
                - ==Optional==: Move the slider a few more times to see more changes come in

??? lesson "Lesson: Subscribe to Multiple xStatuses under a Common Node"

    - **xAPI**: xStatus Cameras Camera [N] Position

    - **Task**:

        ``` title="Type into terminal and press Enter"
        xFeedback Register Status/Cameras/Camera/Position
        ```

        ??? curious "What happened to the `[N]` in the xAPI Path?"

            You may have noticed we never declared `[N]` in the xAPI Path for the command we ran. This was left out on purpose. `[N]` corresponds to the ==CameraId== you want to target. Some Codecs can control up 7 cameras, so these xAPI paths branch per connected Camera

            Whereas you could be running this lab on a variety of Codec's, it's better to leave this out for Lab Purposes, but also has value in a multi-camera system, allowing us to subscribe to ALL camera's positions as they change :smiley:

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xStatuses Page, click the button in the ==Camera Control Wheel== row
                - Alternatively, you can adjust your cameras position through the native camera control interface
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Continue pressing buttons to see more changes come in

        ???+ gif "Click on the tabs below to"

            === "Compare Terminal"

                <figure markdown>
                  ![xStatus Cameras Camera[N] Position Output Gif](./assets/wx1_1451_part_2/2-2-4_xStatus-Subscribe-CameraPosition.gif){ width="600" }
                </figure>

            === "View Subscription Assistant"
                
                <figure markdown>
                  ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
                </figure>

            === "View Native Camera Control Interface"

                <figure markdown>
                  ![Navigate to Camera Control Menu GIF](./assets/wx1_1451_part_2/2-2-4_CameraMenuAccess.gif){ width="600" }
                </figure>

??? lesson "Lesson: Unsubscribe from all xStatuses"

    - **xAPI**: N/A

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
            xFeedback DeregisterAll
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xStatuses Page, click the button in the ==Camera Control Wheel== row
                - Alternatively, you can adjust your cameras position through the native camera control interface
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}
                - ==Optional==: Continue pressing buttons to see more changes come in

### **2.2.6 - Subscribing to Events**

!!! Abstract "xEvents"

    Event returns information about the events that are available for feedback. 

    Click to expand each xEvent example below, execute them in your terminal session and observe the responses in the terminal window

???+ lesson "Lesson: Subscribing to an xEvent"

    - **xAPI**: xEvent UserInterface Message Prompt Response

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Register Event/UserInterface/Message/Prompt/Response
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xEvents Page, click the {++Prompt Button++} in the ==UserInterface Message== row
                - This will create a Pop Up with 5 options
                - Click on any of these 5 Options
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Try each of the options under `Prompt` and continue to observe your {++Terminal Windows++}
            - Press click either the `TextInput`, the `Rating` or the `Alert` button and submit any accompanying actions in that interface
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - Responses for `TextInput`, `Rating` or `Alert` shouldn't show since you're currently only subscribed to `Prompt`
    
        ??? gif "Click to Compare your Terminal Output"

            <!-- <figure markdown>
              ![xEvent UserInterface ScreenShotRequest RequestId Output Gif](./assets/wx1_1451_part_2/2-2-4_xEvent-Subscribe-ScreenShotRequest.gif){ width="600" }
            </figure> -->
        
        ??? gif "View Subscription Assistant Operation"
                
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>


??? lesson "Lesson: Unsubscribing to an xEvent"

    - **xAPI**: xEvent UserInterface Message Prompt Response

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Deregister Event/UserInterface/ScreenShotRequest/RequestId
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xEvents Page, click either the `Prompt`, the `TextInput`, the `Rating` or the `Alert` button in the ==UserInterface Message== row and submit any accompanying actions in that interface
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}

??? lesson "Lesson: Subscribe to Multiple xEvents under a Common Node"

    - **xAPI**: xEvent UserInterface

    !!! note inline end

        By Subscribing to a High Common Node, such as xEvent UserInterface, we can see all UI related Events available in that xAPI Node

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
        xFeedback Register Event/UserInterface
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xEvents Page, try any of the `Widgets` on this page, and submit any accompanying actions in that interface if any
            - Observe your {++Terminal Windows++} output, you should see events for your Subscription fill the {++Terminal Window++}
                - ==Optional==: Try all of the `Widget` on that page :smiley:
    
        ??? gif "Click to Compare your Terminal Output"

            <figure markdown>
              ![xEvent UserInterface Output Gif](./assets/wx1_1451_part_2/2-2-4_xEvent-Subscribe-UserInterface.gif){ width="600" }
            </figure>

        ??? gif "View Subscription Assistant Operation"
            
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

??? lesson "Lesson: Unsubscribe from all xEvents"

    - **xAPI**: N/A

    - **Task**: 

        ```shell title="Type into terminal and press Enter"
            xFeedback DeregisterAll
        ```

        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xEvents Page, try any of the `Widgets` on this page, and submit any accompanying actions in that interface if any
            - Observe your {++Terminal Windows++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Terminal Window++}
                - ==Optional==: Continue pressing buttons to see more changes come in

### **2.2.7 - Tagging your xAPI Calls**

As you work to build your automation in a SSH or Serial terminal session, you may find yourself making multiple calls against the same path and the timing of that output may be critical of your solution.

To help simplify which data belongs where, you can tag your xAPI paths with a custom value to better track your work.

By appending `|resultId="myValue"` to the end of any xAPI Call, the response from that xAPI will include that resultId you assign

!!! example "Review Tagging examples below"

    === "xStatus Audio Volume"

        ``` shell
        xStatus Audio Volume |resultId="Custom Value 1"
        *s Audio Volume: 50
        ** resultId: "Custom Value 1"
        ** end
        ```
    
    === "xCommand Video Selfview Set"

        ``` shell
        xCommand Video Selfview Set Mode: On |resultId="Custom Value 2"

        OK
        *r SelfviewSetResult (status=OK): 
        ** resultId: "Custom Value 2"
        ** end
        ```
    
    === "xConfiguration SystemUnit Name"

        ``` shell
        xConfiguration SystemUnit Name |resultId="Custom Value 3"
        *c xConfiguration SystemUnit Name: " "
        ** resultId: "Custom Value 3"
        ** end

        OK
        ```

    === "xFeedback Register Event/CallSuccessful"

        !!! note

            When declaring xFeedback, or subscribing to any xAPI, the resultId will only print when you execute the command, but will not print with the subsequent data coming in from the subscription

        ``` shell
        xFeedback Register Event/CallSuccessful |resultId="Custom Value 4"
        ** resultId: "Custom Value 4"
        ** end

        OK
        *e CallSuccessful Protocol: "Spark"
        *e CallSuccessful Direction: "outgoing"
        *e CallSuccessful RemoteURI: "spark:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
        *e CallSuccessful EncryptionIn: "On"
        *e CallSuccessful EncryptionOut: "On"
        *e CallSuccessful CallRate: 20000
        *e CallSuccessful CallId: 3
        ** end
        *e CallSuccessful Protocol: "Spark"
        *e CallSuccessful Direction: "outgoing"
        *e CallSuccessful RemoteURI: "spark:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
        *e CallSuccessful EncryptionIn: "On"
        *e CallSuccessful EncryptionOut: "On"
        *e CallSuccessful CallRate: 20000
        *e CallSuccessful CallId: 4
        ** end  
        ```

### **2.2.8 - Section 2.2 Cleanup**

!!! abstract

    As we move into the rest of this lab, we'll cover alot of the same xAPI concepts as we had in our SSH terminal session from other integration methods available on the endpoint

    To be respectful of time, we'll only cover the minimum needed in those other integration methods, know if there is an xAPI accessible, there is a way from nearly all integration methods

!!! important

    - Press the `Subscription Assistant Button` on your Touch Interface
    - Under the ==Section Cleanup== Page, select the ==Run Section Cleanup?== button
    - Select ==Yes, Run the Cleanup Script==

    <figure markdown="span">
      ![Section cleanup](./assets/general/SubscriptionAssitantMacro-ConfirmCleanup.png){ width="400" }
      <figcaption>Section Cleanup Confirmation</figcaption>
    </figure>

    This will reverse the changes we've made to the endpoint, and leave us ready for the next section


    ??? question "You can run the cleanup via the terminal as well"

        Copy the contents below into your terminal window and run them all at once

        ```shell title="Type into terminal and press Enter"
        xFeedback DeregisterAll
        xConfig Audio DefaultVolume: 50
        xCommand UserInterface Extensions Panel Remove PanelId: wx1_lab_multilineCommand
        xCommand Video Selfview Set Mode: Off FullscreenMode: Off
        xCommand Video Input SetMainVideoSource ConnectorId: 1
        xCommand Audio Volume SetToDefault Device: Internal
        ```
    
    Feel free to close your Terminal Window

- - -
- - -

## <u>**Section 2.3: Accessing the xAPI via HTTP**</u>

!!! abstract "Section 2.3 Abstract"

    Like we can with SSH, the xAPI can be accessed via the HTTP protocol. What we'll do in this section is run through the same commands, configs, statuses and events as we did in the SSH section, but the techniques involved executed in a different manner


!!! important "Section Requirements"
    
    - If Postman is **==NOT==** installed, be sure to install it before continuing section 2.3

    We'll also be leveraging a Webhook testing site, make sure you have that open in another tab/window as well

    <div class="grid cards" markdown>

    -   <i class="fa-solid fa-download"></i> __Click the icon below for the Postman Download Page__

        ---

        <a href="https://www.Postman.com/downloads/" target="_blank">
          <figure markdown="span">
              ![Postman Download](https://voyager.postman.com/logo/postman-logo-icon-orange.svg){ width="75" }
          </figure>
        </a>
    
    -   <i class="fa-solid fa-download"></i> __Click the icon below for the Section 2.3 Postman Collection__

        ---

        <a href="https://github.com/WebexCC-SA/LAB-1451/raw/refs/heads/main/docs/assets/downloadable_resources/PostMan%20Collections/WX1-Lab-1451-HTTP-PostMan-Collection.postman_collection.zip" target="_blank">
          <figure markdown="span">
              ![Postman Collection](https://voyager.postman.com/logo/postman-logo-icon-orange.svg){ width="75" }
          </figure>
        </a>

    -   <i class="fa-solid fa-globe"></i> __Click the icon below for the WebHook Site__ <br><br>

        ---
        <a href="https://webhook.site/" target="_blank">
          <figure markdown="span">
            ![Webhook.site](https://cdn.webhook.site/icon.png){ width="75" }
          </figure>
        </a>

    </div>

### **2.3.1 - HTTP Authentication and Format**

!!! blank ""

    <h4>URL Structure</h4>

    The request URL for your Codec will change depending on whether you're making a Get or Post Call

    !!! example ""

        === "Get Url"

            https://[YOUR_DEVICE_IP]/==getxml?location=[YOUR_XAPI_PATH_BODY]==

        === "Post Url"

            https://[YOUR_DEVICE_IP]/==putxml==


    - - -

    <h4>Authentication Format</h4>

    The Codec uses basic authentication to accept incoming HTTP requests. This authentication is formatted in base64 with it's username and password concatenated as a single string separated by a colon ==:==

    !!! example "Click on the tabs below to see how an example Username and Password transitions to base64"

        === "Base Credentials >"

            **Username**: ==admin==
            <br>
            **Password**: ==admin1234==

        === "Decoded String >"

            ==admin:admin1234==
            <br>
            <br>

        === "Base64 Encoded String >"

            ==YWRtaW46YWRtaW4xMjM0==
            <br>
            <br>

        === "Authorization Request Header"

            "Authorization": "Basic ==YWRtaW46YWRtaW4xMjM0=="
            <br>
            <br>

    - - -

    <h4>Request Headers</h4>

    Your Get and Post requests will use this Authorization in one of its 2 headers

    | Key                         | Value                             |
    | :---------------------------| :---------------------------------|
    | `Content-Type`              | `text/xml`                        |
    | `Authorization`             | `Basic [YOUR_BASE64_ENCODED_AUTH]` |

    - - -

    <h4>Body Format</h4>

    To target a specific path, you need to provide a body to either your Get or Post request

    Get Requests define their xAPI in the ==location== parameter in the Url itself

    For Post requests, a body structured as XML and provided as a string is required

    Here is the fully realized path for **`xConfiguration SystemUnit Name`**

    !!! example ""

        === "Get"

            Url: https://[YOUR_DEVICE_IP]/getxml?location\===Configuration/SystemUnit/Name==

            Body: N/A

            !!! important ""

                Notice how **`xConfiguration SystemUnit Name`** is structured in the ==?location== Url Parameter using `/` as a separator. When formatting a Get Request, the full xAPI path will go here, but be sure to remove the `x` in the Parent xAPI Path

                - {--x--}{++Configuration++}/Child/Child/...
                - {--x--}{++Command++}/Child/Child/...
                - {--x--}{++Status++}/Child/Child/...

        === "Post"

            Url: https://[YOUR_DEVICE_IP]/putxml

            Body: ==<Configuration\><SystemUnit\><Name\>=={++My New System Name++}==</Name\></SystemUnit\></Configuration\>==

            !!! important ""

                With Post requests, a body payload must be provided and the xAPI path is no longer structured in the Url

                The body must be a String in XML format and each Path for the xAPI are instead the Opening and Closing Tags for the xAPI in question

                All closing tags must have a `/` added in front

                All Values are placed in between their respective parameter tags

                Remove the `x` in the Parent xAPI Path

                - <{--x--}{++Configuration++}></{--x--}{++Configuration++}>
                - <{--x--}{++Command++}></{--x--}{++Configuration++}>
                - <{--x--}{++Status++}></{--x--}{++Configuration++}>

                ``` { .xml , title="Example XML Structure" } 
                <Parent>
                  <Child>
                    <ChildParameter>Value<ChildParameter>
                  </Child>
                <Parent>
                ```

    - - -

    ??? tip inline end "Take advantage of your Code Language"

        Many languages have built in function to help process data

        For instance, when working in ES6 or newer Javascript Environments, you can leverage the `btoa()` and `atob()` functions that are built into that language to quickly encode and decode strings to/from base64. Ex: `btoa('admin:admin1234')` = ==YWRtaW46YWRtaW4xMjM0\====

    <h4>Full HTTP Get and Post examples</h4>

    ??? success "Click to view a Full Example of each written using the JavaScript Fetch API"

        === "Get"

            ``` JavaScript
            const myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/xml");
            myHeaders.append("Authorization", "Basic [YOUR_BASE64_ENCODED_AUTH]");

            const requestOptions = {
              method: "GET",
              headers: myHeaders,
              redirect: "follow"
            };

            fetch("https://[YOUR_DEVICE_IP]/getxml?location=Configuration/SystemUnit/Name", requestOptions)
              .then((response) => response.text())
              .then((result) => console.log(result))
              .catch((error) => console.error(error));
            
            /* Below is the Response Body after making a Successful Request

            <?xml version="1.0"?>
            <Configuration product="Cisco Codec" version="ce11.20.1.7.913a6c7c769" apiVersion="4">
                <SystemUnit>
                    <Name valueSpaceRef="/Valuespace/STR_0_50_NoFilt"> My Room Bar Pro</Name>
                </SystemUnit>
            </Configuration>
            */
            ```

        === "Post"

            ``` JavaScript
            const myHeaders = new Headers();
            myHeaders.append("Content-Type", "text/xml");
            myHeaders.append("Authorization", "Basic [YOUR_BASE64_ENCODED_AUTH]");

            const raw = "<Configuration><SystemUnit><Name>My New System Name</Name></SystemUnit></Configuration>";

            const requestOptions = {
              method: "POST",
              headers: myHeaders,
              body: raw,
              redirect: "follow"
            };

            fetch("https://[YOUR_DEVICE_IP]/putxml", requestOptions)
              .then((response) => response.text())
              .then((result) => console.log(result))
              .catch((error) => console.error(error));

            /* Below is the Response Body after making a Successful Request

            <?xml version="1.0"?>
            <Configuration>
                <Success/>
            </Configuration>
            */
            ```
    ??? success "Click to view a Full Example of each written using the Macro Editor [ES6 JS] and your codec's HTTPClient xAPIs"

        === "Get"

            ```javascript
            import xapi from 'xapi';

            const destinationIp = '[YOUR_DEVICE_IP]';
            const headers = ['Content-Type: text/xml', `Authorization: Basic ${btoa('[YOUR_AUTH]')}`];


            async function getPath(path){
              const destinationUrl = `https://${destinationIp}/getxml?location=${path}`;

              try {
                const request = await xapi.Command.HttpClient.Get({
                  Url: destinationUrl,
                  Header: headers,
                  AllowInsecureHTTPS: 'True'
                })
                console.debug(request);
                return request
              } catch (e) {
                let err = {
                  Context: `Failed Get Request to [${destinationUrl}]`,
                  ...e
                }
                throw new Error(e)
              }
            }

            getPath('Configuration/SystemUnit/Name');
            ```
        
        === "Post"

            ```javascript
            import xapi from 'xapi';

            const destinationIp = '[YOUR_DEVICE_IP]';
            const headers = ['Content-Type: text/xml', `Authorization: Basic ${btoa('[YOUR_AUTH]')}`];


            async function setPath(body){
              const destinationUrl = `https://${destinationIp}/putxml`;

              try {
                const request = await xapi.Command.HttpClient.Post({
                  Url: destinationUrl,
                  Header: headers,
                  AllowInsecureHTTPS: 'True'
                }, body)
                console.debug(request);
                return request
              } catch (e) {
                let err = {
                  Context: `Failed Post Request to [${destinationUrl}]`,
                  ...e
                }
                throw new Error(e)
              }
            }

            setPath('<Configuration><SystemUnit><Name>My New System Name</Name></SystemUnit></Configuration>');
            ```

        <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.HttpClient.Get/?search=HTTPClient" target="_blank" >
              Learn more about <strong>Device HTTPClient xAPIs</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>

        ??? curious ":thinking: Hey, what's up with that `...e` in your caught error?"

            Again, knowing you language has it's benefits

            `...` is called a ==Spread Operator== and it's very useful when playing with data in ES6 JS

            We're using it here to pass the original error the xAPI produced into an ==err== object as well as some context to help us troubleshoot our macro in the future.

            <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" target="_blank" >
                  Learn more about <strong>Spread Operators</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>


    ??? success "Click to view a Full Example of each written using the Python Requests API"

        === "Get"

            ``` Python
            import requests

            url = "https://[YOUR_DEVICE_IP]/getxml?location=Configuration/SystemUnit/Name"

            payload = ""
            headers = {
              'Content-Type': 'text/xml',
              'Authorization': 'Basic [YOUR_BASE64_ENCODED_AUTH]'
            }

            response = requests.request("GET", url, headers=headers, data=payload)

            print(response.text)

            # Below is the Response Body after making a Successful Request

            # <?xml version="1.0"?>
            # <Configuration>
            #     <Success/>
            # </Configuration>
            ```

        === "Post"

            ``` Python
            import requests

            url = "https://[YOUR_DEVICE_IP]/putxml"

            payload = "<Configuration><SystemUnit><Name>My New System Name</Name></SystemUnit></Configuration>"
            headers = {
              'Content-Type': 'text/xml',
              'Authorization': 'Basic [YOUR_BASE64_ENCODED_AUTH]'
            }

            response = requests.request("POST", url, headers=headers, data=payload)

            print(response.text)
            
            # Below is the Response Body after making a Successful Request

            # <?xml version="1.0"?>
            # <Configuration product="Cisco Codec" version="ce11.20.1.7.913a6c7c769" apiVersion="4">
            #     <SystemUnit>
            #         <Name valueSpaceRef="/Valuespace/STR_0_50_NoFilt"> My Room Bar Pro</Name>
            #     </SystemUnit>
            # </Configuration>
            ```
    


### **2.3.2 - Import and Configure the section 2.3 Postman Collection**

Whereas we'll be using Postman, this tool will automatically take our basic auth and structure as an with Header for us and convert that string into base64

This collection has most pieces structured as we'd need it to and will be used through section 2.3.2 through 2.3.5

- - -

<h4>Import Collection</h4>

- With Postman open, in a new or existing workspace select ==import==
- Select File
- Locate the ==WX1-Lab:1451-HTTP-Postman-Collection.Postman_collection.json== and Open it
- You should now have the Postman Collection installed for this lab

??? gif "View Import Postman Collection"

    <figure markdown>
      ![Import Lab Postman Collection](./assets/wx1_1451_part_2/2-3-2_Import-PostmanCollection.gif){ width="600" }
    </figure>

- - -

<h4>Configure Postman Collection for sections 2.3.3 through 2.3.5</h4>

- Click on the ==WX1-Lab:1451-HTTP-Postman-Collection== root folder
- Select Variables
- Add the following information for your codec in both the `Initial Value` and `Current Value` fields
    - device_username
    - device_password
    - device_ipAddress
- Select Save (or one of the keyboard shortcuts for your computer)
    - ++control+s++ for Windows
    - ++command+s++ for Mac

??? gif "View Configure Postman Collection for sections 2.3.3 through 2.3.5"

    <figure markdown>
      ![Import Lab Postman Collection](./assets/wx1_1451_part_2/2-3-2_Configure-PostmanCollection.gif){ width="600" }
    </figure>

### **2.3.3 - Executing xCommands**

!!! Abstract

   Throughout section 2.3.3, you'll learn how to format and execute xCommands via HTTP using Postman.

   The techniques outlined here will correspond to the methods needed for setting new xConfiguration Values in section 2.3.4

???+ lesson "Lesson: Execute an xCommand"

    !!! info inline end "XML Body Location"

        <figure markdown>
          ![XML Body Location](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-BodyLocation.png){ width="400" }
        </figure>

    - **xAPI:** xCommand Video Selfview Set

    - **Task:** Structure the xAPI command above into an XML format then place this into the Body of the ==Execute an xCommand== request in your Postman collection. Include the following Parameters and Values
        - Mode: On
        - FullScreenMode: On
        - OnMonitorRole: First

    Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    - - -

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-Success.png){ width="600", align=right }

        ``` { .xml }
        <Command>
          <Video>
            <Selfview>
              <Set>
                <Mode>On</Mode>
                <FullScreenMode>On</FullScreenMode>
                <OnMonitorRole>First</OnMonitorRole>
              </Set>
            </Selfview>
          </Video>
        </Command>
        ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure>

??? lesson "Lesson: Execute multiple xCommands in a single request"

    !!! info

        You can structure your XML to allow for multiple xAPI calls under a single Parent Path, in this case the Parent Path is xCommand

        So long as the paths you're running are under their appropriate Common Path Nodes, then they will be considered. Should those Common Path Nodes deviate, then you must structure the XML to match

    - **xAPI(s):**
        - ==xCommand== Video Selfview Set
        - ==xCommand UserInterface== WebView Display
        - ==xCommand UserInterface== Message Rating Display

    - **Task:** `xCommand Video Selfview Set` and `xCommand UserInterface WebView Display` have already be set in your collection under their appropriate Common Node Path. We've highlighted the Common Node Paths above for you to see. Structure the XML for {++xCommand UserInterface Message Rating Display++} and place it as the next xCommand in the XML structure given to you. Include the following Parameters and Values
        - Title: Rate this Site
        - Text: From 0 to 5 stars, rate this Website
        - Duration: 45

    Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? success "View Successful OSD Output"

        <figure markdown="span">
          ![OSD Output](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleCommands-OSD.png){ width="500" }
          <figcaption>What to expect on your OSD on a successful request</figcaption>
        </figure>

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleCommands-Success.png){ width="500", align=right }

        === "Message Rating Display XML"

            ``` { .xml }
            <Command>
              <UserInterface>
                <Message>
                  <Rating>
                    <Display>
                      <Title>Rate this Site</Title>
                      <Text>From 0 to 5 stars, rate this Website</Text>
                      <Duration>45</Duration>
                    </Display>
                  </Rating>
                </Message>
              </UserInterface>
            </Command>
            ```

        === "Full XML body"

            ``` { .xml }
            <Command>
              <Video>
                <Selfview>
                  <Set>
                    <Mode>Off</Mode>
                  </Set>
                </Selfview>
              </Video>
              <UserInterface>
                <WebView>
                  <Display>
                    <Mode>Modal</Mode>
                    <Url>https://roomos.cisco.com</Url>
                  </Display>
                </WebView>
                <!-- Message Rating Display Should Start Here -->
                <Message>
                  <Rating>
                    <Display>
                      <Title>Rate this Site</Title>
                      <Text>From 0 to 5 stars, rate this Website</Text>
                      <Duration>45</Duration>
                    </Display>
                  </Rating>
                </Message>
                <!-- Message Rating Display Should End Here -->
              </UserInterface>
            </Command>
            ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure>

??? lesson "Lesson: Execute an xCommand with multiple arguments with the same name"

    !!! info

        We can structure the XML payload for HTTP to include multiple parameters under the same name

        Simply duplicate the Parameter that's capable of being duplicated and add that into your XML body. Be sure to include the Opening and Closing XML tags for that parameter as well

    - **xAPI(s):**
        - xCommand UserInterface WebView Clear
        - xCommand UserInterface Message Rating Clear
        - xCommand Video Selfview Set
        - xCommand Video Input SetMainVideoSource
    
    - **Task:** We'll be running multiple commands in conjunction to having multiple parameters in this lesson.
        - To clean up from the previous lesson, we'll send an xCommand to clear by replacing the Display Tags for both with Clear and deleting any parameters they had
            - `xCommand UserInterface WebView {--Display--}{++Clear++}`
            - `xCommand UserInterface Message Rating {--Display--}{++Clear++}`
        - Then we'll set selfview back on in Full Screen
        - The above tasks will come preloaded in the Postman collection, your task is to structure the XML for {++xCommand Video Input SetMainVideoSource++} and place it as the next xCommand in the XML structure given to you and **duplicate** the `ConnectorId` parameter. Include the following Parameters and Values
            - ConnectorId: 1
            - Layout: Prominent

    Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? success "View Successful OSD Output"

        <figure markdown="span">
          ![OSD Output](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleSameNameParameter-OSD.png){ width="500" }
          <figcaption>What to expect on your OSD on a successful request</figcaption>
        </figure>
    
    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultipleSameNameParameter-Success.png){ width="500", align=right }

        === "Video Input SetMainVideoSource XML"

            ``` { .xml }
            <Command>
              <Video>
                <Input>
                  <SetMainVideoSource>
                    <ConnectorId>1</ConnectorId>
                    <!-- Your Duplicate ConnectorId Parameter Should Start Here  -->
                    <ConnectorId>1</ConnectorId>
                    <!-- Your Duplicate ConnectorId Parameter Should End Here  -->
                    <Layout>Prominent</Layout>
                  </SetMainVideoSource>
                </Input>
              </Video>
            </Command>
            ```

        === "Full XML body"

            ``` { .xml }
            <Command>
              <UserInterface>
                <WebView>
                  <Clear></Clear>
                </WebView>
                <Message>
                  <Rating>
                    <Clear></Clear>
                  </Rating>
                </Message>
              </UserInterface>
              <Video>
                <Selfview>
                  <Set>
                    <Mode>On</Mode>
                    <FullScreenMode>On</FullScreenMode>
                    <OnMonitorRole>First</OnMonitorRole>
                  </Set>
                </Selfview>
                <Input>
                  <SetMainVideoSource>
                    <ConnectorId>1</ConnectorId>
                    <!-- Your Duplicate ConnectorId Parameter Should Start Here  -->
                    <ConnectorId>1</ConnectorId>
                    <!-- Your Duplicate ConnectorId Parameter Should End Here  -->
                    <Layout>Prominent</Layout>
                  </SetMainVideoSource>
                </Input>
              </Video>
            </Command>
            ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure> 

??? lesson "Lesson: Execute an xCommand with a multiline argument"

    !!! info

        Multiline Arguments can be placed into the body of the XML as well. This specifically uses a `<body>` which isn't explicitly highlighted in the path of the API.

        The structure of a Multiline argument should look similar to the following

        ``` { .xml , .no=copy, title="Example XML Structure with Multiline Argument" }
        <Parent>
          <Child>
            <ChildParameter>Value<ChildParameter>
            <body>[MY_MULTILINE_ARGUMENT]</body>
          </Child>
        <Parent>
        ```

    - **xAPI(s):**
        - xCommand Video Selfview Set
        - xCommand Video Input SetMainVideoSource
        - xCommand UserInterface Extensions Panel Save
    
    - **Task:** We'll be running multiple commands in conjunction to having a multiline argument.
        - We'll start by correcting our Camera View from the previous lesson, which will come pre-loaded in the Postman Collection
        - Your task is to structure the XML for {++xCommand UserInterface Extensions Panel Save++} and place it as the next xCommand in the XML structure given. Include the following Parameters and Values
            - PanelId: wx1_lab_multilineCommand
            - body:
                ```{ .xml , title="Your &lt;body&gt; Value" }
                <Extensions>
                  <Panel>
                    <Order>1</Order>
                    <PanelId>wx1_lab_multilineCommand</PanelId>
                    <Location>HomeScreen</Location>
                    <Icon>Info</Icon>
                    <Color>#FF70CF</Color>
                    <Name>MultiLine Command [Section 2.3.3]</Name>
                    <ActivityType>Custom</ActivityType>
                  </Panel>
                </Extensions>
                ```

    Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
    
    ???+ warning "You're Wrapping XML around XML!"

        **Note:** Not all multiline arguments are in XML format; for example, {++xCommand UserInterface Extensions Panel Save++} is. Its important to remember that any data placed within a `<body>` tag should always be written as a `String`. If your integration automatically injects this information, additional processing may be necessary.

        The xAPI will have a hard time deciphering your Body's XML value vs the xAPI XML Payload

        You'll want to "Stringify" the XML body by replacing all instances of `<` characters with {++&amp;lt;++} and all instances of `>` characters with {++&amp;gt;++} &gt;

        - These aren't the only characters that are impacted, and that will largely depend on your XML body value

        Luckily, you can use the **Stringify XML Body** on the Tools Page to do this for you

        <a class="md-button md-button--primary" href="../tools/" target="_blank" >
          Open **Tools** <i class="fa-solid fa-gear"></i> Page <i class="fa-solid fa-square-up-right"></i>
        </a>

    ??? success "View Successful OSD Output"

        <figure markdown="span">
          ![OSD Output](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultiLine-OSD.png){ width="500" }
          <figcaption>What to expect on your OSD on a successful request</figcaption>
        </figure>

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-MultiLine-Success.png){ width="500", align=right }

        === "UserInterface Extensions Panel Save XML"

            ``` { .xml }
            <Command>
              <UserInterface>
                <Extensions>
                  <Panel>
                    <Save>
                      <PanelId>wx1_lab_multilineCommand</PanelId>
                      <body>&lt;Extensions&gt; &lt;Panel&gt; &lt;Order&gt;1&lt;/Order&gt; &lt;PanelId&gt;wx1_lab_multilineCommand&lt;/PanelId&gt; &lt;Location&gt;HomeScreen&lt;/Location&gt; &lt;Icon&gt;Info&lt;/Icon&gt; &lt;Color&gt;#FF70CF&lt;/Color&gt; &lt;Name&gt;MultiLine Command [Section 2.3.3]&lt;/Name&gt; &lt;ActivityType&gt;Custom&lt;/ActivityType&gt; &lt;/Panel&gt; &lt;/Extensions&gt;
                      </body>
                    </Save>
                  </Panel>
                </Extensions>
              </UserInterface>
            </Command>
            ```

        === "Full XML body"

            ``` { .xml }
            <Command>
              <Video>
                <Selfview>
                  <Set>
                    <Mode>Off</Mode>
                  </Set>
                </Selfview>
                <Input>
                  <SetMainVideoSource>
                    <ConnectorId>1</ConnectorId>
                    <Layout>Equal</Layout>
                  </SetMainVideoSource>
                </Input>
              </Video>
              <!-- Your UserInterface Extensions Panel Save XML Should Start Here  -->
              <UserInterface>
                <Extensions>
                  <Panel>
                    <Save>
                      <PanelId>wx1_lab_multilineCommand</PanelId>
                      <body>&lt;Extensions&gt; &lt;Panel&gt; &lt;Order&gt;1&lt;/Order&gt; &lt;PanelId&gt;wx1_lab_multilineCommand&lt;/PanelId&gt; &lt;Location&gt;HomeScreen&lt;/Location&gt; &lt;Icon&gt;Info&lt;/Icon&gt; &lt;Color&gt;#FF70CF&lt;/Color&gt; &lt;Name&gt;MultiLine Command [Section 2.3.3]&lt;/Name&gt; &lt;ActivityType&gt;Custom&lt;/ActivityType&gt; &lt;/Panel&gt; &lt;/Extensions&gt;
                      </body>
                    </Save>
                  </Panel>
                </Extensions>
              </UserInterface>
              <!-- Your UserInterface Extensions Panel Save XML Should Start Here  -->
            </Command>
            ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure> 

??? lesson "Lesson: Execute an xCommand which generates data and responds"

    !!! info

        Some commands will generate data and output a response of that data. All commands will respond with an "OK" or "Error" but other can provide data.

        Whereas we just made a UI extension with the API, we can now pull a list of our custom extensions using the API

    - **xAPI:** xCommand UserInterface Extensions List

    - **Task:** Structure the xAPI command above into an XML format then place this into the Body of the ==Execute an xCommand which generates data and responds== request in your Postman collection. Include the following Parameters and Values
        - ActivityType: Custom

    Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommandWithResponse-Success.png){ width="700", align=right }

        ``` { .xml }
        <Command>
          <UserInterface>
            <Extensions>
              <List>
                <ActivityType>Custom</ActivityType>
              </List>
            </Extensions>
          </UserInterface>
        </Command>
        ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure>

??? challenge "Challenge: Open a Text Input Prompt!"

    - Duplicate the ==Execute an xCommand== request in Postman
    - Replace the body of this request with a new body that implements <a href="https://roomos.cisco.com/xapi/Command.UserInterface.Message.TextInput.Display/" target="_blank">xCommand UserInterface Message TextInput Display</a>
    - Set the Following Parameters [Keep them Safe for Work :pray:]
        - Title
        - Text
        - Duration: [Set any value between 15 and 45]
    - Save and Execute
    - Look at your Touch Controller, it should have a Text Input field :smiley:

    ??? success "View a Successful Touch Controller ScreenShot"

        <figure markdown>
          ![Successful Text Input Pop Up](./assets/wx1_1451_part_2/2-3-3_Challenge-TextInput.png){ width="800" }
        </figure>

        <a class="md-button md-button--primary" href="../challengeAnswers/" target="_blank" >
          Giving Up? Check out the Challenge Answers Page <i class="fa-solid fa-square-up-right"></i>
        </a>

### **2.3.4 - Setting and Getting xConfigurations**

!!! Abstract

   Throughout section 2.2.4, you'll continue to learn how to format XML payloads as you work to set new xConfigurations against the codec

   Unlike xCommands, you can then pull back the value of xConfigurations using a Get Request.

   The techniques outlined here will correspond to the methods needed for Getting xStatus Values in section 2.3.5

???+ lesson "Lesson: Set a new xConfiguration Value"

    - **xAPI:** xConfiguration Audio DefaultVolume

    - **Task:** Structure the xAPI command above into an XML format then place this into the Body of the ==Set a new xConfiguration Value== request in your Postman collection. Set DefaultVolume to `75`

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-4_Set-xConfig_Single-Success.png){ width="700", align=right }

        ``` { .xml }
        <Configuration>
          <Audio>
            <DefaultVolume>75</DefaultVolume>
          </Audio>
        </Configuration>
        ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure>


??? lesson "Lesson: Set multiple xConfiguration Values in a single Request"

    - **xAPI(s):** 
        - xConfiguration Audio DefaultVolume
        - xConfiguration SystemUnit Name

    - **Task:** 
        - We'll set the DefaultVolume back to 50, which will be preloaded into the Postman collection
        - Your task is to structure the XML for {++xConfiguration SystemUnit Name++} and place it as the next xCommand in the XML structure given. Set the Name to `Codec_X` where X is the # of your workstation pod or your name

    ??? success "View properly formatted XML and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-4_Set-xConfig_Multi-Success.png){ width="500", align=right }

        === "SystemUnit Name XML"

            ``` { .xml }
            <Configuration>
              <SystemUnit>
                <Name>Pod_X</Name>
              </SystemUnit>
            </Configuration>
            ```
        
        === "Full XML Body"

            ``` { .xml }
            <Configuration>
              <Audio>
                <DefaultVolume>50</DefaultVolume>
              </Audio>
              <!-- SystemUnit Name Should Start Here -->
              <SystemUnit>
                <Name>Pod_X</Name>
              </SystemUnit>
              <!-- SystemUnit Name Should End Here -->
            </Configuration>
            ```

    ??? failure "View Failed Response"

        If you have a failed response, review the errors as it will point out how to resolve your particular issue in your XML payload and try again

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-3_Execute-xCommand-AllFailure.png){ width="600" }
        </figure>

??? lesson "Lesson: Getting an xConfiguration Value"

    !!! info

        Up until this point, you've been making Post requests with an xAPI path provided as a part of the Post body written in XML format

        Whereas, we're pivoting to a Get rest, the format of the request changes. We no longer need a body, but we need to define the xAPI path as apart of the URL under it's location tag

        Refer to section 2.3.2 for a refresher on this syntax

    - **xAPI:** xConfiguration Audio DefaultVolume

    - Structure the xAPI command above into the URL under the ==Getting an xConfiguration Value== request in your Postman collection. This path should rest behind the ==?location== and separated by a `/`

    ??? success "View properly formatted URL and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig_Single-Success.png){ width="500", align=right }

        === "Audio DefaultVolume URL"

            https://{{device_ipAddress}}/getxml?location\===Configuration/Audio/DefaultVolume==
        
    ??? failure "View Failed Response"

        Something to note on xConfig Get Requests, is you'll still get a 200 OK if your auth and IP are correct when talking to the Codec

        But a lack of response information can tell you that you may have a fault in your xAPI path in the URL

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-WrongPath.png){ width="600" }
          <figcaption>What to expect for a bad path</figcaption>
        </figure>

         <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-MissingPath.png){ width="600" }
          <figcaption>What to expect for a missing path</figcaption>
        </figure>

??? lesson "Lesson: Get multiple xConfiguration Values under a Common Node"

    !!! info

        You can pull more information if you move up to a Common Node

        By dropping `DefaultVolume` from xConfiguration Audio {--DefaultVolume--} we can grab all the Configuration Setting under the Audio Branch from the codec

    - **xAPI:** xConfiguration Audio

    - Structure the xAPI command above into the URL under the ==Getting multiple xConfiguration Values under a Common Node== request in your Postman collection.

    ??? success "View properly formatted URL and Successful Response"

        === "Audio DefaultVolume URL"

            https://{{device_ipAddress}}/getxml?location\===Configuration/Audio==

        ??? info "View Successful HTTP Response"

            ``` { .xml }
            <?xml version="1.0"?>
            <Configuration product="Cisco Codec" version="ce11.20.1.7.913a6c7c769" apiVersion="4">
              <Audio>
                <DefaultVolume valueSpaceRef="/Valuespace/INT_0_100">75</DefaultVolume>
                <Ethernet>
                  <Encryption valueSpaceRef="/Valuespace/TTPAR_RequiredOptional">Required</Encryption>
                  <SAPDiscovery>
                    <Address valueSpaceRef="/Valuespace/STR_0_64_IPv4AdminMcast">239.255.255.255</Address>
                    <Mode valueSpaceRef="/Valuespace/TTPAR_OnOff">Off</Mode>
                  </SAPDiscovery>
                </Ethernet>
                <!-- And the List Goes On... -->
              </Audio>
            </Configuration>
            ```
        
    ??? failure "View Failed Response"

        Something to note on xConfig Get Requests, is you'll still get a 200 OK if your auth and IP are correct when talking to the Codec

        But a lack of response information can tell you that you may have a fault in your xAPI path in the URL

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-WrongPath.png){ width="600" }
          <figcaption>What to expect for a bad path</figcaption>
        </figure>

         <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-MissingPath.png){ width="600" }
          <figcaption>What to expect for a missing path</figcaption>
        </figure>

??? curious  ":thinking: What about Subscribing to an xConfiguration?"
    
    Subscriptions via HTTP are possible, but require a process outside of using HTTP Post/Get commands. We'll need to leverage the HTTPFeedback feature of the codec and a tool that can receive a WebHook

    So we'll save HTTPFeedback for the end of section 2.3 and handle all HTTP based subscriptions there

### **2.3.5 - Getting xStatuses**

???+ lesson "Lesson: Getting an xStatus Value"

    - **xAPI:** xStatus Audio Volume

    - Structure the xAPI command above into the URL under the ==Getting an xStatus== request in your Postman collection.

    ??? success "View properly formatted URL and Successful Response"

        ![Successful HTTP Response](./assets/wx1_1451_part_2/2-3-5_Get-xStatus_Single-Success.png){ width="500", align=right }

        === "Audio DefaultVolume URL"

            https://{{device_ipAddress}}/getxml?location\===Status/Audio/Volume==
        
    ??? failure "View Failed Response"

        Something to note on xStatus Get Requests, is you'll still get a 200 OK if your auth and IP are correct when talking to the Codec

        But a lack of response information can tell you that you may have a fault in your xAPI path in the URL

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-WrongPath.png){ width="600" }
          <figcaption>What to expect for a bad path</figcaption>
        </figure>

         <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-MissingPath.png){ width="600" }
          <figcaption>What to expect for a missing path</figcaption>
        </figure>

??? lesson "Lesson: Get multiple xStatus Values under a Common Node"

    - **xAPI:** xStatus Audio

    - Structure the xAPI command above into the URL under the ==Getting multiple xStatus Values under a Common Node== request in your Postman collection.

    ??? success "View properly formatted URL and Successful Response"

        === "Audio DefaultVolume URL"

            https://{{device_ipAddress}}/getxml?location\===Status/Audio==

        ??? info "View Successful HTTP Response"

            ``` { .xml }
            <?xml version="1.0"?>
            <Status product="Cisco Codec" version="ce11.20.1.7.913a6c7c769" apiVersion="4">
              <Audio>
                <Devices>
                  <Bluetooth>
                    <ActiveProfile>None</ActiveProfile>
                  </Bluetooth>
                  <HandsetUSB>
                    <ConnectionStatus>NotConnected</ConnectionStatus>
                    <Cradle>OnHook</Cradle>
                  </HandsetUSB>
                  <HeadsetUSB>
                    <ConnectionStatus>NotConnected</ConnectionStatus>
                    <Description></Description>
                    <Manufacturer></Manufacturer>
                  <!-- And the List Goes On... -->
              </Audio>
            </Status>
            ```
        
    ??? failure "View Failed Response"

        Something to note on xStatus Get Requests, is you'll still get a 200 OK if your auth and IP are correct when talking to the Codec

        But a lack of response information can tell you that you may have a fault in your xAPI path in the URL

        <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-WrongPath.png){ width="600" }
          <figcaption>What to expect for a bad path</figcaption>
        </figure>

         <figure markdown>
          ![Failed HTTP Response](./assets/wx1_1451_part_2/2-3-4_Get-xConfig-MissingPath.png){ width="600" }
          <figcaption>What to expect for a missing path</figcaption>
        </figure>

### **2.3.6 - Using WebHooks to subscribe to xConfigurations, xStatuses and xEvents**

!!! important

    Your codec has a limit of 4 HTTPFeedback Slots with up to 15 xAPI paths expressions in the same command

    ??? tip  "xCommand References for Section: 2.3.6"

        <div class="grid cards" markdown>

        -   <i class="fa-solid fa-terminal"> </i> __xCommand HttpFeedback Register__

            ---

            Register the device to an HTTP(S) server to return XML feedback over HTTP(S) to specific URLs.

            ---

            Parameters:

              <table>
                <tr>
                    <td>ServerUrl ==[Required]== </td>
                    <td>FeedbackSlot ==[Required]== </td>
                </tr>
                <tr>
                    <td>Expression</td>
                    <td>Format</td>
                </tr>
              </table>

            <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.HttpFeedback.Register" target="_blank">
              Reference for <strong>xCommand HttpFeedback Register</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>

        -   <i class="fa-solid fa-terminal"></i> __xCommand HttpFeedback Deregister__

            ---

            Deregister the HTTP feedback over HTTP(S).

            ---

            Parameters:

              <table>
                <tr>
                    <td>FeedbackSlot ==[Required]== </td>
                </tr>
              </table>

            <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.HttpFeedback.Deregister" target="_blank">
              Reference for <strong>xCommand HttpFeedback Deregister</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>

        -   <i class="fa-solid fa-terminal"></i> __xCommand HttpFeedback Enable__

            ---

            Re-enables a previously registered feedback slot after it has failed and become deactivated.

            ---

            Parameters:

              <table>
                <tr>
                    <td>FeedbackSlot ==[Required]== </td>
                </tr>
              </table>

            <a class="md-button md-button--primary" href="https://roomos.cisco.com/xapi/Command.HttpFeedback.Enable" target="_blank">
              Reference for <strong>xCommand HttpFeedback Enable</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>

        </div>

???+ gif "Locate and Configure your Unique URL from Webhook.Site"

    - Go to <a href="https://webhook.site" target="_blank">https://webhook.site</a>
    - Copy your Unique URL
    - Open Postman
        - Click on the ==WX1-Lab:1451-HTTP-Postman-Collection== root folder
        - Select Variables
        - Pase your unique URL into `Initial Value` and `Current Value` fields for ==WebhookSite_Unique_Url==
        - Select Save (or one of the keyboard shortcuts for your computer)
            - ++control+s++ for Windows
            - ++command+s++ for Mac

    <figure markdown>
      ![Locate and Configure your Unique URL from Webhook.Site](./assets/wx1_1451_part_2/2-3-6_ConfigureWebHookPostman.gif){ width="600" }
    </figure>


!!! info

    For all Webhook Examples below, we'll need to register HTTPFeedback slot by first running

    `xCommand HTTPFeedback Register`

    These have been preformatted for you in the Postman collection

    ??? question "View Example WebHook.site output"

        <figure markdown>
          ![Webhook.Site Output Example](./assets/wx1_1451_part_2/2-3-6_WebHookSite_Output.png){ width="600" }
        </figure>

??? lesson "Lesson: Subscribe to the full xConfiguration Branch"

    - **Task:**
        - In your Postman Collection under HTTP > Section: 2.3.6
        - Select the ==Subscribe to the full xConfiguration Branch== request
        - View how the body is Structured in the XML body
        - Select Send
        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xConfigurations Page, press any of the buttons on this page
            - Observe your {++Webhook.Site Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Webhook.Site Terminal++}
                - ==Optional==: Press those buttons and switches a few times to see more changes come in


??? lesson "Lesson: Subscribe to the full xStatus Branch"

    - **Task:**
        - In your Postman Collection under HTTP > Section: 2.3.6
        - Select the ==Subscribe to the full xStatus Branch== request
        - View how the body is Structured in the XML body
        - Then select Send and Monitor the output on the Webhook.Site terminal
            - Your device will forward an event in the status branch soon
        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xStatuses Page, press any of the buttons on this page
            - Observe your {++Webhook.Site Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Webhook.Site Terminal++}

??? lesson "Lesson: Subscribe to the full xEvent Branch"

    - **Task:**
        - In your Postman Collection under HTTP > Section: 2.3.6
        - Select the ==Subscribe to the full xEvent Branch== request
        - View how the body is Structured in the XML body
        - Then select Send and Monitor the output on the Webhook.Site terminal
            - Your device will forward an event in the event branch soon
        - Press the `Subscription Assistant Button` on your Touch Interface
            - Under the xEvents Page, press any of the buttons on this page
            - Observe your {++Webhook.Site Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Webhook.Site Terminal++}

??? lesson "Lesson: Subscribe to Specific Expressions on any Branch"

    - **Task:**
        - In your Postman Collection under HTTP > Section: 2.3.6
        - Select the ==Subscribe to Specific Expressions on any Branch== request
        - View how the body is Structured in the XML body
            - Take Note, we've changed our Expression Parameter
            - Rather than subscribing to All States, we instead narrow down what we're interested in
            - For each expression we want to listen too, we will declare a new Expression Parameter
            - We can have up to 15 Expressions defined in a single feedback slot
        - Then select Send and Monitor the output on the Webhook.Site terminal
            - You will need to interact with the system Volume and press the MultiLine Command [Section 2.3.3] Panel to see events pour into the WebHook.site terminal
        - Press the `Subscription Assistant Button` on your Touch Interface
            - Clicking on the `Subscription Assistant Button` will fire a Panel Event
            - Under the xStatuses, move the ==Adjust Volume== slider to generate events
                - Other buttons under xStatus won't take any effect
            - Under the xEvents Page, press any of the buttons on this page
            - Observe your {++Webhook.Site Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Webhook.Site Terminal++}

### **2.3.7 - Section 2.3 Cleanup**

!!! important

    - Press the `Subscription Assistant Button` on your Touch Interface
    - Under the ==Section Cleanup== Page, select the ==Run Section Cleanup?== button
    - Select ==Yes, Run the Cleanup Script==

    <figure markdown="span">
      ![Section cleanup](./assets/general/SubscriptionAssitantMacro-ConfirmCleanup.png){ width="400" }
      <figcaption>Section Cleanup Confirmation</figcaption>
    </figure>

    This will reverse the changes we've made to the endpoint, and leave us ready for the next section


    ??? question "You can run the cleanup via the terminal as well"

        Copy the contents below into your terminal window and run them all at once

        ```shell title="Type into terminal and press Enter"
        xConfig Audio DefaultVolume: 50
        xCommand UserInterface Extensions Panel Remove PanelId: wx1_lab_multilineCommand
        xCommand Video Selfview Set Mode: Off FullscreenMode: Off
        xCommand Video Input SetMainVideoSource ConnectorId: 1
        xCommand Audio Volume SetToDefault Device: Internal
        xCommand HTTPFeedBack Deregister FeedbackSlot: 1 FeedbackSlot: 2 FeedbackSlot: 3 FeedbackSlot: 4
        ```

- - -
- - -

## <u>**Section 2.4: Accessing the xAPI via WebSockets**</u>

??? tool "Under Construction - Feel Free to look, just not ready"

    !!! Abstract

        WebSockets offer a way to enable real time communication over HTTP/HTTPS but allows for persistent communication, unlike an HTTP Post or Get request which briefly opens a socket and closes

        It's akin to our SSH, but differs in format, execution, network port and protocol for communication

        <a class="md-button md-button--primary" href="https://www.cisco.com/c/dam/en/us/td/docs/telepresence/endpoint/api/collaboration-endpoint-software-api-transport.pdf" target="_blank" >
              Learn more about our <strong>WebSocket xAPI</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>

    !!! important "Section Requirements"

        Unfortunately, we can't provide a WebSocket collection in Postman, as that not a collection type we can export

        However, you can still use Postman to setup WebSocket requests in Postman

        {++For the interest of time, please skip section 2.4++}, should you have time, please due follow along, we'll briefly cover how to make a WebSocket Request in Postman, just know you'll need to

        - Instantiate a Postman Collection
        - Assign Variables to your Collection
        - Structure each Request in Full



    ### **2.4.1 - WebSocket Authentication and Format**

    !!! blank ""

        <h4>URL Structure</h4>

        The request URL for your Codec will change depending on whether you're making a WebSocket or Secure WebSocket Connection

        !!! example ""

            === "WebSocket [ws]"

                ==ws==://[YOUR_DEVICE_IP]/ws

            === "Secure WebSocket [wss]"

                ==wss==://[YOUR_DEVICE_IP]/ws


        - - -

        <h4>Authentication Format</h4>

        The Codec uses basic authentication to accept incoming requests. This authentication is formatted in base64 with it's username and password concatenated as a single string separated by a colon ==:==

        !!! example "Click on the tabs below to see how an example Username and Password transitions to base64"

            === "Base Credentials >"

                **Username**: ==admin==
                <br>
                **Password**: ==admin1234==

            === "Decoded String >"

                ==admin:admin1234==
                <br>
                <br>

            === "Base64 Encoded String >"

                ==YWRtaW46YWRtaW4xMjM0==
                <br>
                <br>

            === "Authorization Request Header"

                "Authorization": "Basic ==YWRtaW46YWRtaW4xMjM0=="
                <br>
                <br>

            === "Sec-WebSocket-Protocol Request Header"

                "Sec-WebSocket-Protocol": "auth-==YWRtaW46YWRtaW4xMjM0=="
                <br>
                <br>

        - - -

        <h4>Request Headers</h4>

        Your WebSockets will use either the `Authorization` or `Sec-WebSocket-Protocol` as it's sole header

        <table>
            <thead>
                <tr>
                    <th>Key</th>
                    <th>Value</th>
                    <th>Use Case</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="white-space: nowrap;"><code>Authorization</code></td>
                    <td style="white-space: nowrap;"><code>Basic [YOUR_BASE64_ENCODED_AUTH]</code></td>
                    <td>Focused on authentication, ensuring the client is allowed to connect.</td>
                </tr>
                <tr>
                    <td style="white-space: nowrap;"><code>Sec-WebSocket-Protocol</code></td>
                    <td style="white-space: nowrap;"><code>auth-[YOUR_BASE64_ENCODED_AUTH]</code></td>
                    <td>Focused on defining the protocol for the communication after the connection is established. This method is required for browser-based clients.</td>
                </tr>
            </tbody>
        </table>


        - - -

        <h4>Body Format</h4>

        All WebSocket messages are formatted in JSON. They require the following Objects to be successful

        | Object  | Value          | Description                                            | IsRequired |
        |---------|----------------|--------------------------------------------------------|------------|
        | jsonrpc | "2.0"          | The JSON RPC Version                                   | Yes        |
        | id      | String/Integer | An identifier of this request. The server must reply with the same value in the Response object.   | Yes        |
        | method  | String         | A String containing the name of the method to be invoked. For example "xGet", "xQuery", "xCommand/[Path]" or "xSet". | Yes        |
        | params  | Nest Objects   | An Object that holds the parameter values to be used during the invocation of the method. The Object must have member names that match the names that the server expects.     | Yes        |

        !!! important "Review Websocket Message Structure Examples and Responses"

            === "xCommand/[Path]"

                xCommand Paths follow the ==xCommand== method in the `method` object, separated by forward slash ( ==/== )

                Parameters for the xCommand are defined as individual objects under the `params` object written in JSON format

                === "Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 111,
                      "method": "xCommand/Dial",
                      "params": {
                        "Number": "bobby@example.com",
                        "Protocol": "Spark"
                      }
                    }
                    ```
                
                === "Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 111,
                      "result": { // <-- This is the Value for your request
                      "CallId": 2,
                      "ConferenceId": 1
                      }
                    }
                    ```

                === "Error Response <i class="fa-solid fa-triangle-exclamation"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 111,
                      "error": {
                        "code": 1,
                          "data": {
                          "Cause": 21
                        },
                        "message": "Not paired with isdn link"
                      }
                    }
                    ```

            === "xGet [xStatus/xConfiguration]"

                `xStatus` and `xConfiguration` branches can make use of the ==xGet== method. Unlike Commands, the xAPI path is provided in the params object under a Path object and is structured as an Array

                === "Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 102,
                      "method": "xGet",
                      "params": {
                        "Path": ["Configuration", "SystemUnit", "Name"]
                      }
                    }   
                    ```
                
                === "Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 102,
                      "result": "my-device" // <-- This is the Value for your request
                    }
                    ```

            === "xQuery [xStatus/xConfiguration]"

                `xStatus` and `xConfiguration` branches can make use of the ==xQuery== method. xQuery is formatted and functions largely like the xGet method

                !!! note "Note the difference between `xQuery` and `xGet`"

                    - The response to xQuery always starts from the top node, i.e. "Status" or "Configuration".
                    - The response to xGet starts relative to the path given in the "Query".
                    - xQuery can also implement Wildcards (`**`) in it's path, which matches zero or more levels in the path.

                === "Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 105,
                      "method": "xQuery",
                      "params": {
                        "Query": ["Status", "**", "DisplayName"] 
                      }
                    }
                    ```
                
                === "Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 105,
                      "result": { // <-- This is the Value for your request
                        "Status": {
                          "SIP": {
                            "CallForward": {
                              "DisplayName": "Room Bar Pro"
                            }
                          },
                          "SystemUnit": {
                            "Software": {
                              "DisplayName": "RoomOS 11.20..."
                            }
                          }
                        }
                      }
                    }
                    ```

            === "xSet [xConfiguration]"

                === "Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 110,
                      "method": "xSet",
                      "params": {
                        "Path": ["Configuration","SystemUnit","Name"],
                        "Value": "My New System Name"
                      }
                    }
                    ```
                
                === "Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 110,
                      "result": true // <-- This is the Value for your request
                    }
                    ```

            === "xFeedback [xStatus/xConfiguration/xEvent]"

                xFeedback, or Subscriptions, have 2 Id objects within the life of it's process. When sending any message, you will assign an `id` and get an initial response containing that same `id`. But when you subscribe, it will contain an additional ==Id== in it's results object which corresponds to this specific subscription. All notifications after the initial response from this subscription will contain the Subscription ==Id== not the initial message `id`. This is important, as you may have multiple or similar subscriptions you may want to instantiate and handle separately as you develop your solution.

                === "Subscribe Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 113, // <-- This is the Message id
                      "method": "xFeedback/Subscribe",
                      "params": {
                        "Query": ["Status", "Video", "Selfview"],
                        "NotifyCurrentValue": true // <-- When true, will respond with additional notifications
                      }
                    }
                    ```
                
                === "Initial Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 113,
                      "result": { // <-- This is the Value for your request
                        "Id": 1 // <-- This is the Subscription Id of the new feedback registration. Use this Subscription Id to map incoming notifications to the initial subscription request, or to unsubscribe from this data
                      }
                    }
                    ```

                === "Notification Response <i class="fa-solid fa-reply"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "method": "xFeedback/Event",
                      "params": {
                        "Id": 1, // <-- This is the Subscription Id of the feedback registration.
                        "Status": {
                          "Video": {
                            "Selfview": {
                              "FullscreenMode": "Off",
                              "Mode": "Off",
                              "OnMonitorRole": "First",
                              "PIPPosition": "CenterRight"
                            }
                          }
                        }
                      }
                    }
                    ```

                === "Unsubscribe Request <i class="fa-solid fa-share"></i>"

                    ```JSON
                    {
                      "jsonrpc": "2.0",
                      "id": 113, // <-- This is the Message id
                      "method": "xFeedback/Subscribe",
                      "params": {
                        "Id": 1, // <-- This is the Subscription Id of the initial feedback registration.
                      }
                    }
                    ```
                
                ??? curious "Subscription Visual Flow"

                    ``` mermaid
                    sequenceDiagram
                        participant My Customization
                        participant Target Codec
                        My Customization<<-->>Target Codec: Websocket Connection
                        Note over My Customization,Target Codec: Register Subscription
                        My Customization->>+Target Codec: xFeedback/Subscribe [Message `id`#58; 101]
                        Target Codec ->> My Customization: Acknowledges Message `id`#58; 101<br>[Provides Subscription `Id`#58; 1]
                        Note over My Customization,Target Codec: Incoming Events
                        Target Codec -->>+ My Customization: <br> Event Payload. Contains [Subscription `Id`#58; 1]
                        Target Codec -->> My Customization: <br> Event Payload. [Subscription `Id`#58; 1]
                        Target Codec -->>- My Customization: <br> ........... [Subscription `Id`#58; 1]
                        Note over My Customization,Target Codec: Deregister Subscription
                        My Customization->>-Target Codec: xFeedback/Unsubscribe <br>Provide Subscription [`Id`#58; 1] NOT Message [`id`#58; 101] as param<br>[Subscription `Id`#58; 1]
                    ```

        - - -

        <h4>Full Websocket examples</h4>

        ??? success "Click to view a Full Example of each written using NodeJs [Javascript Backend]"

            ``` javascript
            const WebSocket = require('ws');

            // Base64 encode your username and password for Basic Auth
            const username = 'admin';
            const password = 'admin1234';
            const ipAddress = 'X.X.X.X';
            const encoded_auth = Buffer.from(`${username}:${password}`).toString('base64')
              .replace(/\+/g, '-')
              .replace(/\//g, '_')
              .replace(/=+/g, '');

            // Define the subprotocol including custom authentication
            const subprotocols = [`auth-${encoded_auth}`];

            // Create a WebSocket connection, requesting the subprotocols
            const socket = new WebSocket(`wss://${ipAddress}/ws`, subprotocols, {
              rejectUnauthorized: false
            });

            socket.on('open', () => {
              console.log('WebSocket established against Codec');

              // Structure your xAPI message to send
              const message = {
                "jsonrpc": "2.0",
                "id": "xStatus SystemUnit Uptime",
                "method": "xGet",
                "params": {
                  "Path": ["Status", "SystemUnit", "Uptime"]
                }
              };

              // Send the JSON message as a string
              socket.send(JSON.stringify(message));
            });

            socket.on('message', (message) => {
              try {
                const data = JSON.parse(message);
                console.log('Parsed response:', data);

                socket.close();
              } catch (error) {
                console.error('Error parsing JSON:', error);
              }
            });

            socket.on('error', (error) => {
              console.error('WebSocket error observed:', error);
              socket.close();
            });

            socket.on('close', (event) => {
              console.log('WebSocket connection closed:', event);
            });
            ```

        ??? success "Click to view a Full Example of each written using the Python websocket-client API"

            ``` Python
            import websocket
            import json
            import base64

            # Base64 encode your username and password for Basic Auth
            username = 'admin'
            password = 'admin1234'
            ip_address = 'X.X.X.X'  # Replace with your actual IP address
            encoded_auth = base64.b64encode(f"{username}:{password}".encode()).decode()
            encoded_auth = encoded_auth.replace('+', '-').replace('/', '_').replace('=', '')

            # Define the subprotocol including custom authentication
            subprotocols = f"auth-{encoded_auth}"

            # Define the WebSocket URL
            ws_url = f"wss://{ip_address}/ws"

            # Define the on_open event
            def on_open(ws):
                print("WebSocket established against Codec")

                # Structure your xAPI message to send
                message = {
                    "jsonrpc": "2.0",
                    "id": "xStatus Systemunit Uptime",
                    "method": "xGet",
                    "params": {
                        "Path": ["Status", "SystemUnit", "Uptime"]
                    }
                }

                # Send the JSON message as a string
                ws.send(json.dumps(message))

            # Define the on_message event
            def on_message(ws, message):
                try:
                    data = json.loads(message)
                    print("Parsed response:", data)

                    # Close the WebSocket after receiving the message
                    ws.close()
                except json.JSONDecodeError as error:
                    print("Error parsing JSON:", error)

            # Define the on_error event
            def on_error(ws, error):
                print("WebSocket error observed:", error)
                ws.close()

            # Define the on_close event
            def on_close(ws, close_status_code, close_msg):
                print("WebSocket connection closed:", close_msg)

            # Create the WebSocket application
            ws = websocket.WebSocketApp(ws_url,
                                        subprotocols=[subprotocols],
                                        on_open=on_open,
                                        on_message=on_message,
                                        on_error=on_error,
                                        on_close=on_close)

            # Allow self-signed certificates
            ws.run_forever(sslopt={"cert_reqs": 0})
            ```

    ### **2.4.2 - Create and Configure Postman Collection**

    ???+ tool "Create New Collection Folder" 

    ??? tool "Create Collection Variables"

    ??? tool "Create New Request"

    ### **2.4.3 - Executing xCommands**

    ???+ lesson "Lesson: Execute an xCommand"

        !!! info inline end "Message Body Location"

            <figure markdown>
              ![Message body location](./assets/wx1_1451_part_2/2-4-3_Execute-xCommand-BodyLocation.png){ width="400" }
            </figure>

        - **xAPI:** xCommand Video Selfview Set

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for xCommands
            - Fill in the `params` object using the following parameters
                - Mode: On
                - FullScreenMode: On
                - OnMonitorRole: First

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? question "Need Help with the Syntax?"

            <a class="md-button md-button--primary" href="../cheatsheet" target="_blank" >
              Open the <strong>Websocket Method and Parameter</strong> Table in the CheatSheet <i class="fa-solid fa-square-up-right"></i>
            </a>

        ??? success "View properly formatted Message and Successful Response"


            === "Message Body `JSON`"

                  ``` { .json }
                  {
                    "jsonrpc": "2.0",
                    "id": "Execute an xCommand",
                    "method": "xCommand/Video/Selfview/Set",
                    "params": {
                      "Mode": "On",
                      "FullScreenMode": "On",
                      "OnMonitorRole":"First"
                    }
                  }
                  ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Execute an xCommand",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "status": "OK"
                  }
                }
                ```

    ??? lesson "Lesson: Execute an xCommand with multiple arguments with the same name"

        In cases where we need to declare multiple arguments of the same name, rather than duplicating and re-running the parameters, we instead leverage an Array in place of the value, containing all values we want to implement under that Parameter

        <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >
          Learn more about <strong>Arrays</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>

        !!! example "Click on the tabs to see how Terminal Syntax relates to WebSocket Syntax"

            === "Terminal Syntax"

                ``` { .shell }
                xParent Child ChildParam_X: 1, ChildParam_X: 2
                ```
                

            === "WebSocket Syntax"

                ``` { .json , title="Body" }
                {
                  "jsonrpc": "2.0",
                  "id": "Example Syntax",
                  "method": "xParent/Child",
                  "params": {
                    "ChildParam_X": [1, 1]
                  }
                }
                ```

        - **xAPI:** xCommand Video Input SetMainVideoSource

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for xCommands
            - Fill in the `params` object using the following parameters, but duplicate the ConnectorId
                - ConnectorId: 1
                - Layout: Equal

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View Successful OSD Output"

            <figure markdown>
              ![Official API Doc](./assets/wx1_1451_part_2/2-2-3_SetMain-2xEqual.png){ width="400" }
            </figure>

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Execute an xCommand with multiple arguments with the same name",
                  "method": "xCommand/Video/Input/SetMainVideoSource",
                  "params": {
                    "ConnectorId": [1, 1],
                    "Layout":"Equal"
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Execute an xCommand with multiple arguments with the same name",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "status": "OK"
                  }
                }
                ```

    ??? lesson "Lesson: Execute an xCommand with a multiline argument"

        !!! info

            Multiline Arguments can be placed into the `params` object as well. This specifically uses a `body` object which will contain your multi-line argument.

            The structure of a Multiline argument should look similar to the following

        !!! example "Click on the tabs to see how Terminal Syntax relates to WebSocket Syntax"

            === "Terminal Syntax"

                ``` { .shell }
                [xParent Child ChildParam_X: SomeValue]
                [Multi Line Content]
                .
                ```
                

            === "WebSocket Syntax"

                ``` { .json , title="Body" }
                {
                  "jsonrpc": "2.0",
                  "id": "Example Syntax",
                  "method": "xParent/Child",
                  "params": {
                    "ChildParam_X": "SomeValue",
                    "body": "Multi Line Content"
                  }
                }
                ```

        !!! note

            Your Selfview may still be open

            Run the following in your terminal window to close selfview

            ``` shell
            xCommand Video Selfview Set Mode: Off
            ```

            ??? challenge "Challenge: Alter `Execute an xCommand` in your WebSocket Postman Collection"

                  Rather than re-open your terminal session, you can go back to `Execute an xCommand` in your WebSocket Postman Collection, and update the `params` object to set the Mode parameter to Off

                  <a class="md-button md-button--primary" href="../challengeAnswers/" target="_blank" >
                    Giving Up? Check out the Challenge Answers Page <i class="fa-solid fa-square-up-right"></i>
                  </a>


        - **xAPI:** xCommand UserInterface Extensions Panel Save

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for xCommands
            - Fill in the `params` object using the following parameters
                - PanelId: wx1_lab_multilineCommand
                - body:
                      ```{ .xml , title="Your &lt;body&gt; Value" }
                      <Extensions>
                        <Panel>
                          <Order>1</Order>
                          <PanelId>wx1_lab_multilineCommand</PanelId>
                          <Location>HomeScreen</Location>
                          <Icon>Info</Icon>
                          <Color>#FF70CF</Color>
                          <Name>MultiLine Command [Section 2.4.3]</Name>
                          <ActivityType>Custom</ActivityType>
                        </Panel>
                      </Extensions>
                      ```

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View Successful OSD Output"

            <figure markdown="span">
              ![OSD Output](./assets/wx1_1451_part_2/2-4-3_xCommand-MultiLineOSD-Success.png){ width="500" }
              <figcaption>What to expect on your OSD on a successful request</figcaption>
            </figure>

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Execute an xCommand with a multiline argument",
                  "method": "xCommand/UserInterface/Extensions/Panel/Save",
                  "params": {
                    "PanelId": "wx1_lab_multilineCommand",
                    "body":"<Extensions> <Panel> <Order>1</Order> <PanelId>wx1_lab_multilineCommand</PanelId> <Location>HomeScreen</Location> <Icon>Info</Icon> <Color>#FFCC00</Color> <Name>MultiLine Command [Section 2.4.3]</Name> <ActivityType>Custom</ActivityType> </Panel> </Extensions>"
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Execute an xCommand with a multiline argument",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "status": "OK"
                  }
                }
                ```

    ??? lesson "Lesson: Execute an xCommand which generates data and responds"

        - **xAPI:** xCommand UserInterface Extensions List

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for xCommands
            - Fill in the `params` object using the following parameters
                - ActivityType: Custom

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Execute an xCommand with a multiline argument",
                  "method": "xCommand/UserInterface/Extensions/List",
                  "params": {
                    "ActivityType": "Custom"
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Execute an xCommand with a multiline argument",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "Extensions": {
                      "Panel": [
                        {
                          "ActivityType": "Custom",
                          "Color": "#FFCC00",
                          "Icon": "Info",
                          "Location": "HomeScreen",
                          "Name": "MultiLine Command [Section 2.4.3]",
                          "Order": 1,
                          "Origin": "local",
                          "PanelId": "wx1_lab_multilineCommand",
                          "Visibility": "Auto",
                          "id": 1
                        }
                      ],
                      "Version": "1.11"
                    },
                    "status": "OK"
                  }
                }
                ```

    ### **2.4.4 - Getting, Setting and Subscribing to xConfigurations**

    ???+ lesson "Lesson: Set a new xConfiguration Value"

        !!! info inline end "Message Body Location"

            <figure markdown>
              ![Message Body Location](./assets/wx1_1451_part_2/2-4-3_Execute-xCommand-BodyLocation.png){ width="400" }
            </figure>

        - **xAPI:** xConfiguration Audio DefaultVolume

        - **Task:** 
        
            - Assign the correct ==Method== to the `method` object for setting xConfigurations
            - Within the `params` object, fill in the `Path` object using the xAPI above and place it's new Configuration Value in the `Value` object

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? question "Need Help with the Syntax?"

            <a class="md-button md-button--primary" href="../cheatsheet" target="_blank" >
              Open the <strong>Websocket Method and Parameter</strong> Table in the CheatSheet <i class="fa-solid fa-square-up-right"></i>
            </a>

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Set a new xConfiguration Value",
                  "method": "xSet",
                  "params": {
                    "Path": ["Configuration", "Audio", "DefaultVolume"],
                    "Value": 75
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Set a new xConfiguration Value",
                  "jsonrpc": "2.0",
                  "result": true // <-- This is the Value for your request
                }
                ```

    ??? lesson "Lesson: Getting an xConfiguration Value"

        - **xAPI:** xConfiguration Audio DefaultVolume

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for setting xConfigurations
            - Within the `params` object, fill in the `Path` object using the xAPI above

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Getting an xConfiguration Value",
                  "method": "xGet",
                  "params": {
                    "Path": ["Configuration", "Audio", "DefaultVolume"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Getting an xConfiguration Value",
                  "jsonrpc": "2.0",
                  "result": 75 // <-- This is the Value for your request
                }
                ```

    ??? lesson "Lesson: Get multiple xConfiguration Values under a Common Node"

        - **xAPI:** xConfiguration Audio

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for setting xConfigurations
            - Within the `params` object, fill in the `Path` object using the xAPI above

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Get multiple xConfiguration Values under a Common Node",
                  "method": "xGet",
                  "params": {
                    "Path": ["Configuration", "Audio"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Get multiple xConfiguration Values under a Common Node",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "DefaultVolume": 75,
                    "Input": {
                      "Microphone": [
                        {
                          "Mode": "On",
                          "Zone": 1,
                          "id": 1
                        },
                        {
                          "EchoControl": {
                            "Mode": "On",
                            "NoiseReduction": "On"
                          },
                          "Gain": 20,
                          "Mode": "On",
                          "Zone": 1,
                          "id": 2
                        },
                        {
                          "EchoControl": {
                            "Mode": "On",
                            "NoiseReduction": "On"
                          },
                          "Gain": 20,
                          "Mode": "On",
                          "Zone": 1,
                          "id": 3
                        }
                      ],
                      "USBC": [
                        {
                          "Gain": -5,
                          "Mode": "On",
                          "VideoAssociation": {
                            "MuteOnInactiveVideo": "On"
                          },
                          "id": 1
                        }
                      ],
                      "USBMicrophone": [
                        {
                          "EchoControl": {
                            "Mode": "On"
                          },
                          "Gain": 5,
                          "Zone": 1,
                          "id": 1
                        }
                      ]
                    },
                    "Microphones": {
                      "BeamMix": {
                        "Inputs": "Auto"
                      },
                      "Mute": {
                        "Enabled": "True"
                      },
                      "NearTalkerSector": {
                        "Mode": "Off"
                      },
                      "NoiseRemoval": {
                        "Mode": "Enabled"
                      },
                      "PhantomPower": "On",
                      "UsbPassthrough": {
                        "MuteButton": "Active"
                      },
                      "VoiceActivityDetector": {
                        "Mode": "Off"
                      }
                    },
                    "Output": {
                      "InternalSpeaker": {
                        "Mode": "On"
                      },
                      "Line": [
                        {
                          "Mode": "On",
                          "OutputType": "Loudspeaker",
                          "id": 1
                        }
                      ]
                    },
                    "Panning": {
                      "Mode": "Auto"
                    },
                    "Placement": "Wallmount",
                    "SoundsAndAlerts": {
                      "RingTone": "Sunrise",
                      "RingVolume": 50
                    },
                  }
                }
                ```

    ??? lesson "Lesson: Query an xConfiguration Value"

        - **xAPI:** xConfiguration SystemUnit Name

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for setting xConfigurations
            - Within the `params` object, fill in the `Query` object using the xAPI above

        - Once the Message body has been updated
            - ==Save== the request
            - Select ==Connect== to establish the WebSocket connection to the Codec
            - select ==Send== and review the Postman Terminal's repsonse
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Query an xConfiguration Value",
                  "method": "xQuery",
                  "params": {
                    "Query": ["Configuration", "SystemUnit", "Name"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Query an xConfiguration Value",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "Configuration": {
                      "SystemUnit": {
                        "Name": "Room Bar Pro"
                      }
                    }
                  }
                }
                ```

    ??? lesson "Lesson: Query an xConfiguration Value using a WildCard"

        !!! info

            When forming an xQuery Message, you can use `**` as a wildcard value within the path of the xAPI. This will return any matching nodes following `**` similar to the role of `//` in an SSH session.

        - **xAPI:** xConfiguration ** Name

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for setting xConfigurations
            - Within the `params` object, fill in the `Query` object using the xAPI above. Be sure to treat `**` as a separate entity in the xAPI Path.

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
            
            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Query an xConfiguration Value using a WildCard",
                  "method": "xQuery",
                  "params": {
                    "Query": ["Configuration", "**", "Name"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Query an xConfiguration Value using a WildCard",
                  "jsonrpc": "2.0",
                  "result": { // <-- This is the Value for your request
                    "Configuration": {
                      "FacilityService": {
                        "Service": [
                          {
                            "Name": "Live Support",
                            "id": 1
                          },
                          {
                            "Name": "",
                            "id": 2
                          },
                          {
                            "Name": "",
                            "id": 3
                          },
                          {
                            "Name": "",
                            "id": 4
                          },
                          {
                            "Name": "",
                            "id": 5
                          }
                        ]
                      },
                      "Network": [
                        {
                          "DNS": {
                            "Domain": {
                              "Name": ""
                            }
                          },
                          "id": 1
                        }
                      ],
                      "SystemUnit": {
                        "Name": "Room Bar Pro"
                      },
                      "UserInterface": {
                        "Theme": {
                          "Name": "Night"
                        }
                      },
                      "Video": {
                        "Input": {
                          "Connector": [
                            {
                              "Name": "Camera",
                              "id": 1
                            },
                            {
                              "Name": "PC (HDMI)",
                              "id": 2
                            },
                            {
                              "Name": "PC (USB-C)",
                              "id": 3
                            }
                          ]
                        }
                      }
                    }
                  }
                }
                ```

    ??? lesson "Lesson: Subscribe and Unsubscribe to an xConfiguration"

        - **xAPI:** xConfiguration Audio DefaultVolume

        - **Task:** 

            - Subscribe

                - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xConfiguration
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                    - Under the xConfigurations Page, move the Slider labeled ==Audio DefaultVolume== to a new position and release
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - ==Optional==: Move the slider a few more times to see more changes come in
              
              - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xConfiguration
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xConfigurations Page, move the Slider labeled ==Audio DefaultVolume== to a new position and release
                      - Observe your {++Postman Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Postman Terminal++}
                          - ==Optional==: Move the slider a few more times to see more changes come in

            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

            ??? success "View properly formatted Message"

                === "Subscribe Message body"

                    ``` { .json }
                    {
                      "jsonrpc": "2.0",
                      "id": "Subscribing to an xConfiguration",
                      "method": "xFeedback/Subscribe",
                      "params": {
                        "Query": ["Configuration","Audio","DefaultVolume"],
                        "NotifyCurrentValue": true
                      }
                    }
                    ```

                === "Unsubscribe Message Body"

                    ``` { .json , .no-copy }
                    {
                      "jsonrpc": "2.0",
                      "id": "Unsubscribing to an xConfiguration",
                      "method": "xFeedback/Unsubscribe",
                      "params": {
                        "Id": 1 //<-- NOTE: You're Id may differ
                      }
                    }
                    ```

    ??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xConfigurations under a Common Node"

        - **xAPI:** xConfiguration Airplay

        - **Task:** 
        
            - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xConfiguration
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                    - Under the xConfigurations Page, press the toggles and buttons in the ==Airplay== row
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - ==Optional==: Move the slider a few more times to see more changes come in
              
              - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xConfiguration
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xConfigurations Page, press the toggles and buttons in the ==Airplay== row
                      - Observe your {++Postman Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Postman Terminal++}
                          - ==Optional==: Move the slider a few more times to see more changes come in
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Messages"

            === "Subscribe Message body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Subscribe to Multiple xConfigurations under a Common Node",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Query": ["Configuration","Video","Input","Airplay"],
                    "NotifyCurrentValue": true
                  }
                }
                ```

            === "Unsubscribe Message Body"

                ``` { .json , .no-copy }
                {
                  "jsonrpc": "2.0",
                  "id": "Unsubscribing to an xConfiguration",
                  "method": "xFeedback/Unsubscribe",
                  "params": {
                    "Id": 1 //<-- NOTE: You're Id may differ
                  }
                }
                ```

    ### **2.4.5 - Getting and Subscribing to xStatuses**

    ???+ lesson "Lesson: Getting an xStatus Value"

        !!! info inline end "Message body location"

            <figure markdown>
              ![Message body location](./assets/wx1_1451_part_2/2-4-3_Execute-xCommand-BodyLocation.png){ width="400" }
            </figure>

        - **xAPI:** xStatus Audio Volume

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for getting an xStatus
            - Within the `params` object, fill in the `Path` object using the xAPI above

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
            
            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? question "Need Help with the Syntax?"

            <a class="md-button md-button--primary" href="../cheatsheet" target="_blank" >
              Open the <strong>Websocket Method and Parameter</strong> Table in the CheatSheet <i class="fa-solid fa-square-up-right"></i>
            </a>

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Getting an xStatus Value",
                  "method": "xGet",
                  "params": {
                    "Path": ["Status", "Audio", "Volume"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Getting an xStatus Value",
                  "jsonrpc": "2.0",
                  "result": 50 // <-- This is the Value for your request
                }
                ```

    ??? lesson "Lesson: Get multiple xStatuses Values under a Common Node"

        - **xAPI:** xStatus Audio

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for getting an xStatus
            - Within the `params` object, fill in the `Path` object using the xAPI above

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
            
            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Get multiple xStatuses Values under a Common Node",
                  "method": "xGet",
                  "params": {
                    "Path": ["Status", "Audio"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Get multiple xStatuses Values under a Common Node",
                  "jsonrpc": "2.0",
                  "result": {
                    "Devices": {
                      "Bluetooth": {
                        "ActiveProfile": "None"
                      },
                      "HandsetUSB": {
                        "ConnectionStatus": "NotConnected",
                        "Cradle": "OnHook"
                      },
                      "HeadsetUSB": {
                        "ConnectionStatus": "NotConnected",
                        "Description": "",
                        "Manufacturer": ""
                      }
                    },
                    "Input": {
                      "Connectors": {
                        "HDMI": [
                          {
                            "Mute": "On",
                            "id": 1
                          }
                        ],
                        "Microphone": [
                          {
                            "ConnectionStatus": "Connected",
                            "id": 1
                          },
                          {
                            "ConnectionStatus": "NotConnected",
                            "id": 2
                          },
                          {
                            "ConnectionStatus": "NotConnected",
                            "id": 3
                          }
                        ],
                        "USBC": [
                          {
                            "Mute": "On",
                            "id": 1
                          }
                        ]
                      }
                    },
                    "Microphones": {
                      "MusicMode": "Off",
                      "Mute": "Off",
                      "NoiseRemoval": "On",
                      "VoiceActivityDetector": {
                        "Activity": "False"
                      }
                    },
                    "Output": {
                      "Connectors": {
                        "HDMI": [
                          {
                            "Mode": "DelayMeasurement",
                            "id": 1
                          }
                        ],
                        "InternalSpeaker": [
                          {
                            "DelayMs": 0,
                            "id": 1
                          }
                        ],
                        "Line": [
                          {
                            "ConnectionStatus": "NotConnected",
                            "DelayMs": 0,
                            "id": 1
                          }
                        ]
                      },
                      "MeasuredHdmiArcDelay": 0,
                      "MeasuredHdmiDelay": 0,
                      "ReportedHdmiCecDelay": 0
                    },
                    "SelectedDevice": "Internal",
                    "Ultrasound": {
                      "Volume": 70
                    },
                    "Volume": 50,
                    "VolumeHandsetUsb": 50,
                    "VolumeHeadsetBluetooth": 50,
                    "VolumeHeadsetUsb": 50,
                    "VolumeInternal": 50,
                    "VolumeMute": "Off"
                  }
                }
                            ```

    ??? lesson "Lesson: Query an xStatus Value"

        - **xAPI:** xStatus Video Input Airplay Status

        - **Task:** 
            - Assign the correct ==Method== to the `method` object for querying an xStatus
            - Within the `params` object, fill in the `Query` object using the xAPI above

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
            
            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Query an xStatus Value",
                  "method": "xQuery",
                  "params": {
                    "Query": ["Status", "Video", "Input", "Airplay", "Status"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Query an xStatus Value",
                  "jsonrpc": "2.0",
                  "result": {
                    "Status": {
                      "Video": {
                        "Input": {
                          "AirPlay": {
                            "Status": "Active"
                          }
                        }
                      }
                    }
                  }
                }
                ```

    ??? lesson "Lesson: Query an xStatus Value using a WildCard"

        - **xAPI:** xStatus ** Temperature

        - **Task:** 

            - Assign the correct ==Method== to the `method` object for getting an xStatus
            - Within the `params` object, fill in the `Query` object using the xAPI above. Be sure to treat `**` as a separate entity in the xAPI Path.

            - Once the Message body has been updated
                - ==Save== the request
                - Select ==Connect== to establish the WebSocket connection to the Codec
                - select ==Send== and review the Postman Terminal's repsonse
            
            - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Message and Successful Response"

            === "Message Body `JSON`"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Query an xStatus Value using a WildCard",
                  "method": "xQuery",
                  "params": {
                    "Query": ["Status", "**", "Temperature"]
                  }
                }
                ```

            === "Response Body"

                ``` { .json , .no-copy }
                {
                  "id": "Query an xStatus Value using a WildCard",
                  "jsonrpc": "2.0",
                  "result": {
                    "Status": {
                      "SystemUnit": {
                        "Hardware": {
                          "Monitoring": {
                            "Temperature": {
                              "Status": "Normal"
                            }
                          }
                        }
                      },
                      "Video": {
                        "Output": {
                          "Monitor": [
                            {
                              "Temperature": "Normal",
                              "id": 1
                            }
                          ]
                        }
                      }
                    }
                  }
                }
                ```

    ??? lesson "Lesson: Subscribe and Unsubscribe to an xStatus"

        - **xAPI:** xStatus Audio Volume

        - **Task:** 
        
            - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xStatus
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                - Under the xStatuses Page, move the Slider labeled ==Adjust Volume,== to a new position and release
                    - Alternatively, you can adjust the volume with the Codec's native volume control buttons
                - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                    - ==Optional==: Move the slider a few more times to see more changes come in
              
              - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xStatus
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xStatuses Page, move the Slider labeled ==Adjust Volume,== to a new position and release
                          - Alternatively, you can adjust the volume with the Codec's native volume control buttons
                      - Observe your {++Postman Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Postman Terminal++}
                          - ==Optional==: Move the slider a few more times to see more changes come in
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Messages"

            === "Subscribe Message body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Subscribe to an xStatus",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Query": ["Status", "Audio", "Volume"],
                    "NotifyCurrentValue": true
                  }
                }
                ```

            === "Unsubscribe Message Body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Unsubscribe to an xStatus",
                  "method": "xFeedback/Unsubscribe",
                  "params": {
                    "Id": 1 //<-- NOTE: You're Id may differ
                  }
                }
                ```
            
        ??? gif "View Subscription Assistant"
                    
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

    ??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xStatuses under a Common Node"

        - **xAPI:** xStatus Cameras Camera [N] Position

        - **Task:**
            
            - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xStatus
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                    - Under the xStatuses Page, click the button in the ==Camera Control Wheel== row
                        - Alternatively, you can adjust your cameras position through the native camera control interface
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - ==Optional==: Continue pressing buttons to see more changes come in

            - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xStatus
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xStatuses Page, click the button in the ==Camera Control Wheel== row
                          - Alternatively, you can adjust your cameras position through the native camera control interface
                      - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                          - ==Optional==: Continue pressing buttons to see more changes come in
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Messages"

            === "Subscribe Message body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Subscribe to Multiple xStatuses under a Common Node",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Query": ["Status", "Cameras", "Camera", "Position"],
                    "NotifyCurrentValue": true
                  }
                }
                ```

            === "Unsubscribe Message Body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Unsubscribe to Multiple xStatuses under a Common Node",
                  "method": "xFeedback/Unsubscribe",
                  "params": {
                    "Id": 1 //<-- NOTE: You're Id may differ
                  }
                }
                ```

        ??? gif "View Subscription Assistant"
                    
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

    ### **2.4.6 - Subscribing to xEvents**

    ???+ blank "Subscribe and Unsubscribe to an xEvent"

        !!! info inline end "XML Body Location"

            <figure markdown>
              ![Message body location](./assets/wx1_1451_part_2/2-4-3_Execute-xCommand-BodyLocation.png){ width="400" }
            </figure>

        - **xAPI:** xEvent UserInterface Message Prompt Response

        - **Task:** 
            - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xStatus
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                    - Under the xEvents Page, click the {++Prompt Button++} in the ==UserInterface Message== row
                        - This will create a Pop Up with 5 options
                        - Click on any of these 5 Options
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - ==Optional==: Try each of the options under `Prompt` and continue to observe your {++Postman Terminal++}
                    - Press click either the `TextInput`, the `Rating` or the `Alert` button and submit any accompanying actions in that interface
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - Responses for `TextInput`, `Rating` or `Alert` shouldn't show since you're currently only subscribed to `Prompt`
              
              - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xStatus
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xStatuses Page, move the Slider labeled ==Adjust Volume,== to a new position and release
                          - Alternatively, you can adjust the volume with the Codec's native volume control buttons
                      - Observe your {++Postman Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Postman Terminal++}
                          - ==Optional==: Move the slider a few more times to see more changes come in
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? question "Need Help with the Syntax?"

            <a class="md-button md-button--primary" href="../cheatsheet" target="_blank" >
              Open the <strong>Websocket Method and Parameter</strong> Table in the CheatSheet <i class="fa-solid fa-square-up-right"></i>
            </a>

        ??? success "View properly formatted Messages"

            === "Subscribe Message body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Subscribe to an xEvent",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Query": ["Event", "UserInterface", "Message", "Prompt", "Response"]
                  }
                }
                ```

            === "Unsubscribe Message Body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Unsubscribe to an xEvent",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Id": 1 //<-- NOTE: You're Id may differ
                  }
                }
                ```
        
        ??? gif "View Subscription Assistant"
                    
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

    ??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xEvents under a Common Node"

        - **xAPI:** xEvent UserInterface

        - **Task:** 

            - Assign the correct ==Method== to the `method` object in order to {++Subscribe++} to an xEvent
                - Within the `params` object, fill in the `Query` object using the xAPI above

                - Once the Message body has been updated
                    - ==Save== the request
                    - Select ==Connect== to establish the WebSocket connection to the Codec
                    - Select ==Send==
                    - Observe the Initial Response in the Postman Terminal
                        - Record the responses Result Id value ```result: {Id: ##}``` [This is your Subscription Id]
                
                - Press the `Subscription Assistant Button` on your Touch Interface
                    - Under the xEvents Page, try any of the `Widgets` on this page, and submit any accompanying actions in that interface if any
                    - Observe your {++Postman Terminal++} output, you should see events for your Subscription fill the {++Postman Terminal++}
                        - ==Optional==: Try all of the `Widget` on that page :smiley:

            - Unsubscribe
                  - Assign the correct ==Method== to the `method` object in order to {++Unsubscribe++} from an xStatus
                  - Within the `params` object, fill in the `Query` object the Subscription Id you recorded

                  - Once the Message body has been updated
                      - ==Save== the request
                      - Select ==Send==
                      - Observe the Initial Response in the Postman Terminal
                  
                  - Press the `Subscription Assistant Button` on your Touch Interface
                      - Under the xEvents Page, try any of the `Widgets` on this page, and submit any accompanying actions in that interface if any
                      - Observe your {++Postman Terminal++} output, those responses you saw in the previous lesson should have stopped outputting in your {++Postman Terminal++}
                          - ==Optional==: Continue pressing buttons to see more changes come in
        
        - When you've finished this lesson, select ==Disconnect== to terminate the WebSocket connection

        ??? success "View properly formatted Messages"

            === "Subscribe Message body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Subscribe to Multiple xEvents under a Common Node",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Query": ["Event", "UserInterface"]
                  }
                }
                ```

            === "Unsubscribe Message Body"

                ``` { .json }
                {
                  "jsonrpc": "2.0",
                  "id": "Unsubscribe to Multiple xEvents under a Common Node",
                  "method": "xFeedback/Subscribe",
                  "params": {
                    "Id": 1 //<-- NOTE: You're Id may differ
                  }
                }
                ```

        ??? gif "View Subscription Assistant"
                    
            <figure markdown>
              ![SubAssist Operation](./assets/general/SubscriptionAssitantMacro-Operation.gif){ width="600" }
            </figure>

    ### **2.4.8 - Section 2.4 Cleanup**

    !!! important

        - Press the `Subscription Assistant Button` on your Touch Interface
        - Under the ==Section Cleanup== Page, select the ==Run Section Cleanup?== button
        - Select ==Yes, Run the Cleanup Script==

        <figure markdown="span">
          ![Section cleanup](./assets/general/SubscriptionAssitantMacro-ConfirmCleanup.png){ width="400" }
          <figcaption>Section Cleanup Confirmation</figcaption>
        </figure>

        This will reverse the changes we've made to the endpoint, and leave us ready for the next section


        ??? question "You can run the cleanup via the terminal as well"

            Copy the contents below into your terminal window and run them all at once

            ```shell title="Type into terminal and press Enter"
            xConfig Audio DefaultVolume: 50
            xCommand UserInterface Extensions Panel Remove PanelId: wx1_lab_multilineCommand
            xCommand Video Selfview Set Mode: Off FullscreenMode: Off
            xCommand Video Input SetMainVideoSource ConnectorId: 1
            xCommand Audio Volume SetToDefault Device: Internal
            xCommand HTTPFeedBack Deregister FeedbackSlot: 1 FeedbackSlot: 2 FeedbackSlot: 3 FeedbackSlot: 4
            ```

- - -
- - -

## <u>**Section 2.5: Accessing xAPI via Cloud xAPI**</u>

!!! Abstract

    Cloud xAPIs are only accessible for devices registered to the Webex Cloud or Cloud Edge for Devices

    They are HTTP requests, but differ in the sens that you're not directly communicating to the endpoint in a 1:1 relationship like we would with every other protocol we offer.

    You instead make a request, or offer a WebHook, to your Webex Cloud instance and then your cloud instance will broker the communication between itself and the device

    In short, when using Cloud xAPIs you're communicating using the Webex Cloud APIs, not directly interfacing with the Device xAPI. but fortunately, the paths fo the Device xAPI stack remain the same

    !!! curious "Click the Tabs Below to see how HTTP xAPI calls differ from Cloud xAPI calls"

        === "HTTP API"

            === "Get Requests [xStatuses/xConfigs]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Target Codec
                  My Customization->>+Target Codec: xStatus/xConfig Get Request
                  Note over My Customization,Target Codec: If Device Online
                  Target Codec->>- My Customization: Responds 200 OK
                ```

            === "Post Requests [xCommands/xConfigs]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Target Codec
                  My Customization->>+Target Codec: xCommand/xConfig Post Request
                  Note over My Customization,Target Codec: If Device Online
                  Target Codec->>- My Customization: Responds 200 OK
                ```

            === "Subscriptions [HTTPFeedback]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Target Codec
                  activate Target Codec
                  Note over My Customization, Target Codec: WebHook Offered by My Customization<br>Configured in Target Codec
                  Target Codec -->>+ My Customization: Forwards Subscription Traffic
                  Note over My Customization,Target Codec: On Subscription callBack from Target Codec
                  deactivate Target Codec
                  activate My Customization
                  Target Codec->>+ My Customization: Ex. xEvent UserInterface Extension Panel Clicked (QuickDial)
                  activate Target Codec
                  My Customization->>+Target Codec: Responds with xCommand Dial Post Request
                  deactivate My Customization
                  Target Codec->>- My Customization: Responds 200 OK
                ```

        === "Cloud xAPI"

            === "Get Requests [xStatuses/xConfigs]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Webex Cloud
                  participant Target Codec
                  Webex Cloud<<-->>Target Codec: Websocket Connection
                  Note over Webex Cloud,Target Codec: Forwarding xStatus, xConfig<br> and xEvent information
                  My Customization->>+Webex Cloud: xStatus/xConfig Get Request
                  Webex Cloud ->>- My Customization: 200 OK
                  Note over My Customization,Webex Cloud: xStatus and xConfig<br> Information Saved in Cloud
                ```
            
            === "Post Requests [xCommands]"

                  ``` mermaid
                  %%{init: {'theme':'dark'}}%%
                  sequenceDiagram
                    participant My Customization
                    participant Webex Cloud
                    participant Target Codec
                    Webex Cloud<<-->>Target Codec: Websocket Connection
                    Note over Webex Cloud,Target Codec: Forwarding xStatus, xConfig<br> and xEvent information
                    My Customization->>+Webex Cloud: xCommand Post Request
                    activate Webex Cloud
                    Note over Webex Cloud,Target Codec: Runs xCommand if<br>Device is Online
                    Webex Cloud->>+Target Codec: Forwards Request
                    activate Target Codec
                    Target Codec->>+Webex Cloud: Responds to Request
                    deactivate Target Codec
                    Webex Cloud->>- My Customization: Forwards Response 200 OK
                    deactivate Webex Cloud
                  ```

            === "Patch Requests [xConfigs]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Webex Cloud
                  participant Target Codec
                  Webex Cloud<<-->>Target Codec: Websocket Connection
                  Note over Webex Cloud,Target Codec: Forwarding xStatus, xConfig<br> and xEvent information
                  My Customization->>+Webex Cloud: xConfig Patch Request
                  activate Webex Cloud
                  %% Note over Webex Cloud,Target Codec: Runs xConfig
                  %% Webex Cloud->>+Target Codec: Forwards Patch Request
                  %% Target Codec->>+Webex Cloud: Responds Error 503
                  %% deactivate Target Codec
                  Note over Webex Cloud,My Customization: Cloud Accepts Changes
                  Webex Cloud->>+ My Customization: Forwards Response 200 OK
                  deactivate Webex Cloud
                  activate Target Codec
                  Webex Cloud->>+Target Codec: Forwards xConfig Patch Request
                  Note over Webex Cloud,Target Codec: If the Target Codec is Offline, On Boot,<br>Webex Cloud Re-issues all xConfig Changes
                  Target Codec->>+Webex Cloud: Responds 200 OK
                  deactivate Target Codec
                ```

            === "Subscriptions [Workspace Integrations]"

                ``` mermaid
                %%{init: {'theme':'dark'}}%%
                sequenceDiagram
                  participant My Customization
                  participant Webex Cloud
                  participant All Org Codecs
                  participant Target Codec
                  Webex Cloud<<-->>All Org Codecs: Websocket Connection<br>HTTP LongPoll
                  Note over Webex Cloud,All Org Codecs: Forwarding xStatus, xConfig<br> and xEvent information
                  Note over My Customization, Webex Cloud: WebHook Offered by My Customization<br>Configured in Webex Cloud
                  Webex Cloud -->>+ My Customization: Forwards Subscription Traffic<br>
                  par
                  Note over My Customization, Target Codec: On Subscription callBack from Target Codec
                  Target Codec -->>+ Webex Cloud: Ex. xEvent UserInterface Extension Panel Clicked (QuickDial)
                  Webex Cloud -->>- My Customization: Forwards xEvent UserInterface Extension Panel Clicked
                  My Customization->>+Webex Cloud: Responds with xCommand Dial Post Request
                  Note over Webex Cloud,Target Codec: Runs xCommand if<br>Device is Online
                  Webex Cloud->>-Target Codec: Forwards xCommand Dial Request
                  Target Codec->>+Webex Cloud: Responds 200 OK
                  Webex Cloud->>- My Customization: Forwards Response 200 OK
                  end
                ```


!!! important "Section Requirements"

    Postman should have been installed on your loaner laptop, make sure it is
    
    - If Postman is **==NOT==** installed, be sure to install it before continuing section 2.5

    <div class="grid cards" markdown>

    -   <i class="fa-solid fa-download"></i> __Click the icon below for the Postman Download Page__

        ---

        <a href="https://www.Postman.com/downloads/" target="_blank">
          <figure markdown="span">
              ![Postman Download](https://voyager.postman.com/logo/postman-logo-icon-orange.svg){ width="75" }
          </figure>
        </a>
    
    -   <i class="fa-solid fa-download"></i> __Click the icon below for the Section 2.5 Postman Collection__

        ---

        <a href="https://github.com/WebexCC-SA/LAB-1451/raw/refs/heads/main/docs/assets/downloadable_resources/PostMan%20Collections/WX1-Lab-1451-CloudxAPI-PostMan-Collection.postman_collection.zip" target="_blank">
          <figure markdown="span">
              ![Postman Collection](https://voyager.postman.com/logo/postman-logo-icon-orange.svg){ width="75" }
          </figure>
        </a>

    </div>


### **2.5.1  - Cloud xAPI Authentication and Format**

!!! blank ""

    <h4>URL Structure</h4>

    The request URL for your Codec will change depending on whether you're making a Get, Post, Patch or Delete request to the Webex Cloud Service

    !!! example ""
        
        === "Get"

            === "xAPI Branch"

                https://webexapis.com/v1/==xapi/status==?[URL_Params]

            === "Devices Branch"

                https://webexapis.com/v1/==devices==?[URL_Params]

            === "WorkSpaces Branch"

                https://webexapis.com/v1/==workspaces==?[URL_Params]

            ??? curious "Why is there a split between `xAPI`, `Devices` and `Workspaces`"

                The Webex API stack offers APIs from all technologies within it's portfolio, not just for Video Devices. You'll have APIs for phone services, messaging, user management and the list goes on

                The `Devices` branch represents cloud-registered Webex RoomOS devices and Webex Calling phones. Devices may be associated with Workspaces.

                The `xAPI` branch allows developers to programmatically invoke commands and query the status of devices that run Webex RoomOS software. This is the very same xAPI we've been working with in the Previous Sections. These Video Devices themselves fall under the `Devices` branch and `Workspaces` branches, but mainly for management purposes.

                The `Workspaces` branch represents where people work, such as conference rooms, meeting spaces, lobbies, and lunch rooms. Devices may be associated with workspaces.

                We'll only cover 2 simple examples for the `Devices` and `Workspaces` branches in this lab as they are a bit out of scope, but they are worthwhile to know about, as they can help you build solutions for your video devices that scale across your organization.

        === "Post"

            === "xAPI Branch"

                https://webexapis.com/v1/xapi/==command/[Command_xAPI_Path]==

            === "Devices Branch"

                https://webexapis.com/v1/==devices/[Devices_API_Path]?[URL_Params]==

            === "Workspaces Branch"

                https://webexapis.com/v1/==workspaces[Workspaces_API_Path]?[URL_Params]==

        === "Patch"

            === "xAPI Branch"

                https://webexapis.com/v1/==deviceConfigurations?[URL_Params]==

                ??? curious "I thought this was the `xAPI` branch, Not the `deviceConfigurations`?"

                    Keen Eye :smiley:. This is the branch to access Device xAPI/xConfigurations but in Webex, all Device Related Configurations run under this branch

                    So when working with Video Device or Phone Devices, you'll configure them here.

            === "Devices Branch"

                https://webexapis.com/v1/==devices/[Device_Id]?[URL_Params]==

            === "Workspaces Branch"

                 https://webexapis.com/v1/==workspaces[Workspaces_API_Path]?[URL_Params]==

        === "Delete"

            === "xAPI Branch"

                !!! error "None Available"

            === "Devices Branch"

                https://webexapis.com/v1/==devices/[deviceId]?[URL_Params]==

            === "Workspaces Branch"

                https://webexapis.com/v1/==workspaceLocations/[locationId]/[Workspaces_API_Path]==

    <h4>Authentication Format</h4>

    Authentication can vary between Webex API branches and it's a bit of a broad topic depending on the solution.

    If you're interested in learning more about Webex APIs and the various scopes, check out the

    <a class="md-button md-button--primary" href="https://developer.webex.com/docs/platform-introduction" target="_blank" >
      Platform Introduction Guide <i class="fa-solid fa-square-up-right"></i>
    </a>

    On developer.webex.com

    For the lab, we'll use our Personal Access Token, which, with admin or device admin rights, will suffice.

    Your Personal Access Token is a form of `Bearer` authentication

    <h4>Request Headers</h4>

    | Key                         | Value                             |
    | :---------------------------| :---------------------------------|
    | `Content-Type`              | `application/json`                |
    | `Content-Type`              | `application/json-patch+json`     |
    | `Authorization`             | `Bearer [YOUR_TOKEN]`             |


### **2.5.2  - Get and your Personal Access Token, Import and Configure Postman Collection**

!!! info "Get your Personal Access Token"

    First, go to the Webex Developer Site

    <a class="md-button md-button--primary" href="https://developer.webex.com" target="_blank" >
          Webex for Developers <i class="fa-solid fa-square-up-right"></i>
    </a>

    !!! tip "Click the Tabs and follow the steps to get your Token"

        === "1. Select Login >>"

            !!! info "In the Top Navigation Bar"

            <figure markdown="span">
                ![Webex Dev Login](./assets/general/DevToken-Login.png){ width="400" }
                <figcaption>Select Login</figcaption>
            </figure>

        === "2. Enter Your Email >>"

            !!! important "Use the email provided to you in this lab"

            <figure markdown="span">
                ![Webex Dev Enter Email](./assets/general/DevToken-EnterEmail.png){ width="400" }
                <figcaption>Enter Your Email</figcaption>
            </figure>

        === "3. Select Documentation >>"

            !!! info "In the Top Navigation Bar"

            <figure markdown="span">
                ![Webex Dev Documentation](./assets/general/DevToken-SelectDocs.png){ width="400" }
                <figcaption>Select Documentation</figcaption>
            </figure>

        === "4. Find Devices Reference >>"

            !!! info "In the left Navigation Bar"

            <figure markdown="span">
                ![Webex Dev Device Reference](./assets/general/DevToken-FindDevices.png){ width="250" }
                <figcaption>Select Device References</figcaption>
            </figure>

        === "5. Copy Personal Access Token"

            !!! info "In the Top Navigation Bar, then in the right content menu"

            <figure markdown="span">
                ![Webex Dev Copy Token](./assets/general/DevToken-CopyToken.png){ width="600" }
                <figcaption>Select List Devices and Copy Personal Access Token</figcaption>
            </figure>

!!! info "Import and Configure Postman Collection"

    <h4>Import Collection</h4>

    - With Postman open, in a new or existing workspace select ==import==
    - Select File
    - Locate the ==WX1-Lab:1451-CloudxAPI-Postman-Collection.Postman_collection.json== and Open it
    - You should now have the Postman Collection installed for this lab

    ??? gif "View Import Postman Collection"

        <figure markdown>
          ![Import Lab Postman Collection](./assets/wx1_1451_part_2/2-3-2_Import-PostmanCollection.gif){ width="600" }
        </figure>

    <h4>Configure Collection</h4>

    - Click on the ==WX1-Lab:1451-CloudxAPI-Postman-Collection== root folder
    - Select Variables
    - Add the following information for your codec in both the `Initial Value` and `Current Value` fields
        - developer_Token
        - device_Id
    - Select Save (or one of the keyboard shortcuts for your computer)
        - ++control+s++ for Windows
        - ++command+s++ for Mac

    ??? gif "View Configure Postman Collection"

        <figure markdown>
          ![Configure Cloud xAPI Postman Collection](./assets/wx1_1451_part_2/2-5-2_Config-Postman.gif){ width="600" }
        </figure>

- - -

!!! Important

    For each lesson throughout Sections 2.5.3 through 2.5.6, use the ==WX1-Lab:1451-CloudxAPI-Postman-Collection.Postman_collection.json== Postman collection.

    Each Section has it's own Folder and each lesson name below matches a Postman Request in that folder.

    When tasked to use Postman, use the Request that matches your current lesson.

- - -

### **2.5.3 - Webex Devices and Workspace APIs**

!!! Note

    In section 2.5.3, we'll review a single API from the Devices and Workspaces branches. These APIs are not directly associated to the Devices xAPI, but help highlights what's possible to do at scale when interacting with your devices.

???+ lesson "Lesson: List Devices"

    - **Webex Api**: List Devices

    - **Task**:

        - This Postman Request comes predefined, no action other than selecting ==Send== and review the Postman Terminal's repsonse

    !!! note
    
        The result will contain all devices you have access to in your Webex Control Hub Organization. This includes not only Video Collaboration devices, but Phones, headsets and any other hardware listed as a Device

        You can apply filters to this Get request in the form of URL parameters to refine which devices you're interested in listing

    ??? success "View properly formatted Url, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/{++devices++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` JSON
            {
              "items": [
                {
                  "id": "{{device_Id}}",
                  "displayName": "XXXX-XXXX",
                  "placeId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "orgId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "capabilities": [],
                  "permissions": [],
                  "product": "Cisco Desk Mini",
                  "type": "roomdesk",
                  "tags": [],
                  "ip": "XXX.XXX.XXX.XXX",
                  "mac": "XX:XX:XX:XX:XX:XX",
                  "serial": "XXXXXXXXXXX",
                  "activeInterface": "LAN",
                  "software": "RoomOS XX.XX.XX.XX xxxxxxxxxx",
                  "upgradeChannel": "Stable",
                  "primarySipUrl": "example@example.com",
                  "sipUrls": [
                    "example@example.com"
                  ],
                  "errorCodes": [],
                  "connectionStatus": "Online",
                  "created": "0000-00-00T00:00:00.000Z",
                  "firstSeen": "0000-00-00T00:00:00.000Z",
                  "lastSeen": "0000-00-00T00:00:00.000Z",
                  "managedBy": "Webex",
                  "devicePlatform": "cisco",
                  "workspaceId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                },
                ["Devices Continued..."]
              ]
            }
            ```

??? lesson "Lesson: List Workspaces"

    - **Webex Api**: List Workspaces

    - **Task**:

        - This Postman Request comes predefined, no action other than selecting ==Send== and review the Postman Terminal's repsonse

    !!! note
    
        The result will contain all workspaces you have access to in your Webex Control Hub Organization. This includes information about each workspace you've defined. Keep in mind, each device is apart of a Workspace

        You can apply filters to this Get request in the form of URL parameters to refine which workspaces you're interested in listing

    ??? success "View properly formatted Url, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/{++workspaces++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` JSON
            {
              "items": [
                {
                  "id": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "orgId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "workspaceLocationId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "locationId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "floorId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
                  "displayName": "XXXX-XXXX",
                  "capacity": 16,
                  "type": "meetingRoom",
                  "sipAddress": "example@example.rooms.webex.com",
                  "created": "0000-00-00T00:00:00.000Z",
                  "calling": {
                    "type": "webexCalling",
                    "licenses": ["xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"]
                  },
                  "calendar": {
                    "type": "none"
                  },
                  "hotdeskingStatus": "off",
                  "deviceHostedMeetings": {
                    "enabled": true,
                    "siteUrl": "example.webex.com"
                  },
                  "supportedDevices": "collaborationDevices",
                  "devicePlatform": "cisco"
                },
                ["Workspaces Continued..."]
              ]
            }
            ```

### **2.5.4 - Executing xCommands**

???+ lesson "Lesson: Execute an xCommand"

    !!! example "Click on the tabs to see how Terminal Syntax relates to Cloud xAPI Syntax"

        === "Terminal Syntax"
            
            Url:
            <pre><code>x{++Command++} {++Child++} {++Child++} {++ChildParam_X++}: ==SomeValue== </code></pre>

        === "Cloud xAPI"

            Url:
            <pre><code>https://webexapis.com/v1/xapi/{++status++}?deviceId={{device_Id}}&name={++Child.Child++}</code></pre>

            ``` JSON title="Body"
            {
                "deviceId": "{{device_Id}}",
                "arguments": {
                  "ChildParam_X": "SomeValue"
              }
            }
            ```

    - **xAPI:** xCommand Video Selfview Set
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - In the Postman request Body, structure the following parameters using JSON format into the `arguments` object
            - Mode: On
            - FullScreenMode: On
            - OnMonitorRole: First

        Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted Url, Body and Successful Response"

        === "Url"

            <pre><code>https://webexapis.com/v1/xapi/command/==Video.Selfview.Set==</code></pre>

        === "Body"

            ``` JSON
            {
                "deviceId": "{{device_Id}}",
                "arguments": {
                  "Mode": "On",
                  "FullScreenMode": "On",
                  "OnMonitorRole": "First"
              }
            }
            ```

        === "Response"

            ``` JSON
            {
              "deviceId": "[YOUR_DEVICE_ID]",
              "result": {}
            }
            ```

??? lesson "Lesson: Execute an xCommand with multiple arguments with the same name"

    In cases where we need to declare multiple arguments of the same name, rather than duplicating and re-running the parameters, we instead leverage an Array in place of the value, containing all values we want to implement under that Parameter

    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >
      Learn more about <strong>Arrays</strong> <i class="fa-solid fa-square-up-right"></i>
    </a>

    !!! example "Click on the tabs to see how Terminal Syntax relates to Cloud xAPI Syntax"

        === "Terminal Syntax"

            ``` { .shell }
            xParent Child ChildParam_X: 1, ChildParam_X: 2
            ```
            

        === "Cloud xAPI Syntax"

            Url: https://webexapis.com/v1/xapi/command/==Parent.Child==

            ``` { .json , title="Body" }
            {
                "deviceId": "{{device_Id}}",
                "arguments": {
                  "ChildParam_X": [1, 2]
              }
            }
            ```

    - **xAPI:** xCommand Video Input SetMainVideoSource
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - In the Postman request Body, structure the following parameters using JSON format into the `arguments` object, but duplicate the ConnectorId parameter twice
            - ConnectorId: 1
            - Layout: Equal

        Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted Url, Body and Successful Response"

        === "Url"

            <pre><code>https://webexapis.com/v1/xapi/command/==Video.Input.SetMainVideoSource==</code></pre>

        === "Body"

            ``` JSON
            {
                "deviceId": "{{device_Id}}",
                "arguments": {
                  "ConnectorId": [1, 1],
                  "Layout": "Equal"
              }
            }
            ```

        === "Response"

            ``` JSON
            {
              "deviceId": "[YOUR_DEVICE_ID]",
              "result": {}
            }
            ```

??? lesson "Lesson: Execute an xCommand with a multiline argument"

    !!! info

        Multiline Arguments can be placed into the `body` object object of your post. This is defined after the arguments object, not within it.

        The structure of a Multiline argument should look similar to the following

    !!! example "Click on the tabs to see how Terminal Syntax relates to WebSocket Syntax"

        === "Terminal Syntax"

            ``` { .shell }
            [xParent Child ChildParam_X: SomeValue]
            [Multi Line Content]
            .
            ```
            

        === "WebSocket Syntax"

            Url: https://webexapis.com/v1/xapi/command/==Parent.Child==

            ``` { .json , title="Body" }
            {
              "deviceId": "{{device_Id}}",,
              "arguments": {
                "ChildParam_X": "SomeValue"
              },
              "body": "Multi Line Content"
            }
            ```

    !!! note

        Your Selfview may still be open

        Run the following in your terminal window to close selfview

        ``` shell
        xCommand Video Selfview Set Mode: Off
        ```

        ??? challenge "Challenge: Alter `Execute an xCommand` in your Cloud xAPI Postman Collection"

              Rather than re-open your terminal session, you can go back to `Execute an xCommand` in your Cloud xAPI Postman Collection, and update the `argument` object to set the Mode parameter to Off

              <a class="md-button md-button--primary" href="../challengeAnswers/" target="_blank" >
                Giving Up? Check out the Challenge Answers Page <i class="fa-solid fa-square-up-right"></i>
              </a>

    - **xAPI:** xCommand UserInterface Extensions Panel Save
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - In the Postman request Body, structure the following parameters into the `arguments` object
            - PanelId: wx1_lab_multilineCommand
        
        - In the Postman request Body, format the XML below into the `body` object

            ```{ .xml , title="Your &lt;body&gt; Value" }
            <Extensions>
              <Panel>
                <Order>1</Order>
                <PanelId>wx1_lab_multilineCommand</PanelId>
                <Location>HomeScreen</Location>
                <Icon>Info</Icon>
                <Color>#FF70CF</Color>
                <Name>MultiLine Command [Section 2.4.3]</Name>
                <ActivityType>Custom</ActivityType>
              </Panel>
            </Extensions>
            ```

        - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device
        
        !!! note 

            JSON is not a big fan of multiline strings. No need to flatten it to one line yourself, we have a `Flatten Multiline String Tool` on the Tools page

            <a class="md-button md-button--primary" href="../tools/" target="_blank" >
              Open **Tools** <i class="fa-solid fa-gear"></i> Page <i class="fa-solid fa-square-up-right"></i>
            </a>

        Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted Url, Body and Successful Response"

        === "Url"

            <pre><code>https://webexapis.com/v1/xapi/command/==UserInterface.Extensions.Panel.Save==</code></pre>

        === "Body"

            ``` JSON
            {
              "deviceId": "{{device_Id}}",
              "arguments": {
                "PanelId": "wx1_lab_multilineCommand"
              },
              "body": "<Extensions> <Panel> <Order>1</Order> <PanelId>wx1_lab_multilineCommand</PanelId> <Location>HomeScreen</Location> <Icon>Info</Icon> <Color>#FF70CF</Color> <Name>MultiLine Command [Section 2.5.4]</Name> <ActivityType>Custom</ActivityType> </Panel> </Extensions>"
            }
            ```

        === "Response"

            ``` JSON
            {
              "deviceId": "[YOUR_DEVICE_ID]",
              "result": {}
            }
            ```

??? lesson "Lesson: Execute an xCommand which generates data and responds"

    - **xAPI:** xCommand UserInterface Extensions List
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - In the Postman request Body, structure the following parameters using JSON format into the `arguments` object.
            - ActivityType: Custom

       - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted Url, Body and Successful Response"

        === "Url"

            <pre><code>https://webexapis.com/v1/xapi/command/==UserInterface.Extensions.List==</code></pre>

        === "Body"

            ``` JSON
            {
              "deviceId": "{{device_Id}}",
              "arguments": {
                "ActivityType": "Custom"
              }
            }
            ```

        === "Response"

            ``` JSON
            "result": {
              "Extensions": {
                "Panel": [
                  {
                    "ActivityType": "Custom",
                    "Color": "#FF70CF",
                    "Icon": "Info",
                    "Location": "HomeScreen",
                    "Name": "MultiLine Command [Section 2.5.4]",
                    "Order": 1,
                    "Origin": "local",
                    "PanelId": "wx1_lab_multilineCommand",
                    "Visibility": "Auto",
                    "id": 2
                  },
                  {"Continues..."}
                ],
                "Version": "1.11"
              }
            }
            ```

### **2.5.5 - Getting and Setting to xConfigurations**

???+ lesson "Lesson: Getting an xConfiguration Value"

    !!! example "Click on the tabs to see how Terminal Syntax relates to Cloud xAPI Syntax"

        === "Terminal Syntax"

            <pre><code>x{++Configuration++} {++Child++} {++Child++}</code></pre>

        === "Cloud xAPI"

            <pre><code>https://webexapis.com/v1/device{++Configurations++}?deviceId={{device_Id}}={++Child.Child++}</code></pre>

    - **xAPI:** xConfiguration Audio DefaultVolume
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}&key={++Audio.DefaultVolume++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` { .json , .no-copy }
            {
                "deviceId": "{{device_Id}}",
                "items": {
                    "Audio.DefaultVolume": {
                        "value": 71, // <-- Response Includes New Value for Path
                        "source": "configured",
                        "sources": {
                            "default": {
                                "value": 50,
                                "editability": {
                                    "isEditable": false,
                                    "reason": "FACTORY_DEFAULT"
                                },
                                "level": "schemaDefault",
                                "enforced": false
                            },
                            "configured": {
                                "value": 71,
                                "editability": {
                                    "isEditable": true
                                },
                                "level": "device",
                                "enforced": false
                            }
                        },
                        "valueSpace": {
                            "type": "integer",
                            "maximum": 100,
                            "minimum": 0
                        }
                    }
                }
            }
            ```

??? lesson "Lesson: Getting multiple xConfiguration Values under a common Node"

    !!! note 

        In order to Get all configuration values under a common node, we need to insert a wildcard ({++*++}) into the path as the last argument

        !!! example "Click each Tab below to see how the wildcard is implemented in the URL"
        
            === "Full xAPI Path"

                <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}&key=Bluetooth.Allowed</code></pre>

            === "Next Higher Common Node"

                <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}&key=Bluetooth{++.*++}</code></pre>

            === "Highest Common Node"

                <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}{--&key=--}</code></pre>

                !!! note

                    When requesting the entire xConfiguration Branch, path or wildcard id not required, simply remove the entire `key` URL parameter

    - **xAPI:** xConfiguration Audio
    
    - **Task:**

        - Structure the xAPI Path above in the `URL`

        - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}&key={++Audio.*++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` { .json , .no-copy }
            {
                "deviceId": "{{device_Id}}",
                "items": { // <-- Response Includes New Values for Common Path
                  "Audio.Input.Ethernet[1].Channel[2].Gain": {
                    "value": 45,
                    "source": "default",
                    "sources": {
                      "default": {
                        "value": 45,
                        "editability": {
                          "isEditable": false,
                          "reason": "FACTORY_DEFAULT"
                        },
                        "level": "schemaDefault",
                        "enforced": false
                      },
                      "configured": {
                        "value": null,
                        "editability": {
                          "isEditable": true
                        },
                        "level": "device",
                        "enforced": false
                      }
                    },
                    "valueSpace": {
                      "type": "integer",
                      "maximum": 70,
                      "minimum": 0
                    }
                  },
                  ["And the list continues...[5000+ Lines]"]
                }
            }
            ```

??? lesson "Lesson: Set a new xConfiguration Value"

    !!! Webex "Note"

        Unlike commands, configurations use HTTP Patches. This is because you're making a change to the configuration stored on Webex Control Hub, then control hub will forward changes to the device.

        The benefit here, is that your device doesn't need to be online to make these changes :smiley:. So in the case of making bulk changes across your portfolio, Webex Control Hub will apply the configurations you set to all online devices, and should a device be offline, Webex Control Hub will apply those config changes after the device reconnects to the cloud on boot

        With that said, execution of xConfiguration changes via Cloud xAPI changes how the URL and Body are structured

    !!! example "Click on the tabs to see how Terminal Syntax relates to Cloud xAPI Syntax"

        === "Terminal Syntax"

            ``` { .shell }
            xConfig Child ChildParam_X: 1
            ```

        === "Cloud xAPI Syntax"

            Url: https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}

            === "Set new Value"

                To set a new value, the `op` object must have a value of ==replace== and the `value` object requires the configurations new value

                ``` { .json , title="Body" }
                [
                    {
                        "op": "replace",
                        "path": "Child.ChildParam_X/sources/configured/value",
                        "value": 1
                    }
                ]
                ```

            === "Set Default Value"

                To the configuration back to it's default value, the `op` object must have a value of ==remove== and omit {--`value`--} object

                ``` { .json , title="Body" }
                [
                    {
                        "op": "remove",
                        "path": "Child.Child/sources/configured/value",
                    }
                ]
                ```

            !!! important

                All xAPI paths in the `path` object must end with {++/sources/configured/value++}

    - **xAPI:** xConfiguration Audio DefaultVolume
    
    - **Task:** 

        - Assign the correct value to the `op` object in order to ==Set== a new value for the xAPI above

        - Structure the xAPI above in the path correctly, be sure to end that path with {++/sources/configured/value++}

        - Assign a value of ==100== to the `value` object

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}</code></pre>

        === "Body"

            ``` JSON
            [
                {
                    "op": "replace",
                    "path": "Audio.DefaultVolume/sources/configured/value",
                    "value": 100
                }
            ]
            ```

        === "Response"

            ``` { .json , .no-copy }
            {
              "deviceId": "{{device_Id}}",
              "items": {
                "Audio.DefaultVolume": {
                  "value": 100, // <-- Response Includes New Value for Path
                  "source": "configured",
                  "sources": {
                    "default": {
                      "value": 50,
                      "editability": {
                        "isEditable": false,
                        "reason": "FACTORY_DEFAULT"
                      },
                      "level": "schemaDefault",
                      "enforced": false
                    },
                    "configured": {
                      "value": 50,
                      "editability": {
                        "isEditable": true
                      },
                      "level": "device",
                      "enforced": false
                    }
                  },
                  "valueSpace": {
                    "type": "integer",
                    "maximum": 100,
                    "minimum": 0
                  }
                },
                ["10000+ Line Response..."]
              }
            }
            ```

??? lesson "Lesson: Set an xConfiguration to it's Default Value"

    - **xAPI:** xConfiguration Audio DefaultVolume
    
    - **Task:** 

        - Assign the correct value to the `op` object in order to ==Set the Default Value== for the xAPI above

        - Structure the xAPI above in the path correctly, be sure to end that path with {++/sources/configured/value++}

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}</code></pre>

        === "Body"

            ``` JSON
            [
                {
                    "op": "remove",
                    "path": "Audio.DefaultVolume/sources/configured/value"
                }
            ]
            ```

        === "Response"

            ``` { .json , .no-copy }
            {
              "deviceId": "{{device_Id}}",
              "items": {
                "Audio.DefaultVolume": {
                  "value": 50,  // <-- Response Includes New Value for Path
                  "source": "configured",
                  "sources": {
                    "default": {
                      "value": 50,
                      "editability": {
                        "isEditable": false,
                        "reason": "FACTORY_DEFAULT"
                      },
                      "level": "schemaDefault",
                      "enforced": false
                    },
                    "configured": {
                      "value": 50,
                      "editability": {
                        "isEditable": true
                      },
                      "level": "device",
                      "enforced": false
                    }
                  },
                  "valueSpace": {
                    "type": "integer",
                    "maximum": 100,
                    "minimum": 0
                  }
                },
                ["10000+ Line Response..."]
              }
            }
            ```

??? lesson "Lesson: Setting multiple xConfiguration Values in a single Request"

    !!! note

        Setting multiple configuration values can be handled in a single Patch request. The Body starts as an Array, we only need to push more properties into the array

    !!! example "Click the Tabs below to view multiple xConfigurations structured in a single request body"

          === "Single xConfig"

              ``` JSON
              [
                  {
                      "op": "remove",
                      "path": "Child_A.Child_A_Param/sources/configured/value"
                  }
              ]
              ```

          === "2 xConfigs"

              ``` JSON
              [
                  {
                      "op": "remove",
                      "path": "Child_A.Child_A_Param/sources/configured/value"
                  },
                  {
                      "op": "remove",
                      "path": "Child_B.Child_B_Param/sources/configured/value"
                  }
              ]
              ```

          === "3 xConfigs"

              ``` JSON
              [
                  {
                      "op": "remove",
                      "path": "Child_A.Child_A_Param/sources/configured/value"
                  },
                  {
                      "op": "remove",
                      "path": "Child_B.Child_B_Param/sources/configured/value"
                  },
                  {
                      "op": "remove",
                      "path": "Child_B.Child_B_Param/sources/configured/value"
                  }
              ]
              ```



    - **xAPI(s):**
        - xConfiguration Video Input Airplay Mode: On
        - xConfiguration Video Input Airplay Beacon: Auto
    
    - **Task:**

        - Assign the correct value to the `op` object in order to ==Set== a new value for ==each== xAPI above

        - Structure the xAPI above in the path correctly, be sure to end that path with {++/sources/configured/value++}

        - Assign the Values for ==each== xAPI Value above to their `value` object

        - **Hint**: Reference the `2 xConfig` tab above

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/deviceConfigurations?deviceId={{device_Id}}</code></pre>

        === "Body"

            ``` JSON
            [
                {
                    "op": "remove",
                    "path": "Audio.DefaultVolume/sources/configured/value"
                }
            ]
            ```

        === "Response"

            ``` { .json , .no-copy }
            {
              "deviceId": "{{device_Id}}",
              "items": {
                "Video.Input.AirPlay.Mode": {
                  "value": "On", // <-- Response Includes New Value for Path
                  "source": "configured",
                  "sources": {
                    "default": {
                      "value": "Off",
                      "editability": {
                        "isEditable": false,
                        "reason": "FACTORY_DEFAULT"
                      },
                      "level": "schemaDefault",
                      "enforced": false
                    },
                    "configured": {
                      "value": "On",
                      "editability": {
                        "isEditable": true
                      },
                      "level": "device",
                      "enforced": false
                    }
                  },
                  "valueSpace": {
                    "enum": [
                      "Off",
                      "On"
                    ],
                    "type": "string"
                  }
                },
                "Video.Input.AirPlay.Beacon": {
                  "value": "Auto", // <-- Response Includes New Value for Path
                  "source": "configured",
                  "sources": {
                    "default": {
                      "value": "Auto",
                      "editability": {
                        "isEditable": false,
                        "reason": "FACTORY_DEFAULT"
                      },
                      "level": "schemaDefault",
                      "enforced": false
                    },
                    "configured": {
                      "value": "Auto",
                      "editability": {
                        "isEditable": true
                      },
                      "level": "device",
                      "enforced": false
                    }
                  },
                  "valueSpace": {
                    "enum": [
                      "Auto",
                      "Off"
                    ],
                    "type": "string"
                  }
                },
                ["10000+ Line Response..."]
              }
            }
            ```

### **2.5.6 - Getting xStatuses**

??? lesson "Lesson: Getting an xStatus Value"

    !!! example "Click on the tabs to see how Terminal Syntax relates to Cloud xAPI Syntax"

        === "Terminal Syntax"

            <pre><code>x{++Status++} {++Child++} {++Child++}</code></pre>

        === "Cloud xAPI"

            <pre><code>https://webexapis.com/v1/xapi/{++status++}?deviceId={{device_Id}}&name={++Child.Child++}</code></pre>

    - **xAPI:** xStatus Audio Volume
    
    - **Task:**

        - Structure the xAPI Path above in the `URL` of your Postman Request

        - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/xapi/status?deviceId={{device_Id}}&name={++Audio.Volume++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` { .json , .no-copy }
            {
              "deviceId": "{{device_Id}}",
              "result": {
                "Audio": {
                  "Volume": 71
                }
              }
            }

??? lesson "Lesson: Get multiple xStatus Values under a Common Node"

    - **xAPI:** xStatus Audio
    
    - **Task:**

        - Structure the xAPI Path above in the `URL` of your Postman Request

        - Once the Postman Request has been updated, ==Save== the request, select ==Send== and review the Postman Terminal's repsonse and observe any changes to your device

    ??? Success "View properly formatted URL, Body and Successful Response"

        === "URL"

            <pre><code>https://webexapis.com/v1/xapi/status?deviceId={{device_Id}}&name={++Audio.*++}</code></pre>

        === "Body"

            !!! failure "No Body Required"

        === "Response"

            ``` { .json , .no-copy }
            {
              "deviceId": "{{device_Id}}",
              "result": {
                "Audio": {
                  "Devices": {
                    "Bluetooth": {
                      "ActiveProfile": "None"
                    },
                    "HandsetUSB": {
                      "ConnectionStatus": "NotConnected",
                      "Cradle": "OnHook"
                    },
                    "HeadsetUSB": {
                      "ConnectionStatus": "NotConnected",
                      "Description": "",
                      "Manufacturer": ""
                    }
                  },
                  ["500+ Line Response..."].
                }
              }
            }
            ```

### **2.5.7 - Subscribing to xConfigurations, xStatuses and xEvents**

Subscribing to Cloud xAPI requires us to setup a Workspace Integration

A Workspace Integration is a service you spin up that provides a Webhook, which you take and configure it your Webex Control hub instance.

This is not covered by this lab

<a class="md-button md-button--primary" href="https://developer.webex.com/docs/workspace-integrations" target="_blank" >
  Learn More about Workspace Integrations <i class="fa-solid fa-square-up-right"></i>
</a>

### **2.5.8 - Section 2.5 Cleanup**

!!! important

    - Press the `Subscription Assistant Button` on your Touch Interface
    - Under the ==Section Cleanup== Page, select the ==Run Section Cleanup?== button
    - Select ==Yes, Run the Cleanup Script==

    <figure markdown="span">
      ![Section cleanup](./assets/general/SubscriptionAssitantMacro-ConfirmCleanup.png){ width="400" }
      <figcaption>Section Cleanup Confirmation</figcaption>
    </figure>

    This will reverse the changes we've made to the endpoint, and leave us ready for the next section

    ??? question "You can run the cleanup via the terminal as well"

        Copy the contents below into your terminal window and run them all at once

        ```shell title="Type into terminal and press Enter"
        xConfig Audio DefaultVolume: 50
        xCommand UserInterface Extensions Panel Remove PanelId: wx1_lab_multilineCommand
        xCommand Video Selfview Set Mode: Off FullscreenMode: Off
        xCommand Video Input SetMainVideoSource ConnectorId: 1
        xCommand Audio Volume SetToDefault Device: Internal
        xCommand HTTPFeedBack Deregister FeedbackSlot: 1 FeedbackSlot: 2 FeedbackSlot: 3 FeedbackSlot: 4
        ```

- - -
- - -

## <u>**Section 2.6: Accessing the xAPI via the Macro Editor**</u>

!!! abstract

    The Macro Editor is a `Web Based IDE` that's built into each Cisco Codec running {++ce9.2.X or higher (excluding the Sx10)++} that allows for the development of solutions using the ==Device xAPI and ES6 Javascript==. In a sense, the Macro Editor is like a virtual room control processor built right into the product.

    It's capable of running {++10 active macros++} at any given time and allows for storage of up to ==2mb of text across all files== (Sounds small, but it's more than you think :smiley:).

    You may have as many inactive macros as you can contain with the 2mb limit, which can be useful for storing information, organizing and modularizing work.

    -  For example, some developers in the community have implemented function libraries formatted as a macro, such as 
        - <a href="https://github.com/cisco-ce/guido">Gui-Do</a>: A suite of functions that enables dynamic UI generation with the use of JSON Object
        - <a href="https://github.com/ctg-tme/audio-zone-manager-library-macro/tree/main">Audio Zone Manager</a>: Or AZM is a suite of function that enables the mapping of audio microphones inputs to other resources for audio based automation in space.
    
!!! important

    !!! example "Note"

        This section is meant to teach your the structure of the xAPI when working the Macro Editor. 
        
        Though written in Javascript, this is not a javascript tutorial. There are links to relevant topics throughout the section in case you're stuck on any particular topic

    {++Lab: Build Room Documentation Macro ++} will leverage the Macro Editor and the UI Extensions of your codec to develop a solution using the xAPI

    Syntax covered here is not only relevant for the Macro Editor but also the `jsxapi` Node.Js module which is not covered in this Lab

!!! important "Section Requirements"

    Download the MacroPak below, these Macros will be used throughout section 2.6

    <div class="grid cards" markdown>

    -   <i class="fa-solid fa-download"></i> __Click the icon below to Download the MacroPak__ <i class="fa-solid fa-file-code"></i>

        ---

        <figure markdown="span">
              [![MacroPak](./assets/general/cisco-logo-transparent.png){ width="200" }](https://raw.githubusercontent.com/WebexCC-SA/LAB-1451/main/docs/assets/downloadable_resources/MacroPak.zip)
            <figcaption>MacroPak</figcaption>
        </figure>
    </div>


### **2.6.1 - Enabling Macros**

!!! blank ""

    - Login to your Codec's Web UI
    - Navigate to Settings>Macro Editor
        - The Macro Editor is disabled by Default, press enable

    ???+ tip
        Enabling through the WebUI as we had above can be don via the xAPI as well.
        
        Running ==xConfiguration Macros Mode: On== does the same thing.

        You can even run xConfigurations in bulk across your portfolio using Webex Control Hub or Ce-Deploy, both are covered in, regards to Macro Customization.

### **2.6.2 - Navigating the Macro Editor and installing the MacroPak**

??? vidcast "Vidcast: Macro Editor IDE Review"

    <div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
      <iframe src="https://app.vidcast.io/share/embed/d6dacbb3-9792-4d27-b1fa-434f2ff37f03" width="100%" height="100%" title="Macro Editor IDE Review" frameborder="0" loading="lazy" allowfullscreen style="position:absolute; top:0; left: 0;border: solid; border-radius:12px;"></iframe>
    </div>

??? vidcast "Vidcast: Installing the MacroPack"

    <div style="padding-bottom:56.25%; position:relative; display:block; width: 100%">
      <iframe src="https://app.vidcast.io/share/embed/f31a92e0-609d-430c-bb45-d834c52cb1d3" width="100%" height="100%" title="Installing MacroPak Files - WX1 2024 Lab 1451" frameborder="0" loading="lazy" allowfullscreen style="position:absolute; top:0; left: 0;border: solid; border-radius:12px;"></iframe>
    </div>

### **2.6.3 - Executing xCommands**

???+ lesson "Lesson: Execute an xCommand"

    All device xAPIs are referenced by the imported `xapi` object. By default, a new Macro will contain

    ``` { .javascript , title="xAPI Import" }
    import xapi from 'xapi';
    ```

    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" target="_blank" >
          Learn more about <strong>Imports</strong> <i class="fa-solid fa-square-up-right"></i>
    </a>

    Unlike other ES6 Javascript environments, you only have access to base Javascript functions and techniques as well as the device's xAPI

    - You're **==NOT==** able to import external libraries into this environment.

    All xAPI can be accessed by first referencing the `xapi` object following by the same command path using dot notation

    !!! example "Click on the tabs to see how Terminal Syntax relates to Macro Syntax"

        === "Terminal Syntax"

            ``` shell
            xCommand Time DateTime Get

            OK
            *r DateTimeGetResult (status=OK): 
            *r DateTimeGetResult Day: 24
            *r DateTimeGetResult Hour: 0
            *r DateTimeGetResult Minute: 47
            *r DateTimeGetResult Month: 9
            *r DateTimeGetResult Second: 1
            *r DateTimeGetResult Year: 2024
            ** end
            ```

        === "Macro Syntax"

            ``` javascript
            import xapi from 'xapi';

            xapi.Command.Time.DateTime.Get().then(time => console.log(time))

            /* Log Output
            {
              "Day": "24",
              "Hour": "0",
              "Minute": "47",
              "Month": "9",
              "Second": "44",
              "Year": "2024",
              "status": "OK"
            }
            */
            ```

            ??? curious ":thinking: Why is `.then(time => console.log(time))` trailing the command?"

                Well that's the nature of this environment. In a terminal session, the command is immediately followed by a response

                But in working with the xAPI in a Macro or `jsxapi` NodeJs environment, the response is certainly there, but we need to capture in an object and then log it to the console.

                Most, if not all, functions from the `xapi` object are Javascript Promises. When executed, they'll either resolve or reject (OK or Error) and you can handle them as you see fit in your automation.

                <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" >
                      Learn more about <strong>Promises</strong> <i class="fa-solid fa-square-up-right"></i>
                </a>

                ??? tool "To get a bit more technical"

                    In the Example above, we first call the `xCommand Time DateTime Get` command. JS Promises can leverage the `.then()` method, which allows us to take that value of a successful outcome and store it into another object, in this case `time`, and when `time` is populated with a value, we can immediately run a function `=>` of this value to run additional processes. Here, we pass it into the in-built JS function; `console.log`, to log it into the Macro's log output.

                    If your function is rejected, then the `.catch()` method  can handle those outcomes in the same way `.then()` works on resolutions.

    !!! Tip

        Parameters for Macro Syntax are setup as a JSON Object and must be passed into a function as a parameter

        <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON" target="_blank" >
          Learn more about <strong>JSON</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>

        At a high level, functions defined in the `xapi` can have 1 or 2 function parameters pass. One being the parameters for the xAPI call writing in a JSON Object [Represented by `myChildParams` below], the other for multiline content (if available) [Represented by `myMultiLineContent` below]

        It's important to note that not all `xapi` functions have multiline input, but it's good to know where it's placed should there be any

        === "Parameter Example"

            ``` { .js }
            import xapi from 'xapi';

            const myChildParams = { Parameter: 'One', Parameter: 2, Parameter: '...' };
            const myMultiLineContent= `...`;

            xapi.Parent.Child(myChildParams, myMultiLineContent);
            ```

            <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions" target="_blank" >
                  Learn more about <strong>Functions</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>

    - **xAPI:** xCommand Video Selfview Set

    - **Task:** 
        - Activate the ==xCommands_Lesson-1_MacroPak_2-6-3== macro
        - Structure the xAPI Path above using Macro Syntax and apply the following parameters
            - Mode: On
            - FullScreenMode: On
            - OnMonitorRole: First
    
    - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

    - When Complete, deactivate the ==xCommands_Lesson-1_MacroPak_2-6-3== macro
    
    ??? success "View Successful Macro Syntax"

        === "Simple Execution"

            ``` javascript

            import xapi from 'xapi';

            xapi.Command.Video.Selfview.Set({ Mode: "On", FullScreenMode: "On", OnMonitorRole: "First" });

            ```
          
        === "Promises > `.then()` Method"

            ``` javascript

            import xapi from 'xapi';

            xapi.Config.Video.Selfview.Set({ Mode: "On", FullScreenMode: "On", OnMonitorRole: "Off" }).then(resolution => {

              // Log the xAPI resolution
              console.log('Config.Video.Selfview.Set Resolution', resolution);

              /* Run Additional Function Here*/

            }).catch(error => {

              // Log the xAPI rejection
              console.error('Config.Video.Selfview.Set Error', error);

              /* Run Additional Function Here*/

            });
            ```

            <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" >
                  Learn more about <strong>Promises</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>
        
        === "Promises > Async Await"

            ``` javascript
            import xapi from 'xapi';

            const setSelfview = async function(parameters => {
              try {
                const runxAPI = await xapi.Config.Video.Selfview.Set(parameters);

                // Log the Resolution captured in a runxAPI object
                console.log(runxAPI);

                /* Run Additional Function Here*/

              } catch (error) (

                // Log the Rejection captured in a error object
                console.error(error);

                /* Run Additional Function Here*/

              );
            });

            // Run the setSelfview Function and pass in the Parameters for xCommand Video Selfview Set
            setSelfview({ Mode: "On", FullScreenMode: "On", OnMonitorRole: "Off" });
            ```

            <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" >
                  Learn more about <strong>Async Functions</strong> <i class="fa-solid fa-square-up-right"></i>
            </a>


??? lesson "Lesson: Execute an xCommand with multiple arguments with the same name"

    In cases where we need to declare multiple arguments of the same name, rather than duplicating and re-running the parameters, we instead leverage Javascript's Array capabilities

    <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" >
      Learn more about <strong>Arrays</strong> <i class="fa-solid fa-square-up-right"></i>
    </a>

    !!! example "Click on the tabs to see how Terminal Syntax relates to Macro Syntax"

        === "Terminal Syntax"

            ``` { .shell }
            xParent Child ChildParam_X: 1, ChildParam_X: 2
            ```
            <br>

        === "Macro Syntax"

            ``` { .javascript }
            import xapi from 'xapi';

            xapi.Parent.Child({
              ChildChildParam_X: [1, 2] // Rather than calling ChildParam_X twice, we'll simply place both values we need into an Array
            })
            ```
    
    - **xAPI(s):** 
        - xCommand Video Selfview Set
        - xCommand Video Input SetMainVideoSource

    - **Task:** 

        - Activate the ==xCommands_Lesson-2_MacroPak_2-6-3== macro
        - Structure ==xCommand Video Input SetMainVideoSource== using Macro Syntax and apply the following parameters, but assign the value `1` to ConnectorId twice
          - ConnectorId: 1
          - Layout: Equal
        - Add this xCommand to the ==showAndCompose()== function
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xCommands_Lesson-2_MacroPak_2-6-3== macro

    ??? success "View Successful Macro Syntax"

        ``` javascript
        import xapi from 'xapi';

        /**
         * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#263-executing-xcommands
         * 
         * Lesson 2: Execute an xCommand with multiple arguments with the same name
         */

        const showAndComposeCamera = function () {
          xapi.Command.Video.Selfview.Set({ Mode: 'On', FullscreenMode: 'On', OnMonitorRole: 'First' });

          // Enter your solution below this line
          xapi.Command.Video.Input.SetMainVideoSource({
            ConnectorId: [1, 1],
            Layout: 'Equal'
          })
          // Don't go past this line
        }

        showAndComposeCamera();
        ```

    ??? challenge "Challenge: Log and Handle Errors"

        - Convert the `showAndComposeCamera()` function into an Async Function
        - Wrap all xAPI references in a Try Catch block
        - Add a console log for a Successful outcome
        - Add a console log for an Error

        - Save the Macro and observe the log

        <a class="md-button md-button--primary" href="../challengeAnswers/" target="_blank" >
          Giving Up? Check out the Challenge Answers Page <i class="fa-solid fa-square-up-right"></i>
        </a>

??? lesson "Lesson: Execute an xCommand with a multiline argument"

    !!! example "Click on the tabs to see how Terminal Syntax relates to Macro Syntax"

        === "Terminal Syntax"

            ``` {.shell, .no-copy}
            [Command Path]
            [Multi Line Content]
            .
            ```
            <br>

        === "Macro Syntax"

            ``` { .javascript }
            import xapi from 'xapi';

            const myChildParams = { Parameter: 'One', Parameter: 2, Parameter: '...' };
            const myMultiLineContent= `...`;

            xapi.Parent.Child(myChildParams, myMultiLineContent);
            ```
    
    - **xAPI(s):** 
        - xCommand Video Selfview Set
        - xCommand Video Input SetMainVideoSource
        - xCommand UserInterface Extensions Panel Save

    - **Task:** 

        - Activate the ==xCommands_Lesson-3_MacroPak_2-6-3== macro
        - Assign the value `wx1_lab_multilineCommand` to the ==myPanelId== object
        - Assign the following XML payload to the ==myUserinterface== object
            ```xml
            <Extensions>
              <Panel>
                <Order>1</Order>
                <PanelId>wx1_lab_multilineCommand</PanelId>
                <Location>HomeScreen</Location>
                <Icon>Info</Icon>
                <Color>#00FFFF</Color>
                <Name>MultiLine Command [Section 2.6.3]</Name>
                <ActivityType>Custom</ActivityType>
              </Panel>
            </Extensions>
            ```
        - Structure ==xCommand UserInterface Extensions Panel Save== using Macro Syntax and apply the following parameters
            - PanelId [Use the ==myPanelId== object for this field]
            - body [Use the ==myUserinterfaceXML== object for this field] (This is a MultiLine Argument)
        - Add this xCommand to the ==buildUserInterface()== function
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xCommands_Lesson-3_MacroPak_2-6-3== macro

    ??? success "View Successful Macro Syntax and Log output"

        ``` javascript
        import xapi from 'xapi';

        /**
         * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#263-executing-xcommands
         * 
         * Lesson 3: Execute an xCommand with a multiline argument
         */

        // Assign values to these Objects
        const myPanelId = 'wx1_lab_multilineCommand';

        const myUserinterfaceXML = `<Extensions>
              <Panel>
                <Order>1</Order>
                <PanelId>wx1_lab_multilineCommand</PanelId>
                <Location>HomeScreen</Location>
                <Icon>Info</Icon>
                <Color>#00FFFF</Color>
                <Name>MultiLine Command [Section 2.6.3]</Name>
                <ActivityType>Custom</ActivityType>
              </Panel>
            </Extensions>`


        const buildUserInterface = async function (){
          try {
            // Enter your solution below this line

            const saveUI = await xapi.Command.UserInterface.Extensions.Panel.Save({ PanelId: myPanelId }, myUserinterfaceXML)

            // Don't go past this line
            console.log(`Panel [${myPanelId}] saved to the codec`)
          } catch (e){
            console.error(e)
          }
        }


        async function cleanupLesson2(){
          await xapi.Command.Video.Selfview.Set({Mode: 'Off'});
          await xapi.Command.Video.Input.SetMainVideoSource({ConnectorId: 1, Layout: 'Equal'});
        }

        async function init(){
          await cleanupLesson2()

          await buildUserInterface();
        }

        init();
        ```

    ??? curious ":thinking: Having issues with saving Strings to Objects in your macro?"

        There are 3 ways to define string literals

        <div>
            <table>
              <thead>
                  <tr>
                      <th>Key</th>
                      <th>Name</th>
                      <th>Example</th>
                      <th>Extra Properties</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td>`'`</td>
                      <td style="white-space: nowrap;">Single Quote</td>
                      <td style="white-space: nowrap;"><code>const myString = "It's a sunny day."</code></td>
                      <td>Can encapsulate a string with single quotes `'` inside</td>
                  </tr>
                  <tr>
                      <td>`"`</td>
                      <td style="white-space: nowrap;">Double Quote</td>
                      <td style="white-space: nowrap;"><code>const myOtherString = 'They said, "Hello!"';</code></td>
                      <td>Can encapsulate a string with double quotes `"` inside</td>
                  </tr>
                  <tr>
                      <td>`` ` ``</td>
                      <td style="white-space: nowrap;">Backtick Quote</td>
                      <td style="white-space: nowrap;"><code>const myFinalString = `They didn't say "World"`</code></td>
                      <td>Can encapsulate double and single quotes, allows for multiline strings, allows for string interpolation</td>
                  </tr>
              </tbody>
          </table>
        </div>

        <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" target="_blank" >
          Learn more about <strong>Strings</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>

??? lesson "Lesson: Execute an xCommand which generates data and responds"

    When collecting data from an xCommand in the Macro Editor, you either need to use the `.then()` method and log that value to the console or use an Async function to capture the value of that xCommand into a object, then log that object

    - **xAPI:** xCommand UserInterface Extensions List

    - **Task:**
        - Activate the ==xCommands_Lesson-4_MacroPak_2-6-3== macro
        - Structure ==xCommand UserInterface Extensions List== using Macro Syntax and do 1 of the following

            - Use `.then()` to capture the value of ==xCommand UserInterface Extensions List== then log that value to the console

                <strong>Or<strong>

            - declare an async function called `checkExtensions`, place ==xCommand UserInterface Extensions List== written in Macro Syntax
                - Wrap that in a Try Catch statement
                - Assign the value of the xAPI to an object
                - Then log the value of that object to the console

        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xCommands_Lesson-4_MacroPak_2-6-3== macro

    <div style="display: flex; gap: 10px;">
        <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank">
            Learn more about <strong>Promises</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>
        <a class="md-button md-button--primary" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank">
            Learn more about <strong>Async Functions</strong> <i class="fa-solid fa-square-up-right"></i>
        </a>
    </div>
    
    ??? success "View Successful Macro Syntax and Log output"

        === "Using `.then()`"

            ```javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#263-executing-xcommands
             * 
             * Lesson 4: Execute an xCommand which generates data and responds
             */

            xapi.Command.UserInterface.Extensions.List().then(ext => {
              console.log(ext);
            }).catch(error => {
              console.error(error);
            });
            ```

        === "Using `Async Await`"

            ```javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#263-executing-xcommands
             * 
             * Lesson 4: Execute an xCommand which generates data and responds
             */
            
            const checkExtensions = async function () {

              try {
                const getExtensions = await xapi.Command.UserInterface.Extensions.List();
                console.log(getExtensions);
              } catch (error) {
                console.error(error);
              };
            };

            checkExtensions();
            ```

    

### **2.6.4 Setting, Getting and Subscribing to xConfigurations**

!!! Abstract

    Getting xConfiguration values, and later on xStatus Values, use the nearly same techniques for xCommands that generate data and respond.

    However, when ==Getting== an xConfiguration or an xStatus, you'll need to add the `.get()` method at the end of the xAPI call.

    Subsequently, when ==Setting== an xConfiguration, you'll need to add the `.set()` method at the end of the xAPI call.

    !!! example "Compare Macro Command vs Config syntax"

        === "xCommands"

            xapi.==Command==.ChildPath ==(childParameter, childMultiLine)==

        === "xConfigurations Get"

            xapi.==Config==.ChildPath ==.get()==

        === "xConfigurations Set"

            xapi.==Config==.ChildPath ==.get({++'ChildValue'++})==

    !!! important ""

        We'll continue the remainder of the examples with only Async Await syntax, as a best practice, but if you're familiar with `.then()`, `.catch()` and `.finally()` syntax and prefer writing like that, feel free to do so

???+ lesson "Lesson: Get an xConfiguration Value"

    - **xAPI:** xConfig Audio DefaultVolume

    - **Task:**
        - Activate the ==xConfigs_Lesson-1_MacroPak_2-6-4== macro
        - Modify the `getConfigValue()` function by replacing the existing value of `targetConfig` with ==xConfig Audio DefaultVolume== written in Macro Syntax
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xConfigs_Lesson-1_MacroPak_2-6-4== macro


    ??? "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#264-setting-getting-and-subscribing-to-xconfigurations
             * 
             * Lesson 1: Getting an xConfiguration Value
             */

            // Enter your solution below this line


            const getConfigValue = async function () {
              try {
                // Modify targetConfig below

                const targetConfig = await xapi.Config.Audio.DefaultVolume.get();

                // Don't go past this line
                console.log('DefaultVolume:', targetConfig)
              } catch (e) {
                console.error(e);
              };
            };

            getConfigValue();
            ```

        === "Log Output"

            | Timestamp | Source                                | Message                   |
            |-----------|---------------------------------------|---------------------------|
            | HH:MM:SS  | [system]                             | Runtime stopped!          |
            | HH:MM:SS  | [system]                             | Using XAPI transport: WebSocket |
            | HH:MM:SS  | [system]                             | Starting macros...        |
            | HH:MM:SS  | xConfigs_Lesson-1_MacroPak_2-6-4   | QJS Ready                 |
            | HH:MM:SS  | xConfigs_Lesson-1_MacroPak_2-6-4   | DefaultVolume: 75         |

??? lesson "Lesson: Set a new xConfiguration Value"

    - **xAPI:** xConfig Audio DefaultVolume

    - **Task:**
        - Activate the ==xConfigs_Lesson-2_MacroPak_2-6-4== macro
        - Modify the `setConfigValue()` function by replacing the existing value of `targetConfig` with ==xConfig Audio DefaultVolume== written in Macro Syntax
        - Instead of hardcoding the value we want to set, place the `value` parameter into the `.set(value)` method instead
            - This will allow us to change this value easier as we call the function in different parts of our script
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xConfigs_Lesson-2_MacroPak_2-6-4== macro


    ??? "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#264-setting-getting-and-subscribing-to-xconfigurations
             * 
             * Lesson 2: Set a new xConfiguration Value
             */

            // Enter your solution below this line


            const setConfigValue = async function (value = 50) {
              try {
                // Modify targetConfig below

                const targetConfig = await xapi.Config.Audio.DefaultVolume.set(value);

                // Don't go past this line
                console.debug('DefaultVolume Set');
              } catch (e) {
                console.error(e);
              };
            };


            const getConfigValue = async function () {
              try {
                const targetConfig = await xapi.Config.Audio.DefaultVolume.get();
                console.log('DefaultVolume:', targetConfig);
              } catch (e) {
                console.error(e);
              };
            };

            async function init(){
              
              await setConfigValue(100); // <-- Change this Value [0-100] and Resave

              await getConfigValue();
            }

            init();
            ```

        === "Log Output"

            | Timestamp | Source                                | Message                   |
            |-----------|---------------------------------------|---------------------------|
            | HH:MM:SS  | [system]                             | Runtime stopped!          |
            | HH:MM:SS  | [system]                             | Using XAPI transport: WebSocket |
            | HH:MM:SS  | [system]                             | Starting macros...        |
            | HH:MM:SS  | xConfigs_Lesson-2_MacroPak_2-6-4   | QJS Ready                 |
            | HH:MM:SS  | xConfigs_Lesson-2_MacroPak_2-6-4   | DefaultVolume: [Some Value]         |

??? lesson "Lesson: Get multiple xConfigurations under a Common Node"

    - **xAPI:** xConfig Audio

    - **Task:**
        - Activate the ==xConfigs_Lesson-3_MacroPak_2-6-4== macro
        - Modify the `getConfigValue()` function by replacing the existing value of `targetConfig` with ==xConfig Audio== written in Macro Syntax
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xConfigs_Lesson-3_MacroPak_2-6-4== macro


    ??? "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#264-setting-getting-and-subscribing-to-xconfigurations
             * 
             * Lesson 1: Getting an xConfiguration Value
             */

            // Enter your solution below this line

            const getConfigValue = async function () {
              try {
                // Modify targetConfig below

                const targetConfig = await xapi.Config.Audio.get();

                // Don't go past this line
                console.log('DefaultVolume:', targetConfig)
              } catch (e) {
                console.error(e);
              };
            };

            getConfigValue();
            ```

        === "Log Output"

            | Timestamp | Source                                | Message                   |
            |-----------|---------------------------------------|---------------------------|
            | HH:MM:SS  | [system]                             | Runtime stopped!          |
            | HH:MM:SS  | [system]                             | Using XAPI transport: WebSocket |
            | HH:MM:SS  | [system]                             | Starting macros...        |
            | HH:MM:SS  | xConfigs_Lesson-3_MacroPak_2-6-4   | QJS Ready                 |
            | HH:MM:SS  | xConfigs_Lesson-3_MacroPak_2-6-4   | `{"DefaultVolume":"100","Ethernet":{"Encryption":"Required","SAPDiscovery":{"Address":"239.255.255.255","Mode":"Off"}},"Input":{"Ethernet":[{"Channel":[{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"1"},{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"2"},{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"3"},{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"4"},{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"5"},{"Gain":"45","Mode":"On","Pan":"Mono","Zone":"1","id":"6"},{"... And the list goes on"}],"EchoControl":{"Mode":"On","NoiseReduction":"On"},"Equalizer":{"ID":"1","Mode":"Off"},"Mode":"On","id":"1"}]}}{..."And the List Goes On"}`         |

??? lesson "Lesson: Subscribe and Unsubscribe to an xConfiguration"

    !!! info

        Subscriptions in the Macro Editor introduce another method we can append to the end of the path called `.on()`

        `.on()` allows us to subscribe to any changes in xConfigurations, xStatuses and xEvents until the script has either stopped or until the xAPI path is unsubscribed too

        `.on()` expect an object, similar to using `.then()` for you to place the incoming data and run function off of it

        !!! example "Click on the tabs to see how Terminal Syntax relates to Macro Syntax"

            === "Terminal Syntax"

                ``` shell
                xFeedback Register Configuration/Child/Child
                ** end

                OK
                *c xConfiguration Child Child Value: 85
                ** end
                *c xConfiguration Child Child Value: 44
                ** end
                *c xConfiguration Child Child Value: 36
                ** end
                ```

            === "Macro Syntax"

                ``` javascript
                import xapi from 'xapi';

                xapi.Configuration.Child.Child.on(ChildValue => {
                  console.log('New ChildValue:', ChildValue);
                });

                /* Log Output
                New ChildValue: 85
                New ChildValue: 44
                New ChildValue: 36
                */
                ```

    
    - **xAPI:** xConfiguration Audio DefaultVolume

    - **Task**:
        - Activate the ==xConfigs_Lesson-4_MacroPak_2-6-4== macro
        - Modify the `subscribeToDefaultVolume` object by replacing it's value with ==xConfig Audio== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToDefaultVolume== properly, running ==subscribeToDefaultVolume=={++()++} will stop your active subscription
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response
            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xConfigs_Lesson-4_MacroPak_2-6-4== macro

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#264-setting-getting-and-subscribing-to-xconfigurations
             * 
             * Lesson 4: Subscribe and Unsubscribe to an xConfiguration
            */

            const delay_in_seconds = 10;

            // Edit this Object to include your xConfiguration Subscription
            const subscribeToDefaultVolume = xapi.Config.Audio.DefaultVolume.on(event => {
              console.log('DefaultVolume Set to:', event)
            })

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToDefaultVolume(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("DefaultVolume Subscription stopped!");

            }, delay_in_seconds * 1000)


            // Here, we're randomly assigning a value between 1 and 100 to the Default Volume, so we can see that configuration on our Subscription
            function setRandomDefaultVolume() {
              const randomValue = Math.floor(Math.random() * 100) + 1;

              xapi.Config.Audio.DefaultVolume.set(randomValue);
            }


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`DefaultVolume Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`DefaultVolume Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            function init() {
              setInterval(() => {
                setRandomDefaultVolume();
              }, 500)

              countdown(delay_in_seconds);
            }

            init();
            ```

        === "Log Output"

            | Time       | Source                          | Message                                         |
            |------------|---------------------------------|-------------------------------------------------|
            | HH:MM:SS   | [system]                       | Runtime stopped!                               |
            | HH:MM:SS   | [system]                       | Using XAPI transport: WebSocket                |
            | HH:MM:SS   | [system]                       | Starting macros...                             |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopping in [5] seconds |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | QJS Ready                                      |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 70                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopping in [4] seconds |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 48                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 13                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopping in [3] seconds |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 92                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 52                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopping in [2] seconds |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 46                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 69                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopping in [1] seconds |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 21                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Set to: 57                       |
            | HH:MM:SS   | xConfigs_Lesson-4_MacroPak_2-6-4 | DefaultVolume Subscription stopped!             |

??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xConfigurations under a Common Node"

    !!! info

        Just like we can subscribe to 1 point of interest in an xConfig branch, we can subscribe to a Higher Common Node as well

        We'll do so for the Airplay Config section of you codec
    
    - **xAPI:** xConfiguration Video Input Airplay

    - **Task**:
        - Activate the ==xConfigs_Lesson-5_MacroPak_2-6-4== macro
        - Modify the `subscribeToAirplay` object by replacing it's value with ==xConfiguration Video Input Airplay== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToAirplay== properly, running ==subscribeToAirplay=={++()++} will stop your active subscription
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response
            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xConfigs_Lesson-5_MacroPak_2-6-4== macro

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#264-setting-getting-and-subscribing-to-xconfigurations
             * 
             * Lesson 5: Subscribe and Unsubscribe to Multiple xConfigurations under a Common Node
             */

            const delay_in_seconds = 5;

            // Edit this Object to include your xConfiguration Subscription
            const subscribeToAirplay = xapi.Config.Video.Input.Airplay.on(event => {
              console.log('Airplay Changes:', event)
            })

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToAirplay(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("Airplay Subscription stopped!");

            }, delay_in_seconds * 1000)


            // Here, we're randomly assigning a values to the Airplay config, so we can see that configuration on our Subscription
            function setRandomAirplayConfigs() {

              function randomNumber() {
                return Math.floor(Math.random() * 10);
              }

              const randomPass = `${randomNumber()}${randomNumber()}${randomNumber()}${randomNumber()}`

              xapi.Config.Video.Input.AirPlay.Mode.set(Math.random() < 0.5 ? "On" : "Off");

              xapi.Config.Video.Input.AirPlay.Beacon.set(Math.random() < 0.5 ? "Auto" : "Off");

              xapi.Config.Video.Input.AirPlay.Password.set(randomPass);
            }


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`Airplay Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`Airplay Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            function init() {
              setInterval(() => {
                setRandomAirplayConfigs();
              }, 500)

              countdown(delay_in_seconds);
            }

            init();
            ```

        === "Log Output"

            | Time       | Source                          | Message                                         |
            |------------|---------------------------------|-------------------------------------------------|
            | HH:MM:SS   | [system]                       | Runtime stopped!                               |
            | HH:MM:SS   | [system]                       | Using XAPI transport: WebSocket                |
            | HH:MM:SS   | [system]                       | Starting macros...                             |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopping in [5] seconds   |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | QJS Ready                                      |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"On"}                 |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Beacon":"Off"}              |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopping in [4] seconds    |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"Off"}                |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"On"}                 |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopping in [3] seconds    |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Beacon":"Auto"}             |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopping in [2] seconds    |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"Off"}                |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Beacon":"Off"}              |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Beacon":"Auto"}             |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopping in [1] seconds    |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"On"}                 |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Mode":"Off"}                |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Changes: \{"Password":"***"}            |
            | HH:MM:SS   | xConfigs_Lesson-5_MacroPak_2-6-4 | Airplay Subscription stopped!                   |

??? challenge "Challenge: Can you spot the Error?"

    In both the `xConfigs_Lesson-4_MacroPak_2-6-4` and `xConfigs_Lesson-5_MacroPak_2-6-4` macros, there is an error

    It's not an error in the syntax or format, but an error in the automation

    What do these macros continue to do if they are left active on a Codec that could be problematic?

    <a class="md-button md-button--primary" href="../challengeAnswers/" target="_blank" >
          Giving Up? Check out the Challenge Answers Page <i class="fa-solid fa-square-up-right"></i>
    </a>

### **2.6.5 Getting and Subscribing to xStatuses**

???+ lesson "Lesson: Get an xStatus Value"

    - **xAPI:** xStatus Audio Volume

    - **Task:**
        - Activate the ==xStatuses_Lesson-1_MacroPak_2-6-4== macro
        - Modify the `getStatusValue()` function by replacing the existing value of `targetStatus` with ==xStatus Audio Volume== written in Macro Syntax
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xStatuses_Lesson-1_MacroPak_2-6-4== macro


    ??? "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#265-getting-and-subscribing-to-xstatuses
             * 
             * Lesson 1: Getting an xStatus Value
             */

            // Enter your solution below this line

            const getStatusValue = async function () {
              try {
                // Modify targetStatus below

                const targetStatus = await xapi.Status.Audio.Volume.get();

                // Don't go past this line
                console.log('Volume:', targetStatus)
              } catch (e) {
                console.error(e);
              };
            };

            getStatusValue();
            ```

        === "Log Output"

            | Timestamp | Source                                | Message                   |
            |-----------|---------------------------------------|---------------------------|
            | HH:MM:SS  | [system]                             | Runtime stopped!          |
            | HH:MM:SS  | [system]                             | Using XAPI transport: WebSocket |
            | HH:MM:SS  | [system]                             | Starting macros...        |
            | HH:MM:SS  | xStatuses_Lesson-1_MacroPak_2-6-4   | QJS Ready                 |
            | HH:MM:SS  | xStatuses_Lesson-1_MacroPak_2-6-4   | Volume: 50         |

??? lesson "Lesson: Get multiple xStatuses under a Common Node"

    - **xAPI:** xStatus Audio

    - **Task:**
        - Activate the ==xStatuses_Lesson-2_MacroPak_2-6-4== macro
        - Modify the `getStatusValue()` function by replacing the existing value of `targetStatus` with ==xStatus Audio== written in Macro Syntax
        - Save your Macro and monitor the Macro Console as well as the Device to see if you had a successful response

        - When Complete, deactivate the ==xStatuses_Lesson-2_MacroPak_2-6-4== macro


    ??? "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#265-getting-and-subscribing-to-xstatuses
             * 
             * Lesson 2: Getting an xStatus Value
             */

            // Enter your solution below this line

            const getStatusValue = async function () {
              try {
                // Modify targetStatus below

                const targetStatus = await xapi.Status.Audio.get();

                // Don't go past this line
                console.log(targetStatus)
              } catch (e) {
                console.error(e);
              };
            };

            getStatusValue();
            ```

        === "Log Output"

            | Timestamp | Source                                | Message                   |
            |-----------|---------------------------------------|---------------------------|
            | HH:MM:SS  | [system]                             | Runtime stopped!          |
            | HH:MM:SS  | [system]                             | Using XAPI transport: WebSocket |
            | HH:MM:SS  | [system]                             | Starting macros...        |
            | HH:MM:SS  | xStatuses_Lesson-2_MacroPak_2-6-4   | QJS Ready                 |
            | HH:MM:SS  | xStatuses_Lesson-2_MacroPak_2-6-4   | `{ "Devices": { "Bluetooth": { "ActiveProfile": "None" }, "HandsetUSB": { "ConnectionStatus": "NotConnected", "Cradle": "OnHook" }, "HeadsetUSB": { "ConnectionStatus": "NotConnected", "Description": "", "Manufacturer": "" } }, "Input": { "Connectors": { "HDMI": [ { "Mute": "On", "id": "1" } ], "Microphone": [ { "ConnectionStatus": "Connected", "id": "1" }, { "ConnectionStatus": "NotConnected", "id": "2" }, { "ConnectionStatus": "NotConnected", "id": "3" } ], "USBC": [ { "Mute": "On", "id": "1" } ] } } }{..."And the List Goes On"}`         |

??? lesson "Lesson: Subscribe and Unsubscribe to an xStatus"

    - **xAPI:** xStatus Audio Volume

    - **Task**:
        - Activate the ==xStatuses_Lesson-3_MacroPak_2-6-5== macro
        - Modify the `subscribeToVolume` object by replacing it's value with ==xStatus Audio Volume== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToVolume== properly, running ==subscribeToVolume=={++()++} will stop your active subscription
        - Save your Macro, raise and lower the volume on your Codec and monitor the Macro Console to see if you had a successful response

            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xStatuses_Lesson-3_MacroPak_2-6-5== macro

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#265-getting-and-subscribing-to-xstatuses
             * 
             * Lesson 3: Subscribe and Unsubscribe to an xStatus
            */

            const delay_in_seconds = 10;

            // Edit this Object to include your xStatus Subscription
            const subscribeToVolume = xapi.Status.Audio.Volume.on(vol => {
              console.log('Volume:', vol)
            });

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToVolume(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("Volume Subscription stopped!");

            }, delay_in_seconds * 1000)


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`Volume Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`Volume Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            function init() {
              countdown(delay_in_seconds);
            }

            init();
            ```

        === "Log Output"

            | Time       | Source                                   | Message                                      |
            |------------|------------------------------------------|----------------------------------------------|
            | HH:MM:SS  | [system]                                 | Using XAPI transport: WebSocket              |
            | HH:MM:SS  | [system]                                 | Starting macros...                           |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [10] seconds |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | QJS Ready                                    |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [9] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [8] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [7] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 80                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 85                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [6] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 90                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [5] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 85                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [4] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 80                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [3] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 75                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 70                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [2] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 65                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopping in [1] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume: 60                                   |
            | HH:MM:SS  | xStatuses_Lesson-3_MacroPak_2-6-5      | Volume Subscription stopped!                  |


??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xStatuses under a Common Node"

    - **xAPI:** xStatus Cameras Camera[N] Position

    - **Task**:
        - Activate the ==xStatuses_Lesson-4_MacroPak_2-6-5== macro
        - Modify the `subscribeToCameraPositions` object by replacing it's value with ==xStatus Cameras Camera[N] Position== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToCameraPositions== properly, running ==subscribeToCameraPositions=={++()++} will stop your active subscription
        - Save your Macro, and perform the following steps
            - Access the Codec's Control Panel on it's touch interface
            - Select Cameras
            - Select Manual
            - Then use the Control Wheel, Zoom In (+) and and Zoom out (-) buttons and observe your Macro Log output

            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xStatuses_Lesson-4_MacroPak_2-6-5== macro

    ??? gif "Accessing the Camera Menu"

        <figure markdown>
          ![Navigate to Camera Control Menu GIF](./assets/wx1_1451_part_2/2-2-4_CameraMenuAccess.gif){ width="600" }
        </figure>

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#265-getting-and-subscribing-to-xstatuses
             * 
             * Lesson 4: Subscribe and Unsubscribe to Multiple xStatuses under a Common Node
            */

            const delay_in_seconds = 10;

            // Edit this Object to include your xStatus Subscription
            const subscribeToCameraPositions = xapi.Status.Cameras.Camera.Position.on(event => {
              console.log(event)
            });

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToCameraPositions(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("CameraPositions Subscription stopped!");

            }, delay_in_seconds * 1000)


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`CameraPositions Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`CameraPositions Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            function init() {
              countdown(delay_in_seconds);
            }

            init();
            ```

        === "Log Output"

            | Time       | Source                                   | Message                                      |
            |------------|------------------------------------------|----------------------------------------------|
            | HH:MM:SS  | [system]                                 | Runtime stopped!                             |
            | HH:MM:SS  | [system]                                 | Using XAPI transport: WebSocket              |
            | HH:MM:SS  | [system]                                 | Starting macros...                           |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [10] seconds |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | QJS Ready                                    |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Zoom":"4295"}                             |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [9] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Zoom":"5662"}                             |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [8] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Pan":"-65"}                               |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [7] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Pan":"-64","Tilt":"123"}                  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [6] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Pan":"-61","Tilt":"-20"}                  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Pan":"-24","Tilt":"-19"}                  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [5] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Tilt":"47"}                               |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [4] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Zoom":"4384"}                             |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [3] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Tilt":"-14"}                              |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [2] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | {"Pan":"14"}                                |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopping in [1] seconds  |
            | HH:MM:SS  | xStatuses_Lesson-4_MacroPak_2-6-5      | CameraPositions Subscription stopped!        |


### **2.6.6 Subscribing to xEvents**

???+ lesson "Lesson: Subscribe and Unsubscribe to an xEvent"

    - **xAPI:** xEvent UserInterface Extensions Widget Action

    - **Task**:
        - Activate the ==xEvents_Lesson-1_MacroPak_2-6-6== macro
        - Modify the `subscribeToWidgetActions` object by replacing it's value with ==xEvent UserInterface Widget Action== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToWidgetActions== properly, running ==subscribeToWidgetActions=={++()++} will stop your active subscription
        - Save your Macro, open the ==MultiLine Command [Section 2.6.6]== Panel on your Codec's touch interface, press one or more of the buttons and observe the Macro Log Output

            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xEvents_Lesson-1_MacroPak_2-6-6== macro

    ??? gif "Open the **MultiLine Command [Section 2.6.6]** Panel"

        <figure markdown>
          ![Open the MultiLine Command [Section 2.6.] Panel](./assets/wx1_1451_part_2/2-6-6_Get-xEvent-WidgetActions.gif){ width="600" }
        </figure>

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#266-subscribing-to-xevents
             * 
             * Lesson 1: Subscribe and Unsubscribe to an xEvent
            */

            const delay_in_seconds = 10;

            // Edit this Object to include your xEvent Subscription
            const subscribeToWidgetActions = xapi.Event.UserInterface.Extensions.Widget.Action.on(event => {
              console.log(event)
            });

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToWidgetActions(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("WidgetActions Subscription stopped!");

            }, delay_in_seconds * 1000)


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`WidgetActions Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`WidgetActions Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            const myPanelId = 'wx1_lab_multilineCommand';

            const myUserinterfaceXML = `<Extensions>
              <Panel>
                <Order>1</Order>
                <PanelId>wx1_lab_multilineCommand</PanelId>
                <Location>HomeScreen</Location>
                <Icon>Info</Icon>
                <Color>#FC5143</Color>
                <Name>MultiLine Command [Section 2.6.6]</Name>
                <ActivityType>Custom</ActivityType>
                <Page>
                  <Name>Page</Name>
                  <Row>
                    <Name>Buttons</Name>
                    <Widget>
                      <WidgetId>wx1_GroupButton</WidgetId>
                      <Type>GroupButton</Type>
                      <Options>size=4</Options>
                      <ValueSpace>
                        <Value>
                          <Key>GroupButton_A</Key>
                          <Name>A</Name>
                        </Value>
                        <Value>
                          <Key>GroupButton_B</Key>
                          <Name>B</Name>
                        </Value>
                        <Value>
                          <Key>GroupButton_C</Key>
                          <Name>C</Name>
                        </Value>
                      </ValueSpace>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_TextButton</WidgetId>
                      <Name>Text</Name>
                      <Type>Button</Type>
                      <Options>size=1</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_IconButton</WidgetId>
                      <Type>Button</Type>
                      <Options>size=1;icon=green</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_SpinnerButton</WidgetId>
                      <Type>Spinner</Type>
                      <Options>size=2</Options>
                    </Widget>
                  </Row>
                  <Row>
                    <Name>Control Wheel</Name>
                    <Widget>
                      <WidgetId>wx1_ControlWheel</WidgetId>
                      <Type>DirectionalPad</Type>
                      <Options>size=4</Options>
                    </Widget>
                  </Row>
                  <Row>
                    <Name>Toggle and Slider</Name>
                    <Widget>
                      <WidgetId>wx1_Toggle</WidgetId>
                      <Type>ToggleButton</Type>
                      <Options>size=1</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_Slider</WidgetId>
                      <Type>Slider</Type>
                      <Options>size=3</Options>
                    </Widget>
                  </Row>
                  <Options/>
                </Page>
              </Panel>
            </Extensions>`


            const buildUserInterface = async function () {
              try {
                const saveUI = await xapi.Command.UserInterface.Extensions.Panel.Save({ PanelId: myPanelId }, myUserinterfaceXML)
                console.log(`Panel [${myPanelId}] saved to the codec`)
              } catch (e) {
                console.error(e)
              }
            }

            function init() {
              countdown(delay_in_seconds);

              buildUserInterface()
            }

            init();
            ```

        === "Log Output"

            | Time       | Source                                   | Message                                      |
            |------------|------------------------------------------|----------------------------------------------|
            | HH:MM:SS  | [system]                                 | Runtime stopped!                             |
            | HH:MM:SS  | [system]                                 | Using XAPI transport: WebSocket              |
            | HH:MM:SS  | [system]                                 | Starting macros...                           |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | QJS Ready                                    |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [10] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"GroupButton_A","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"GroupButton_A","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"GroupButton_B","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [9] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | Panel [wx1_lab_multilineCommand] saved to the codec |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"GroupButton_B","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"GroupButton_C","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"GroupButton_C","WidgetId":"wx1_GroupButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [8] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"","WidgetId":"wx1_TextButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"","WidgetId":"wx1_TextButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"","WidgetId":"wx1_TextButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"","WidgetId":"wx1_IconButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [7] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"","WidgetId":"wx1_IconButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"","WidgetId":"wx1_IconButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [6] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [5] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"increment","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"increment","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"increment","WidgetId":"wx1_SpinnerButton","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [4] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"up","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"up","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"up","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"left","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [3] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"left","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"left","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [2] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"pressed","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"released","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"clicked","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopping in [1] seconds |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | {"Type":"changed","Value":"off","WidgetId":"wx1_Toggle","id":"1"} |
            | HH:MM:SS  | xEvents_Lesson-1_MacroPak_2-6-6        | WidgetActions Subscription stopped!        |


??? lesson "Lesson: Subscribe and Unsubscribe to Multiple xEvents under a Common Node"

    - **xAPI:** xEvent UserInterface Extensions

    - **Task**:
        - Activate the ==xEvents_Lesson-1_MacroPak_2-6-6== macro
        - Modify the `subscribeToAllExtensions` object by replacing it's value with ==xEvent UserInterface== written in Macro Syntax using the `.on()` method
            - In order to unsubscribe, we need to assign our xAPI subscription to an object, so we can later call it, which will end it's subscription
            - For example, after you assign the ==subscribeToAllExtensions== properly, running ==subscribeToAllExtensions=={++()++} will stop your active subscription
        - Save your Macro, open the ==MultiLine Command [Section 2.6.6]== Panel on your Codec's touch interface, press one or more of the buttons and observe the Macro Log Output

            - NOTE: This macro will automatically unsubscribe for you. Review those steps, to get a better understand as to how we unsubscribe.

        - When Complete, deactivate the ==xEvents_Lesson-1_MacroPak_2-6-6== macro

    ??? gif "Open the **MultiLine Command [Section 2.6.6]** Panel"

        <figure markdown>
          ![Open the MultiLine Command [Section 2.6.6] Panel](./assets/wx1_1451_part_2/2-6-6_Get-xEvent-WidgetActions.gif){ width="600" }
        </figure>

    ??? success "View Successful Macro Syntax and Log output"

        === "Macro"

            ``` javascript
            import xapi from 'xapi';

            /**
             * Lab Guide: https://webexcc-sa.github.io/LAB-1451/wx1_1451_part_2/#266-subscribing-to-xevents
             * 
             * Lesson 2: Subscribe and Unsubscribe to Multiple xEvents under a Common Node
            */

            const delay_in_seconds = 10;

            // Edit this Object to include your xEvent Subscription
            const subscribeToAllExtensions = xapi.Event.UserInterface.Extensions.on(event => {
              console.log(event)
            });

            // Do not edit past this line, but feel free to review what's going on :)

            // Here, we use JS Timeouts to set an action to run after X seconds. Timeouts use milliseconds, hence why we multiply by 1000
            setTimeout(() => {

              subscribeToAllExtensions(); //<-- By calling the Object we assigned our Subscription too as a function(), we will unsubscribe from it

              console.warn("AllExtensions Subscription stopped!");

            }, delay_in_seconds * 1000)


            // This countdown is used to help you visualize when the process will complete it's course
            // We use console.warn to have this countdown print in another color in the Macro Console
            function countdown(startNumber) {
              let currentNumber = startNumber;

              console.warn(`AllExtensions Subscription stopping in [${currentNumber}] seconds`);

              const interval = setInterval(() => {
                currentNumber--;
                if (currentNumber > 0) {
                  console.warn(`AllExtensions Subscription stopping in [${currentNumber}] seconds`);
                }

                if (currentNumber < 1) {
                  clearInterval(interval);
                }
              }, 1000);
            }

            const myPanelId = 'wx1_lab_multilineCommand';

            const myUserinterfaceXML = `<Extensions>
              <Panel>
                <Order>1</Order>
                <PanelId>wx1_lab_multilineCommand</PanelId>
                <Location>HomeScreen</Location>
                <Icon>Info</Icon>
                <Color>#FF6F20</Color>
                <Name>MultiLine Command [Section 2.6.6]</Name>
                <ActivityType>Custom</ActivityType>
                <Page>
                  <Name>Page</Name>
                  <Row>
                    <Name>Buttons</Name>
                    <Widget>
                      <WidgetId>wx1_GroupButton</WidgetId>
                      <Type>GroupButton</Type>
                      <Options>size=4</Options>
                      <ValueSpace>
                        <Value>
                          <Key>GroupButton_A</Key>
                          <Name>A</Name>
                        </Value>
                        <Value>
                          <Key>GroupButton_B</Key>
                          <Name>B</Name>
                        </Value>
                        <Value>
                          <Key>GroupButton_C</Key>
                          <Name>C</Name>
                        </Value>
                      </ValueSpace>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_TextButton</WidgetId>
                      <Name>Text</Name>
                      <Type>Button</Type>
                      <Options>size=1</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_IconButton</WidgetId>
                      <Type>Button</Type>
                      <Options>size=1;icon=green</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_SpinnerButton</WidgetId>
                      <Type>Spinner</Type>
                      <Options>size=2</Options>
                    </Widget>
                  </Row>
                  <Row>
                    <Name>Control Wheel</Name>
                    <Widget>
                      <WidgetId>wx1_ControlWheel</WidgetId>
                      <Type>DirectionalPad</Type>
                      <Options>size=4</Options>
                    </Widget>
                  </Row>
                  <Row>
                    <Name>Toggle and Slider</Name>
                    <Widget>
                      <WidgetId>wx1_Toggle</WidgetId>
                      <Type>ToggleButton</Type>
                      <Options>size=1</Options>
                    </Widget>
                    <Widget>
                      <WidgetId>wx1_Slider</WidgetId>
                      <Type>Slider</Type>
                      <Options>size=3</Options>
                    </Widget>
                  </Row>
                  <Options/>
                </Page>
              </Panel>
            </Extensions>`


            const buildUserInterface = async function () {
              try {
                const saveUI = await xapi.Command.UserInterface.Extensions.Panel.Save({ PanelId: myPanelId }, myUserinterfaceXML)
                console.log(`Panel [${myPanelId}] saved to the codec`)
              } catch (e) {
                console.error(e)
              }
            }

            function init() {
              countdown(delay_in_seconds);

              buildUserInterface()
            }

            init();
            ```

        === "Log Output"

            | Time     | Source                                      | Message                                                                                     |
            |----------|---------------------------------------------|---------------------------------------------------------------------------------------------|
            | HH:MM:SS | [system]                                   | Runtime stopped!                                                                           |
            | HH:MM:SS | [system]                                   | Using XAPI transport: WebSocket                                                             |
            | HH:MM:SS | [system]                                   | Starting macros...                                                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [10] seconds                                         |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | QJS Ready                                                                                   |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | Panel [wx1_lab_multilineCommand] saved to the codec                                        |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"LayoutUpdated":{"id":"1"},"id":"1"},"id":"1"}                                 |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Panel":{"Clicked":{"PanelId":"wx1_lab_multilineCommand","id":"1"},"id":"1"},"id":"1"}  |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [9] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [8] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Pressed":{"Signal":"wx1_GroupButton:GroupButton_A","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"pressed","Value":"GroupButton_A","WidgetId":"wx1_GroupButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Released":{"Signal":"wx1_GroupButton:GroupButton_A","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"released","Value":"GroupButton_A","WidgetId":"wx1_GroupButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [7] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Pressed":{"Signal":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"}               |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"pressed","Value":"","WidgetId":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Released":{"Signal":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"}              |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"released","Value":"","WidgetId":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Clicked":{"Signal":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"}               |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"clicked","Value":"","WidgetId":"wx1_IconButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [6] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Pressed":{"Signal":"wx1_ControlWheel:center","id":"1"},"id":"1"},"id":"1"}     |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"pressed","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Released":{"Signal":"wx1_ControlWheel:center","id":"1"},"id":"1"},"id":"1"}   |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"released","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Clicked":{"Signal":"wx1_ControlWheel:center","id":"1"},"id":"1"},"id":"1"}   |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"clicked","Value":"center","WidgetId":"wx1_ControlWheel","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [5] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [4] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Pressed":{"Signal":"wx1_Slider:188","id":"1"},"id":"1"},"id":"1"}            |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"pressed","Value":"188","WidgetId":"wx1_Slider","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Changed":{"Signal":"wx1_Slider:98","id":"1"},"id":"1"},"id":"1"}              |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"changed","Value":"98","WidgetId":"wx1_Slider","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Changed":{"Signal":"wx1_Slider:98","id":"1"},"id":"1"},"id":"1"}              |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"changed","Value":"98","WidgetId":"wx1_Slider","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Released":{"Signal":"wx1_Slider:98","id":"1"},"id":"1"},"id":"1"}            |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"released","Value":"98","WidgetId":"wx1_Slider","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [3] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Changed":{"Signal":"wx1_Toggle:on","id":"1"},"id":"1"},"id":"1"}             |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"changed","Value":"on","WidgetId":"wx1_Toggle","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [2] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Pressed":{"Signal":"wx1_SpinnerButton:decrement","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"pressed","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopping in [1] seconds                                          |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Released":{"Signal":"wx1_SpinnerButton:decrement","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"released","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Event":{"Clicked":{"Signal":"wx1_SpinnerButton:decrement","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | {"Widget":{"Action":{"Type":"clicked","Value":"decrement","WidgetId":"wx1_SpinnerButton","id":"1"},"id":"1"},"id":"1"} |
            | HH:MM:SS | xEvents_Lesson-2_MacroPak_2-6-6           | AllExtensions Subscription stopped!                                                         |